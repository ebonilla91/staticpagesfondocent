import{a as u,b as z}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-TRPHXH4T.js";import{a as o,b as k}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-H5WAD6OX.js";import{c as x,d as I}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-G2CN6UBK.js";import{g as $,s as y}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-53LSWZTP.js";import{n as b,o as L}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-PJF6UIFY.js";import{a as d,b as O}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-QQSGI2X4.js";import{b as m,c as v}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-OAY73AJW.js";import{a as w}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-BHCSVH3M.js";import{a as U}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-L5GBYYT7.js";import{a as _,d as f}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-IDSWT3EJ.js";var r,l,S,P,A=_(()=>{r=f(w()),l=f(U());z();L();v();O();k();I();y();S=u.extend({antialiasRotation:!0,mailchimpMatcher:/__rm_mailchimp_(.+)/i,anchorRegexp:/__rm_anchor/i,shareRegexp:/^share\.(facebook|twitter|pinterest|gplus|linkedin|email)\.(mag|page)$/i,render:function(){this.makeBox("widget-picture"),this.isLightboxEnabled()&&this.initLightbox(),this.hasHoverAnimation&&this.$el.addClass("has-onhover-animation"),this.rendered=!0,this.$lqipImg=null,this.useLqip=!o.isDownloadedSource&&this.mag?.viewOpts?.lqip&&(!!this.blurHash||o.useLambdaUrl(this.picture)||o.useLambdaUrlOldProjects(this.picture));let i=this.getPictureUrl();if(/\.gif/.test(i)&&(this.isGIF=!0),this.$el.html(""),this.isVector(i)&&!m.IS_FILE_PROTOCOL)this.loadVector(i);else{let s=!!(this.border_size>0||this.border_radius>0||this.border_radius_max||this.border_radius_independent&&(this.border_radius_tl>0||this.border_radius_tr>0||this.border_radius_bl>0||this.border_radius_br>0)||this.is_full_width||this.is_full_height),t=this.opacity===void 0?1:this.opacity;if(this.insideHotspot&&this.isGIF){let e=this.scale;(0,r.default)("<div/>").appendTo(this.$el).css({position:"absolute","background-image":"url("+i+")","background-position":"50% 50%",width:Math.max(Math.round(this.originalW*e),this.w),height:Math.max(Math.round(this.originalH*e),this.h),top:-Math.round(this.cropY*e),left:-Math.round(this.cropX*e)}).attr("url",i)}else if(s){let e=$(this.border_color||"000000",typeof this.border_color_opacity>"u"?1:this.border_color_opacity/100),h=`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`;(0,r.default)("<div/>").appendTo(this.$el).addClass("bgpic").css({"background-image":this.useLqip?"":`url(${i})`,"background-position":`${this.fhpos?this.fhpos:50}% ${this.fwpos?this.fwpos:50}%`,"box-shadow":this.border_size>0?`inset 0 0 0 ${this.border_size}px ${h}`:"none","border-radius":this.getBorderRadius(),opacity:this.useLqip?0:t}).attr("url",this.useLqip?"":i)}if(o.useLambdaUrl(this.picture)||o.useLambdaUrlOldProjects(this.picture)){let e=o.getSrcset(this.picture,{...this.getPictureOptions()});(0,r.default)("<img/>").attr("srcset",e).attr("alt",this.getAltText()).attr("src",i).addClass("viewable").toggleClass("saveable",!!(s||this.insideHotspot&&this.isGIF)).css("opacity",0).load(l.default.bind(function(){let h=this.$el.find(".viewable"),a=h&&h.get(0)&&h.get(0).currentSrc||i,n=this.$el.find(".bgpic");n&&n.css({opacity:t,"background-image":`url(${a})`}).attr("url",a),h&&h.css("opacity",t),this.$lqipImg&&this.$lqipImg.css("opacity",0),l.default.delay(l.default.bind(function(){this.$el.css({overflow:"","border-radius":""}),this.$lqipImg&&this.$lqipImg.remove(),this.$lqipImg=null,this.widgetIsLoaded()},this),200)},this)).on("error",l.default.bind(function(){this.$lqipImg&&this.$lqipImg.remove(),this.$lqipImg=null,this.widgetIsLoaded()},this)).appendTo(this.$el),this.useLqip&&(this.$el.css("overflow","hidden"),(this.border_radius||this.border_radius_max||this.border_radius_independent)&&this.$el.css("border-radius",this.getBorderRadius()),this.$lqipImg=(0,r.default)("<div/>").addClass("lqip").css({"background-image":`url("${this.blurHash?o.decodeBlurHash(this.blurHash,this.w,this.h):o.getLqipUrl(this.picture,{cropX:this.cropX,cropY:this.cropY,cropW:this.cropW,cropH:this.cropH,originalW:this.originalW,originalH:this.originalH})}")`,"background-position":"50% 50%",opacity:t}).appendTo(this.$el))}else(0,r.default)("<img/>").appendTo(this.$el).toggleClass("saveable",!!(s||this.insideHotspot&&this.isGIF)).css("opacity",typeof this.opacity>"u"?1:this.opacity).addClass("viewable").load(l.default.bind(function(){this.$el.find("img").attr("url",i),this.widgetIsLoaded()},this)).on("error",this.widgetIsLoaded).attr("srcset",this.getSrcset()).attr("alt",this.getAltText()).attr("src",i)}return this.checkLink(),this},getBorderRadius:function(){return this.border_radius_independent?`${this.border_radius_tl||0}px ${this.border_radius_tr||0}px ${this.border_radius_br||0}px ${this.border_radius_bl||0}px`:`${this.border_radius_max?"9999":this.border_radius||0}px`},isLightboxEnabled:function(){let i=!!this.getAnimations().find(t=>t.type==="click"&&t.steps&&t.steps.length),s=!!this.clickLink;return this.lightbox?this.lightbox.enabled&&!i&&!s:this.preview_enabled&&!i&&!s},isValid:function(){return!!(this.picture&&(this.picture.type||this.picture.unscaledUrl||this.picture.finalUrl||this.picture.editedVectorUrl||this.picture.url))},isVector:function(i,s){let t=i||this.picture&&this.picture.url;return(s||this.picture&&this.picture.type)==="svg"?!0:t&&l.default.last(t.split(".")).indexOf("svg")===0},start:function(){return u.prototype.start.call(this),Modernizr.safari&&this.isGIF&&this.$el.flashClass("fix-safari-gif",100),this},getPictureOptions:function(){let i=this.getAnimations().reduce((s,t)=>Math.max(s,x.maxScaleAnimation(t)),0);return{width:this.w,height:this.h,cropX:this.cropX,cropY:this.cropY,cropW:this.cropW,cropH:this.cropH,originalW:this.originalW,originalH:this.originalH,scale:d.isScaleLayout(this.mag.viewOpts)?this.page.scale:1,animationScale:i&&i/100,isStretched:this.is_full_width||this.is_full_height}},getPictureUrl:function(){if(!this.picture)return"";if(o.useLambdaUrl(this.picture)||o.useLambdaUrlOldProjects(this.picture))return o.getLambdaUrl(this.picture,this.getPictureOptions());if(this.picture.finalUrl&&l.default.last(this.picture.finalUrl.split(".")).indexOf("svg")===0)return this.picture.finalUrl;let i;return d.isOnForRatio(this.page.pageViewport,this.page.scale,this.mag.viewOpts)?i=this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl||this.picture.final2xUrl||this.picture.finalUrl:Modernizr.retina?i=(window.devicePixelRatio>=3?this.picture.final3xUrl||this.picture.unscaledOptimizedUrl||this.picture.final2xUrl:this.picture.final2xUrl)||this.picture.unscaledOptimizedUrl||this.picture.finalUrl:i=this.picture.finalUrl,(this.is_full_width||this.is_full_height)&&(i=this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl||this.picture.final2xUrl||this.picture.finalUrl),i||this.picture.effectUrl||this.picture.editedVectorUrl||this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl||this.picture.url},getAltText:function(){return this.picture&&this.alt?l.default.escape(this.alt):void 0},getSrcset:function(i=!0){if(!this.picture)return[];if(!this.originalW)return[];if(this.isGIF)return[];if(d.isOn(this.page.pageViewport,this.mag.getViewportWidth(this.page.pageViewport),this.mag.viewOpts))return[];if(this.getAnimations().length)return[];if(RM.screenshot)return[];if(this.picture.finalUrl&&l.default.last(this.picture.finalUrl.split(".")).indexOf("svg")===0)return[];let s=Math.floor(this.w),t=[{url:this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl,size:this.originalW},{url:this.picture.final2xUrl&&(this.picture.unscaledOptimizedUrl||this.picture.final3xUrl),size:s*3},{url:this.picture.final2xUrl,size:s*2},{url:this.picture.finalUrl,size:s}];if(t=t.filter(function(h){return!!h.url&&this.originalW>=h.size}.bind(this)).map(function(h){return`${h.url} ${h.size}w`}),!i)return t;let e=[`${this.picture.finalUrl||this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl} 1x`];return this.picture.final2xUrl&&e.push(`${this.picture.final2xUrl} 2x`),this.picture.final2xUrl&&(this.picture.unscaledOptimizedUrl||this.picture.final3xUrl)&&e.push(`${this.picture.final2xUrl&&(this.picture.unscaledOptimizedUrl||this.picture.final3xUrl)} 3x`),e.concat(t)},loadVector:function(i){this.$el.addClass("svg"),this.svgAjax=r.default.get(i+"?c",l.default.bind(function(s){let t=(0,r.default)(b.cleanupSVG((0,r.default)(s).find("svg").get(0).cloneNode(!0)));t.get(0).removeAttribute("width"),t.get(0).removeAttribute("height"),this.$svg=t;let e=t.get(0).cloneNode(!0);this.$svg.find("title").remove();let a=new Image;(0,r.default)(a).on("load error",l.default.bind(function(){(0,r.default)(a).appendTo(window.document.body).css({width:"100%",height:"100%"});let n=(0,r.default)(e);n.get(0).setAttribute("viewBox","0 0 "+(0,r.default)(a).width()+" "+(0,r.default)(a).height()),n.appendTo(window.document.body);let c=n.get(0).getBBox();this.$svg.get(0).setAttribute("viewBox",c.x+" "+c.y+" "+c.width+" "+c.height),this.$svg.get(0).setAttribute("preserveAspectRatio","xMidYMid meet"),this.$svg.get(0).setAttribute("role","img");let p=this.getAltText();p&&this.$svg.get(0).setAttribute("aria-label",p),(0,r.default)(a).remove(),n.remove();let g=(0,r.default)('<div class="svg-scale-wrapper"></div>');this.$svg.appendTo(g),g.appendTo(this.$el),this.widgetIsLoaded()},this)),a.src=i},this)).fail(this.widgetIsLoaded)},initLightbox:async function(){this.lightbox&&(this.$el.on("click",()=>{this.page.showLightboxSlide(this)}),this.$el.addClass("preview-enabled"))}}),P=S});export{P as a,A as b};
