import{P as C,Q as x}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-VYLMW4TI.js";import{b as I,c as S}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-HYYZOIQI.js";import{f as p,g as _,h as A,k,l as E,n as i,o as R}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-PJF6UIFY.js";import{a as D}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-CHUQBVQY.js";import{b as o,c as h}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-OAY73AJW.js";import{a as v}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-BHCSVH3M.js";import{a as u}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-L5GBYYT7.js";import{d as m}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-IDSWT3EJ.js";var n=m(u()),g=m(D());h();var y=m(v()),s=m(u());R();h();A();x();var O={initialize:function(t){s.default.bindAll(this),s.default.extend(this,t),this.currentData=this._initCurrentData(),window.gtag&&this.currentData.userId&&!window.RM.common.isDownloadedSource&&window.gtag("set",{user_id:this.currentData.userId}),(0,y.default)(s.default.bind(function(){this.initialTracking()},this))},initialTracking(){let t=i.getCookie("_rm_reg_cookie"),e=i.getCookie("_rm_join_analytics_data");this.trackPage(),t&&(RM.common.isDownloadedSource||i.trackPinterestConversion(o.PinterestTrackingEvents.Join),i.deleteCookie("_rm_reg_cookie"),_.sendConversionEvent({CONVERSION_ID:o.GOOGLE_ADS_ID,CONVERSION_LABEL:o.GOOGLE_CONVERSION_LABEL_REGISTRATION,value:15,transaction_id:""}),_.sendEventToLinkedInInsights({partnerId:o.linkedInPartnerId,eventId:p.Registration})),e&&i.deleteCookie("_rm_join_analytics_data")},sendEvent:function(t,e){if(!window.gtag||RM.constructorRouter&&RM.constructorRouter.previewMode)return;let r={};s.default.isObject(e)?r=s.default.extend(r,e):r.rm_parameter=e||void 0,window.gtag("event",t,{userId:this.currentData.userId,campaign:{name:this._rmdata?.first_campaign,source:this._rmdata?.first_source,medium:this._rmdata?.first_medium},c_id:this.currentData.gacid,rm_parameter:r.rm_parameter})},trackPage:function(){window.gtag&&(RM.constructorRouter&&RM.constructorRouter.previewMode||C()||window.gtag("event","page_view",{userId:this.currentData.userId,campaign:{name:this._rmdata?.first_campaign,source:this._rmdata?.first_source,medium:this._rmdata?.first_medium},c_id:this.currentData.gacid}))},_initCurrentData:function(){let t={};t.userId=null,window.ServerData.me&&(t.userId=window.ServerData.me._id||window.ServerData.me.user&&window.ServerData.me.user._id),t.gacid=i.getGAcid();let e=i.getCookie("_rmdata");return e&&(this._rmdata=JSON.parse(atob(e))),t}},l=O;var P={},w=P;var c=m(u());R();E();S();var T={initialize:function(t){c.default.bindAll(this),c.default.extend(this,t),this.shortlink_redirect=i.getCookie("shortlink_redirect"),this.initialTracking(),this.ecommerceEvents=["add_to_cart","view_cart","remove_from_cart","begin_checkout","purchase"]},setClientIdFromCookie:function(){let t=i.getCookie("_ga");if(t){let e=t.match(/GA[0-9]+\.[0-9]+\.(.*)/);this.clientId=e.length>1?e[1]:void 0,this.clientId&&window.gtag("set",{client_id:this.clientId})}},sendEvent:function(t,e){if(!window.gtag)return;if(!RM.common.isDomainViewer){let d=window.ServerData&&!window.ServerData.isCountryInEU&&window.Cookiebot&&!window.Cookiebot.declined,M=window.Cookiebot&&window.Cookiebot.consent.statistics;if(window.ServerData&&window.ServerData.isCountryInEU){if(!M&&!RM.common.isDomainViewer)return}else if(!d&&!RM.common.isDomainViewer)return}this.setClientIdFromCookie();let r={};if(c.default.isObject(e)?(r.rm_parameter=e.parameter,r.ecommerceData=e.ecommerceData):r.rm_parameter=e,RM.common.readymagTracker&&RM.common.isProjectOwnedByRM&&!this.ecommerceEvents.includes(t)){let d={userId:this.userId,firstCampaign:this._rmdata&&this._rmdata.first_campaign,firstMedium:this._rmdata&&this._rmdata.first_medium,campaign:{name:this._rmdata&&this._rmdata.first_campaign,source:this._rmdata&&this._rmdata.first_source,medium:this._rmdata&&this._rmdata.first_medium},c_id:this.clientId,rm_parameter:r.rm_parameter};window.gtag("event",t,d)}if(RM.common.userTracker&&!RM.common.homepageRewrite){let d={rm_parameter:r.rm_parameter,...r.ecommerceData?r.ecommerceData:void 0};window.gtag("event",t,d)}},trackPage:function(){window.gtag&&(this.setClientIdFromCookie(),RM.common.readymagTracker&&RM.common.isProjectOwnedByRM&&window.gtag("event","page_view",{userId:this.userId,firstCampaign:this._rmdata&&this._rmdata.first_campaign,firstMedium:this._rmdata&&this._rmdata.first_medium,campaign:{name:this._rmdata&&this._rmdata.first_campaign,source:this._rmdata&&this._rmdata.first_source,medium:this._rmdata&&this._rmdata.first_medium},c_id:this.clientId}),RM.common.userTracker&&window.gtag("event","page_view"),RM.common.readymagTracker&&RM.common.isProjectOwnedByRM&&i.initLinkedInInsights())},_processRedirectUTM:function(){if(!this.shortlink_redirect)return;let t=JSON.parse(atob(this.shortlink_redirect));return i.deleteCookie("shortlink_redirect"),{campaignName:t.utm_campaign,campaignSource:t.utm_source,campaignMedium:t.utm_medium}},initialTracking:function(){this._rmdata=i.createRmDataCookie(),I(),RM.common.isDomainViewer?this.trackPage():i.loadLoggedUser(t=>{k.waitForCookieConsent().then(e=>{if(!e.statistics){i.deleteCookie("_rmdata"),i.deleteCookie("_rm_amp_data");return}t&&t._id&&(this.userId=t._id,window.gtag&&window.gtag("set",{user_id:t._id}),window?.amplitude?.setUserId(t._id),i.getCookie("_rm_amp_data")&&i.deleteCookie("_rm_amp_data")),this.trackPage()})})}},f=T;var a={};if(typeof window<"u"){if(location.origin===o.readymag_auth_host&&l?a=g.default.Model.extend(n.default.extend(n.default.extend(a,l),w)):f?a=g.default.Model.extend(n.default.extend(n.default.extend(a,f),w)):console.error("Analytics initialization error!"),window.RM&&window.RM.customAnalyticsHandlers&&!n.default.isEmpty(window.RM.customAnalyticsHandlers.event)){let t=a.prototype.sendEvent;a.prototype.sendEvent=function(){if(!window.ga)return;let e=t.apply(this,arguments);return window.RM.customAnalyticsHandlers&&n.default.isFunction(window.RM.customAnalyticsHandlers.run)&&window.RM.customAnalyticsHandlers.run("event",e),e}}if(window.RM&&window.RM.customAnalyticsHandlers&&!n.default.isEmpty(window.RM.customAnalyticsHandlers.track)){let t=a.prototype.trackPage;a.prototype.trackPage=function(){if(!window.ga)return;let e=t.apply(this,arguments);return e&&window.RM.customAnalyticsHandlers&&n.default.isFunction(window.RM.customAnalyticsHandlers.run)&&window.RM.customAnalyticsHandlers.run("track",e),e}}}var K=a;export{K as a};
