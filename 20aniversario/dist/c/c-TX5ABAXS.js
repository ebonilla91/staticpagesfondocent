import{b as g,d as S}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-UMA5LGPS.js";import{b,c as u,f as M}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-ULGKTEVY.js";import{a as o,b as k}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-TRPHXH4T.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-CBJ3GPOZ.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-DQLWRJ6O.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-G2CN6UBK.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-Z63DEK6E.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-763KHRNL.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-C6HPUPCL.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-7G52Q5ZO.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-2XQ62BPU.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-53LSWZTP.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-XOCVWU26.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-F236UP3C.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-PVLTXVHG.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-6R4ZFWBW.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-CHZ44M2H.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-VZS75WCV.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-XZAKTUPJ.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-3CIGULBN.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-VXRXCMJL.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-HDRT62RD.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-LMXYD7AC.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-A4XRY3PY.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-TQPLAJYR.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-I4FBAQQB.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-X4WAQTSE.js";import{a as C}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-OWKND2N3.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-U3EQ6JVM.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-4FR22MFU.js";import{G as p,J as m}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-BPJUKUAP.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-3ZELX36Q.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-UPFOSVDA.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-PJF6UIFY.js";import{a as L}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-CHUQBVQY.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-U4UD4LYQ.js";import{a as c,b as P}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-QQSGI2X4.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-MKQKZXV6.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-42FJTMOJ.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-WSIFDYHJ.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-OAY73AJW.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-BWC6YUQZ.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-BHCSVH3M.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-TUZJEMYY.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-F5RDH3FM.js";import"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-L5GBYYT7.js";import{d as l,f as r}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-IDSWT3EJ.js";var v=l(C());k();var f=l(L());b();M();S();P();m();var a=class extends o{constructor(){super(...arguments);r(this,"sharedState");r(this,"triggerWidgets",[]);r(this,"handleClick",function(){++this.sharedState.clickCount}.bind(this));r(this,"handlePointerHover",function(i){this.sharedState.isPointerIn=i.type==="mouseenter"}.bind(this));r(this,"handlePointerState",function(i){this.sharedState.isPointerDown=i.type==="pointerdown"}.bind(this));r(this,"handleContextMenu",function(i){i.preventDefault()}.bind(this));r(this,"handlePointerMovement",function(i){if(!this.rendered)return;let n=(this.model.attributes.interactions||[]).find(E=>E.type==="cursor");if(!n)return;let t=i;"touches"in t&&this.getViewerType()==="horizontal"&&n.cursorDirection==="vertical"&&t.stopPropagation();let d=t.currentTarget,s=d instanceof Window?{width:window.innerWidth,height:window.innerHeight,left:0,top:0}:d.getBoundingClientRect(),h=c.isCSSTransform()?1:this.page.scale,w=t.clientX/h-s.left,y=t.clientY/h-s.top;n.cursorDirection==="vertical"?this.sharedState.hoverPercent=y/s.height:this.sharedState.hoverPercent=w/s.width}.bind(this))}initialize(e,i,n){this.model=new f.default.Model(e),o.prototype.initialize.apply(this,[e,i,n])}async render(){if(!this.model.attributes.uri)return;this.makeBox("widget-lottie");let{renderReact:e}=await import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-HKHNHOXO.js"),{LottieViewer:i}=await import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-RG2YYVLM.js");return this.sharedState=u(g()),e({component:()=>p(i,{widget:this.model.attributes,sharedState:this.sharedState}),domElement:this.el,model:this.model,onDestroy:()=>{let t=this.el;v.default.unmountComponentAtNode(t),t&&t.parentNode&&t.parentNode.removeChild(t)}}),this.rendered=!0,this.trigger("rendered"),this}start(...e){if(o.prototype.start.apply(this,e),!this.rendered)return this.listenToOnce(this,"rendered",this.start);this.bindTriggers()}async bindTriggers(){for(let e of this.model.attributes.interactions||[]){for(let i of e.triggers||[this.model.attributes._id]){let n=await Promise.all(this.page.mag.getAllWidgetViewsById(i,this.page));for(let t of n)if(t.el instanceof HTMLElement){switch(e.type){case"click":t.el.addEventListener("click",this.handleClick);break;case"hover":t.el.addEventListener("mouseenter",this.handlePointerHover),t.el.addEventListener("mouseleave",this.handlePointerHover);break;case"hold":t.el.addEventListener("pointerdown",this.handlePointerState),t.el.addEventListener("pointerup",this.handlePointerState),t.el.addEventListener("contextmenu",this.handleContextMenu);break;case"cursor":e.cursorZone==="widget"&&t.el.addEventListener("pointermove",this.handlePointerMovement);break}this.triggerWidgets.push(t)}}e.type==="cursor"&&e.cursorZone==="viewport"&&window.addEventListener("pointermove",this.handlePointerMovement)}}unbindTriggers(){for(let e of this.triggerWidgets)e.el instanceof HTMLElement&&(e.el.removeEventListener("click",this.handleClick),e.el.removeEventListener("mouseenter",this.handlePointerHover),e.el.removeEventListener("mouseleave",this.handlePointerHover),e.el.removeEventListener("pointerdown",this.handlePointerState),e.el.removeEventListener("pointerup",this.handlePointerState),e.el.removeEventListener("contextmenu",this.handleContextMenu),e.el.removeEventListener("pointermove",this.handleContextMenu));window.removeEventListener("pointermove",this.handleContextMenu)}getViewerType(){return this.mag&&this.mag.viewOpts&&this.mag.viewOpts.viewertype||"vertical"}destroy(...e){this.unbindTriggers(),o.prototype.destroy.apply(this,e)}},Z=a;export{Z as default};
