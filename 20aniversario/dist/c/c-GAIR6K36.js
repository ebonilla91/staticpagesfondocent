import{a as Wt}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-MKYXF3PJ.js";import{a as Ot}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-3CSTZLMM.js";import{a as xe,b as wi,c as Pt,d as bi}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-DNBTMVWU.js";import{a as gt,b as ci}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-V6DMATY4.js";import{a as Pi}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-PDOTQNK5.js";import{a as zt,b as vi}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-6BKLO42J.js";import{c as Tt,e as yi}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-D372SFZM.js";import{a as _t,b as ki}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-J3HJRHNH.js";import{b as G,c as Q,e as ve}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-2EGNLUPQ.js";import{a as Z,b as vt}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-CBJ3GPOZ.js";import{a as B,b as le}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-DQLWRJ6O.js";import{a as $t}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-A75HCH5P.js";import{a as St,b as Ct,d as xi}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-YIIEA5PP.js";import{a as E,b as yt}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-CYE3FJNA.js";import{a as At}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-VSMATE4X.js";import{b as Mt}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-JOW4NFYO.js";import{a as $e,b as fi}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-H5WAD6OX.js";import{c as O,d as Ye}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-G2CN6UBK.js";import{b as xt,k as ui}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-TVFWAXKI.js";import{B as hi,tb as Ge,ub as gi,v as bt}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-Z63DEK6E.js";import{e as ft,g as mi}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-XOCVWU26.js";import{a as Ae,b as kt}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-SMPJI3TF.js";import{a as di}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-OWKND2N3.js";import{G as ut,J as wt}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-BPJUKUAP.js";import{i as U,j as Fe,k as ct,l as li,n as y,o as _e}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-PJF6UIFY.js";import{a as ne}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-CHUQBVQY.js";import{a as W,b as Te,c as ae,d as Ne,l as ht,m as mt,p as M,q as He}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-QQSGI2X4.js";import{a as fe,c as dt}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-MKQKZXV6.js";import{b as H,c as De}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-OAY73AJW.js";import{a as Be,b as lt}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-BWC6YUQZ.js";import{a as ge}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-BHCSVH3M.js";import{a as g,b as re}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-F5RDH3FM.js";import{a as oe}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-L5GBYYT7.js";import{d as A,f as pt}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-IDSWT3EJ.js";window.Modernizr=function(e,t,i){var o="2.8.3",r={},n=!0,a=t.documentElement,s="modernizr",p=t.createElement(s),c=p.style,u=t.createElement("input"),v=":)",S={}.toString,z=" -webkit- -moz- -o- -ms- ".split(" "),_="Webkit Moz O ms",X=_.split(" "),ue=_.toLowerCase().split(" "),F={svg:"http://www.w3.org/2000/svg"},b={},tt={},ze={},Ee=[],Ve=Ee.slice,Se,he=function(l,d,w,f){var C,N,j,te,Y=t.createElement("div"),pe=t.body,L=pe||t.createElement("body");if(parseInt(w,10))for(;w--;)j=t.createElement("div"),j.id=f?f[w]:s+(w+1),Y.appendChild(j);return C=["&#173;",'<style id="s',s,'">',l,"</style>"].join(""),Y.id=s,(pe?Y:L).innerHTML+=C,L.appendChild(Y),pe||(L.style.background="",L.style.overflow="hidden",te=a.style.overflow,a.style.overflow="hidden",a.appendChild(L)),N=d(Y,l),pe?Y.parentNode.removeChild(Y):(L.parentNode.removeChild(L),a.style.overflow=te),!!N},ti=function(l){var d=e.matchMedia||e.msMatchMedia;if(d)return d(l)&&d(l).matches||!1;var w;return he("@media "+l+" { #"+s+" { position: absolute; } }",function(f){w=(e.getComputedStyle?getComputedStyle(f,null):f.currentStyle).position=="absolute"}),w},it=function(){var l={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};function d(w,f){f=f||t.createElement(l[w]||"div"),w="on"+w;var C=w in f;return C||(f.setAttribute||(f=t.createElement("div")),f.setAttribute&&f.removeAttribute&&(f.setAttribute(w,""),C=ee(f[w],"function"),ee(f[w],"undefined")||(f[w]=i),f.removeAttribute(w))),f=null,C}return d}(),Ie={}.hasOwnProperty,Ce;!ee(Ie,"undefined")&&!ee(Ie.call,"undefined")?Ce=function(l,d){return Ie.call(l,d)}:Ce=function(l,d){return d in l&&ee(l.constructor.prototype[d],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(d){var w=this;if(typeof w!="function")throw new TypeError;var f=Ve.call(arguments,1),C=function(){if(this instanceof C){var N=function(){};N.prototype=w.prototype;var j=new N,te=w.apply(j,f.concat(Ve.call(arguments)));return Object(te)===te?te:j}else return w.apply(d,f.concat(Ve.call(arguments)))};return C});function me(l){c.cssText=l}function ii(l,d){return me(z.join(l+";")+(d||""))}function ee(l,d){return typeof l===d}function we(l,d){return!!~(""+l).indexOf(d)}function ot(l,d){for(var w in l){var f=l[w];if(!we(f,"-")&&c[f]!==i)return d=="pfx"?f:!0}return!1}function oi(l,d,w){for(var f in l){var C=d[l[f]];if(C!==i)return w===!1?l[f]:ee(C,"function")?C.bind(w||d):C}return!1}function V(l,d,w){var f=l.charAt(0).toUpperCase()+l.slice(1),C=(l+" "+X.join(f+" ")+f).split(" ");return ee(d,"string")||ee(d,"undefined")?ot(C,d):(C=(l+" "+ue.join(f+" ")+f).split(" "),oi(C,d,w))}b.flexbox=function(){return V("flexWrap")},b.flexboxlegacy=function(){return V("boxDirection")},b.canvas=function(){var l=t.createElement("canvas");return!!(l.getContext&&l.getContext("2d"))},b.canvastext=function(){return!!(r.canvas&&ee(t.createElement("canvas").getContext("2d").fillText,"function"))},b.webgl=function(){return!!e.WebGLRenderingContext},b.touch=function(){var l;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?l=!0:he(["@media (",z.join("touch-enabled),("),s,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(d){l=d.offsetTop===9}),l},b.geolocation=function(){return"geolocation"in navigator},b.postmessage=function(){return!!e.postMessage},b.websqldatabase=function(){return!!e.openDatabase},b.indexedDB=function(){return!!V("indexedDB",e)},b.hashchange=function(){return it("hashchange",e)&&(t.documentMode===i||t.documentMode>7)},b.history=function(){return!!(e.history&&history.pushState)},b.draganddrop=function(){var l=t.createElement("div");return"draggable"in l||"ondragstart"in l&&"ondrop"in l},b.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},b.rgba=function(){return me("background-color:rgba(150,255,150,.5)"),we(c.backgroundColor,"rgba")},b.hsla=function(){return me("background-color:hsla(120,40%,100%,.5)"),we(c.backgroundColor,"rgba")||we(c.backgroundColor,"hsla")},b.multiplebgs=function(){return me("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(c.background)},b.backgroundsize=function(){return V("backgroundSize")},b.borderimage=function(){return V("borderImage")},b.borderradius=function(){return V("borderRadius")},b.boxshadow=function(){return V("boxShadow")},b.textshadow=function(){return t.createElement("div").style.textShadow===""},b.opacity=function(){return ii("opacity:.55"),/^0.55$/.test(c.opacity)},b.cssanimations=function(){return V("animationName")},b.csscolumns=function(){return V("columnCount")},b.cssgradients=function(){var l="background-image:",d="gradient(linear,left top,right bottom,from(#9f9),to(white));",w="linear-gradient(left top,#9f9, white);";return me((l+"-webkit- ".split(" ").join(d+l)+z.join(w+l)).slice(0,-l.length)),we(c.backgroundImage,"gradient")},b.cssreflections=function(){return V("boxReflect")},b.csstransforms=function(){return!!V("transform")},b.csstransforms3d=function(){var l=!!V("perspective");return l&&"webkitPerspective"in a.style&&he("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(d,w){l=d.offsetLeft===9&&d.offsetHeight===3}),l},b.csstransitions=function(){return V("transition")},b.fontface=function(){var l;return he('@font-face {font-family:"font";src:url("https://")}',function(d,w){var f=t.getElementById("smodernizr"),C=f.sheet||f.styleSheet,N=C?C.cssRules&&C.cssRules[0]?C.cssRules[0].cssText:C.cssText||"":"";l=/src/i.test(N)&&N.indexOf(w.split(" ")[0])===0}),l},b.generatedcontent=function(){var l;return he(["#",s,"{font:0/0 a}#",s,':after{content:"',v,'";visibility:hidden;font:3px/1 a}'].join(""),function(d){l=d.offsetHeight>=3}),l},b.video=function(){var l=t.createElement("video"),d=!1;try{(d=!!l.canPlayType)&&(d=new Boolean(d),d.ogg=l.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),d.h264=l.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),d.webm=l.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch{}return d},b.audio=function(){var l=t.createElement("audio"),d=!1;try{(d=!!l.canPlayType)&&(d=new Boolean(d),d.ogg=l.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),d.mp3=l.canPlayType("audio/mpeg;").replace(/^no$/,""),d.wav=l.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),d.m4a=(l.canPlayType("audio/x-m4a;")||l.canPlayType("audio/aac;")).replace(/^no$/,""))}catch{}return d},b.localstorage=function(){try{return localStorage.setItem(s,s),localStorage.removeItem(s),!0}catch{return!1}},b.sessionstorage=function(){try{return sessionStorage.setItem(s,s),sessionStorage.removeItem(s),!0}catch{return!1}},b.webworkers=function(){return!!e.Worker},b.applicationcache=function(){return!!e.applicationCache},b.svg=function(){return!!t.createElementNS&&!!t.createElementNS(F.svg,"svg").createSVGRect},b.inlinesvg=function(){var l=t.createElement("div");return l.innerHTML="<svg/>",(l.firstChild&&l.firstChild.namespaceURI)==F.svg},b.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(S.call(t.createElementNS(F.svg,"animate")))},b.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(S.call(t.createElementNS(F.svg,"clipPath")))};function ri(){r.input=function(l){for(var d=0,w=l.length;d<w;d++)ze[l[d]]=l[d]in u;return ze.list&&(ze.list=!!(t.createElement("datalist")&&e.HTMLDataListElement)),ze}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),r.inputtypes=function(l){for(var d=0,w,f,C,N=l.length;d<N;d++)u.setAttribute("type",f=l[d]),w=u.type!=="text",w&&(u.value=v,u.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(f)&&u.style.WebkitAppearance!==i?(a.appendChild(u),C=t.defaultView,w=C.getComputedStyle&&C.getComputedStyle(u,null).WebkitAppearance!=="textfield"&&u.offsetHeight!==0,a.removeChild(u)):/^(search|tel)$/.test(f)||(/^(url|email)$/.test(f)?w=u.checkValidity&&u.checkValidity()===!1:w=u.value!=v)),tt[l[d]]=!!w;return tt}("search tel url email datetime date month week time datetime-local number range color".split(" "))}for(var Le in b)Ce(b,Le)&&(Se=Le.toLowerCase(),r[Se]=b[Le](),Ee.push((r[Se]?"":"no-")+Se));r.input||ri(),r.addTest=function(l,d){if(typeof l=="object")for(var w in l)Ce(l,w)&&r.addTest(w,l[w]);else{if(l=l.toLowerCase(),r[l]!==i)return r;d=typeof d=="function"?d():d,typeof n<"u"&&n&&(a.className+=" "+(d?"":"no-")+l),r[l]=d}return r},me(""),p=u=null;return function(l,d){var w="3.7.0",f=l.html5||{},C=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,N=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,j,te="_html5shiv",Y=0,pe={},L;(function(){try{var x=d.createElement("a");x.innerHTML="<xyz></xyz>",j="hidden"in x,L=x.childNodes.length==1||function(){d.createElement("a");var k=d.createDocumentFragment();return typeof k.cloneNode>"u"||typeof k.createDocumentFragment>"u"||typeof k.createElement>"u"}()}catch{j=!0,L=!0}})();function ni(x,k){var $=x.createElement("p"),R=x.getElementsByTagName("head")[0]||x.documentElement;return $.innerHTML="x<style>"+k+"</style>",R.insertBefore($.lastChild,R.firstChild)}function rt(){var x=be.elements;return typeof x=="string"?x.split(" "):x}function Re(x){var k=pe[x[te]];return k||(k={},Y++,x[te]=Y,pe[Y]=k),k}function nt(x,k,$){if(k||(k=d),L)return k.createElement(x);$||($=Re(k));var R;return $.cache[x]?R=$.cache[x].cloneNode():N.test(x)?R=($.cache[x]=$.createElem(x)).cloneNode():R=$.createElem(x),R.canHaveChildren&&!C.test(x)&&!R.tagUrn?$.frag.appendChild(R):R}function ai(x,k){if(x||(x=d),L)return x.createDocumentFragment();k=k||Re(x);for(var $=k.frag.cloneNode(),R=0,st=rt(),pi=st.length;R<pi;R++)$.createElement(st[R]);return $}function si(x,k){k.cache||(k.cache={},k.createElem=x.createElement,k.createFrag=x.createDocumentFragment,k.frag=k.createFrag()),x.createElement=function($){return be.shivMethods?nt($,x,k):k.createElem($)},x.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+rt().join().replace(/[\w\-]+/g,function($){return k.createElem($),k.frag.createElement($),'c("'+$+'")'})+");return n}")(be,k.frag)}function at(x){x||(x=d);var k=Re(x);return be.shivCSS&&!j&&!k.hasCSS&&(k.hasCSS=!!ni(x,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),L||si(x,k),x}var be={elements:f.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:w,shivCSS:f.shivCSS!==!1,supportsUnknownElements:L,shivMethods:f.shivMethods!==!1,type:"default",shivDocument:at,createElement:nt,createDocumentFragment:ai};l.html5=be,at(d)}(e,e.document),r._version=o,r._prefixes=z,r._domPrefixes=ue,r._cssomPrefixes=X,r.mq=ti,r.hasEvent=it,r.testProp=function(l){return ot([l])},r.testAllProps=V,r.testStyles=he,r.prefixed=function(l,d,w){return d?V(l,d,w):V(l,"pfx")},a.className=a.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(n?" js "+Ee.join(" "):""),r}(window,window.document);(function(){Modernizr.addTest("retina",function(){return window.devicePixelRatio>1}),Modernizr.addTest("android",function(){return window.navigator.userAgent.toLowerCase().match(/Android/i)}),Modernizr.addTest("amazonsilk",function(){return/\bSilk\b/.test(navigator.userAgent)}),Modernizr.addTest("Mac",function(){return window.navigator.userAgent.indexOf("Mac")!=-1}),Modernizr.addTest("Windows",function(){return window.navigator.userAgent.indexOf("Windows NT")!=-1}),Modernizr.addTest("webkit",function(){return window.navigator.userAgent.indexOf("AppleWebKit")!=-1}),Modernizr.addTest("opera",function(){return!!(window.opera&&window.opera.buildNumber)}),Modernizr.addTest("chrome",function(){return window.navigator&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Modernizr.addTest("msie",function(){return!!Function("/*@cc_on return document.documentMode===10@*/")()}),Modernizr.addTest("msie11",function(){return navigator.userAgent.indexOf("Trident/")!=-1&&(navigator.userAgent.indexOf("rv:")!=-1||navigator.appName.indexOf("Netscape")!=-1)}),Modernizr.addTest("winphone8",function(){return navigator.userAgent.indexOf("Trident/")!=-1&&(navigator.userAgent.indexOf("Phone")!=-1||navigator.userAgent.indexOf("IEMobile/")!=-1)}),Modernizr.addTest("safari",function(){return navigator.userAgent.indexOf("Safari")!=-1&&(navigator.userAgent.indexOf("Mac")!=-1||navigator.userAgent.indexOf("Windows"))&&navigator.userAgent.indexOf("Chrome")==-1}),Modernizr.addTest("safari5",function(){return!!navigator.userAgent.match(" Safari/")&&!navigator.userAgent.match(" Chrom")&&!!navigator.userAgent.match(" Version/5.")}),Modernizr.addTest("isipad",function(){return window.navigator.userAgent.toLowerCase().match(/ipad/i)}),Modernizr.addTest("ismobile",function(){return window.navigator.userAgent.toLowerCase().match(/android|webos|iphone|ipad|ipod|blackberry|playbook|iemobile|windows phone|kindle|silk|opera mini/i)}),Modernizr.addTest("firefox",function(){return window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}),Modernizr.addTest("edge",function(){return window.navigator.userAgent.toLowerCase().indexOf("edge")>-1}),Modernizr.addTest("csspositionsticky",function(){var e="position:",t="sticky",i=document.createElement("modernizr"),o=i.style;return o.cssText=e+Modernizr._prefixes.join(t+";"+e).slice(0,-e.length),o.position.indexOf(t)!==-1})})();bi();re();var Ue=class{constructor(){pt(this,"timings");this.timings={}}setTiming(t,i){this.timings[t]=i}sendTimings(t){let i={};Object.keys(this.timings).forEach(a=>{i[a]=this.timings[a]-window.performance.timing.navigationStart});let r=window.innerWidth,n=!g.isDesktop||Modernizr.ismobile?Modernizr.isipad||r>=600?"tablet":"phone":"desktop";Pt("frontend-rendering",{"project.numId":t.projectNumId,"user.numId":t.userNumId,"project.viewport":t.viewport,"project.startPage":t.startPage,"project.widgetsCount":t.widgetsCount,device:n,timing:i})}},zi=new Ue,Xe=zi;Fe();var ye=class extends At{triggerDataChanges(t){super.triggerDataChanges(t),t.provider&&U.trigger("ecommerce:update:provider",t.provider),t.products&&U.trigger("ecommerce:loadproducts:complete",t.products)}};lt();dt();var se={};function Si(e){return new Promise(t=>{switch(e){case"addtocart":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-M732PWCH.js"));break;case"audio":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-NKWSDWZ2.js"));break;case"background":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-4VRISYSP.js"));break;case"button":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-NZGYBNPE.js"));break;case"ecommercecart":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-RRMESW55.js"));break;case"facebook":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-VDKPUZX6.js"));break;case"form":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-EVKUCQWA.js"));break;case"picture":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-UCZ3ETW6.js"));break;case"gmaps":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-R55MMXQ4.js"));break;case"hotspot":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-3BHTSTLZ.js"));break;case"iframe":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-7DUGO2MU.js"));break;case"shape":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-WOHESS3K.js"));break;case"slideshow":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-Q2OT5QC5.js"));break;case"text":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-6KKFJ56F.js"));break;case"twitter":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-HUHDTUYH.js"));break;case"video":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-56LG5I3W.js"));break;case"rmfooter":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-7TZKA5TR.js"));break;case"rmheader":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-BV5RUIA6.js"));break;case"shots":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-XTHLXLLL.js"));break;case"lottie":t(import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-TX5ABAXS.js"));break;default:break}})}async function Gi(e=[]){let t=e?.length?e:Object.values(Be);fe("widget.lottie")||(t=t.filter(o=>o!=="lottie"));let i=t.map(o=>Si(o).then(r=>{se[o]=r.default}));return Promise.all(i)}var Qe=A(di()),ce=A(ge()),Ze=A(ne()),P=A(oe());le();var Et={"template-viewer-page":B`
  <article class="page hidden">
    <div id="page-<%=pageNum%>-password-container" class="polyfill-sticky"></div>
    <div class="page-fixed-bg-container polyfill-sticky"></div>
    <div class="fixed-position-container-top polyfill-sticky"></div>
    <div class="fixed-position-container polyfill-sticky"></div>
    <div class="content-scroll-wrapper <%=isStickyVerticalViewer ? '' : 'has-vertical-scroll'%>">
      <div class="content-bounds">
        <div class="page-content-container"></div>
      </div>
    </div>
  </article>
`};ki();_e();fi();Te();Ye();var je=A(ne()),T=A(oe());_e();Ye();Te();Ne();re();var Ci=je.default.View.extend({initialize:function(e){T.default.bindAll(this),T.default.extend(this,e);let t={};T.default.each(this.widgets,T.default.bind(function(o){if(o.hasAnimation()){let r=o.fixed_position||o.is_full_width||o.is_full_height||o.sticked?y.generateUUID():O.getUuidHash(o.getAnimations())||y.generateUUID();t[r]=t[r]||[],t[r].push(o)}},this)),this.animations=[];let i=!g.isDesktop||!Modernizr.safari;T.default.each(t,function(o){this.addAnimation(o,{allowAccelerate:i})}.bind(this)),this.start.__debounced=T.default.debounce(this.start,300)},addAnimation:function(e,t){t=t||{},e=T.default.isArray(e)?e:[e];let i=["nonMove","moveOnly",...O.EVENT_TYPES].reverse();[...e[0].getAnimations()].map(r=>O.isMoveOnly(r)?{...r,effects:"moveOnly"}:O.isNonMove(r)?{...r,effects:"nonMove"}:r).sort((r,n)=>i.indexOf(r.effects||r.type)-i.indexOf(n.effects||n.type)).filter(r=>!O.isEmpty(r)).map(r=>{let n=r.type,a=e[0].animationObjects,s=!!(a&&a.length),p=new ke[n]({page:this.page,widgets:e,rawAnimation:r,$container:s?a[a.length-1].$el:void 0,allowAccelerate:t.allowAccelerate,isNested:s,topmostAnimation:s?a[0]:void 0});this.animations.push(p)})},removeAnimation:function(e){this.animations=T.default.without(this.animations,e),e&&e.destroy()},start:function(){T.default.each(this.animations,function(e){e.start()})},stop:function(){T.default.each(this.animations,function(e){e.stop()})},resetStarted:function(){T.default.each(this.animations,function(e){e.started=!1})},onScroll:function(e){e=e||{},!(this.page.mag.currentPage!==this.page&&!e.forceApply)&&T.default.each(this.animations,function(t){t.onScroll&&t.onScroll(e)})},onResize:function(e){T.default.each(this.animations,function(t){t.onResize(e)})},updateTimelines:function(e=[]){T.default.each(this.animations,function(t){e.includes(t.animation.UUID)||t.createAnimationTimeline()})},hasScaleUp:function(){return!!T.default.find(this.animations,function(e){return O.isScaleUp(e.animation)})},destroy:function(){T.default.each(this.animations,function(e){e.destroy()}),delete this.animations}}),ke={},q=je.default.View.extend({visibilityRatio:.2,className:"animation-container",scrolledToView:!1,useOnscrollBoundsFallback:typeof window<"u"&&!window.IntersectionObserver,initialize:function(e){T.default.bindAll(this),T.default.extend(this,e),T.default.each(this.widgets,T.default.bind(function(t){t.animationObj=this,t.animationObjects=[...t.animationObjects||[],this]},this)),this.isFixed=this.widgets[0].fixed_position,this.isFullwidth=this.widgets[0].is_full_width,this.isFullheight=this.widgets[0].is_full_height,this.isSticked=this.widgets[0].sticked,this.isAbove=this.widgets[0].is_above,this.playOnce=!this.page.mag.isPreview&&this.playOnce,this.$container=this.$container||(this.isFixed||this.isAbove?this.widgets[0].$fixedContainer:this.page.$content),this.$el.appendTo(this.$wrapper?this.$wrapper:this.$container),this.createAnimationTimeline(e),this.onResize({updateAll:!0})},createAnimationTimeline:function(){this.timeline&&this.timeline.destroy(),this.animation=O.getNormalizedAnimation(this.rawAnimation,this.isFixed,this.isFullwidth,this.isFullheight,this.page.scale,this.page.pageViewport,this.page.mag.getViewportWidth(this.page.pageViewport),this.page.mag.viewOpts,!0);let e={t:Number.POSITIVE_INFINITY,l:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,r:Number.NEGATIVE_INFINITY};this.widgets.forEach(t=>{let i=t.calcBoxStyle({calcBBox:!0}).dimensions;e.t=Math.min(e.t,i.top),e.l=Math.min(e.l,i.left),e.b=Math.max(e.b,i.top+i.height),e.r=Math.max(e.r,i.left+i.width)}),this.timeline=O.createAnimationTimeline({UUID:this.animation.UUID,el:this.$el,steps:this.animation.steps,type:this.animation.type,force3d:!1,animationTrigger:this.animation.trigger,selfTriggered:!!T.default.intersection(O.normalizeAnimationTriggers(this.animation.trigger),this.widgets.map(t=>t._id)).length,screenshotMode:!!RM.screenshot,centerPoint:{x:(e.r-e.l)/2,y:(e.b-e.t)/2}})},start:function(){!this.timeline||!this.paused||(this.paused=!1,this.timeline.resume())},stop:function(){!this.timeline||!this.timeline.active||this.isAbove||(this.paused=!0,this.timeline.pause())},getAnimationContainer:function(){return this.$el},modifyWidgetPosition:function(e){return this.isFixed?(e.dimensions.left="50%",e.dimensions.top="50%",e.dimensions.right="",e.dimensions.bottom="",e.dimensions["margin-left"]=-e.dimensions.width/2,e.dimensions["margin-top"]=-e.dimensions.height/2):(e.dimensions.left-=this.bbox_css.left+(this.isNested?this.topmostAnimation.bbox_css.left:0),e.dimensions.top-=this.bbox_css.top+(this.isNested?this.topmostAnimation.bbox_css.top:0)),e},onResize:function(e){if(e=e||{},e.updateAll||this.isFixed&&this.prevPageScale!==this.page.scale||this.isFullwidth||this.isFullheight||this.isSticked){let t={t:Number.POSITIVE_INFINITY,l:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,r:Number.NEGATIVE_INFINITY,z:0},i;this.isFixed||this.isFullwidth||this.isFullheight||this.isSticked?this.bbox_css={...this.widgets[0].calcBoxStyle({calcBBox:!0}).dimensions,...this.isNested?{left:0,top:0,"margin-left":0,"margin-top":0}:{}}:(T.default.each(this.widgets,function(o){i=o.calcBoxStyle({calcBBox:!0}).dimensions,t.t=Math.min(t.t,i.top),t.l=Math.min(t.l,i.left),t.b=Math.max(t.b,i.top+i.height),t.r=Math.max(t.r,i.left+i.width),t.z=Math.max(t.z,i["z-index"])},this),this.bbox_css={left:this.isNested?0:t.l,top:this.isNested?0:t.t,width:t.r-t.l,height:t.b-t.t,"z-index":t.z}),this.$el.css(this.bbox_css)}this.innerContentTop=this.page.contentPosition.top/this.page.scale,this.innerContainerHeight=this.page.mag.getContainerSizeCached().height/this.page.scale,this.prevPageScale=this.page.scale},withTriggerOrElement(e){let t=this.animation.trigger.filter(o=>o).reduce((o,r)=>o.concat(o,this.page.mag.getAllWidgetViewsById(r,this.page)),[]),i=0;t.forEach(o=>{o.then(r=>{r.rendered?e(r.$el):this.listenToOnce(r,"rendered",()=>e(r.$el))}).catch(()=>{i++,i===t.length&&e(this.$el)})}),t.length||e(this.$el)},getBBScaleFactor(){return W.isOnForRatio(this.page.pageViewport,this.page.scale,this.page.mag.viewOpts)&&W.isCSSZoom()?this.page.scale:1},isInView(){let e=ae.getBoundingBoxOfElements(this.widgets.map(t=>t.$el[0]),this.getBBScaleFactor());return ae.isBoxInView(e,this.visibilityRatio)},notifyWhenInOrOutOfView(){window.requestAnimationFrame(()=>{this.isInView()?(this.scrolledToView=!0,this.scrolledOutOfView=!1,this.trigger("scrolledToView")):(this.scrolledToView=!1,this.scrolledOutOfView=!0,this.trigger("scrolledOutOfView"))})},whenInView(){return this.whenInOrOutOfView("in")},whenOutOfView(){return this.isInView()?this.whenInOrOutOfView("out"):this.whenInOrOutOfView("in").then(()=>this.whenInOrOutOfView("out"))},whenInOrOutOfView(e="in"){let t=e==="in",i=e==="out";if(this.useOnscrollBoundsFallback)return t&&this.isInView()||i&&!this.isInView()?window.Promise.resolve():new window.Promise(o=>{this.listenToOnce(this,i?"scrolledOutOfView":"scrolledToView",o)});{let o=this.widgets.map(n=>n.$el[0]),r=ae.getBoundingBoxOfElements(o,this.getBBScaleFactor());if(t)return new window.Promise(n=>{let a=new window.IntersectionObserver(s=>{s.some(p=>p.isIntersecting)&&(o.forEach(p=>a.unobserve(p)),n())},{rootMargin:`-${r.height*this.visibilityRatio}px 0px`});o.forEach(s=>a.observe(s))});if(i)return Promise.all(o.map(n=>new window.Promise(a=>{let s=new window.IntersectionObserver(p=>{p.every(c=>!c.isIntersecting)&&(s.unobserve(n),a())});s.observe(n)})))}},destroy:function(){this.stop(),this.timeline&&this.timeline.destroy(),this.remove()}});ke.scroll=q.extend({onScroll:function(e){if(e=e||{},!this.timeline||(this.page.mag.currentPage!==this.page||this.isAbove)&&!e.forceApply)return;let t=this.isAbove?e.scroll:Math.max(0,this.page.visibleWidgetsCoords.scrollTop||0);if(this.isFixed){this.timeline.seek(t);return}let i={top:1,center:.5,bottom:0},o=this.animation.steps[0].start_point||"bottom",n=this.bbox_css.top+(this.isNested?this.topmostAnimation.bbox_css.top:0)+this.innerContentTop,a=n-this.innerContainerHeight,s=i[o],p=s*(n-a)+a+this.animation.steps[0].start_offset||0;p<=0?this.timeline.seek(t/this.page.scale):this.timeline.seek(Math.max(0,t-p*this.page.scale)/this.page.scale)},onResize:function(){q.prototype.onResize.apply(this,arguments),this.onScroll()}});ke.load=q.extend({initialize:function(){q.prototype.initialize.apply(this,arguments);let e=this.animation.steps;this.startWhenInView=e&&e.length&&e[0].startWhenInView,this.notifyWhenInOrOutOfView.__throttled=T.default.throttle(this.notifyWhenInOrOutOfView,100)},start:function(){q.prototype.start.apply(this,arguments),this.isReady().then(function(){this.timeline.play(),this.started=!0}.bind(this)).catch(function(e){e&&console.log(e&&e.stack)})},onScroll:function(){this.useOnscrollBoundsFallback&&this.notifyWhenInOrOutOfView.__throttled()},isReady:function(){let e;if(RM.screenshot||this.started||y.PageVisibilityManager.isPageHidden())e=window.Promise.reject();else{let t=this.widgets[0],i=[],o=window.Promise.all(this.widgets.map(r=>r.loaded?window.Promise.resolve():new window.Promise(n=>this.listenToOnce(r,"loaded",n))));if(this.isAbove){let r=this.page.mag.aboveAnimationsReady?window.Promise.resolve():new window.Promise(function(s){this.listenToOnce(this.page.mag,"aboveAnimationsReady",s)}.bind(this)),n=t.rendered?window.Promise.resolve():new window.Promise(function(s){this.listenToOnce(t,"rendered",s)}.bind(this)),a=t.wasHidden?new window.Promise(function(s){this.listenToOnce(t,"shown",s)}.bind(this)):window.Promise.resolve();i=this.startWhenInView?[n,a,o]:[r,n,a,o]}else{let r=this.page.started?window.Promise.resolve():new window.Promise(function(p){this.listenToOnce(this.page,"started",p)}.bind(this)),n=this.page.loadAnimationsReady?window.Promise.resolve():new window.Promise(function(p){this.listenToOnce(this.page,"loadAnimationsReady",p)}.bind(this)),a=this.page.isCurrent()?window.Promise.resolve():new window.Promise(function(p){this.listenToOnce(this.page,"changedTo",p)}.bind(this)),s=this.startWhenInView?o.then(()=>this.whenInView()):window.Promise.resolve();i=this.startWhenInView?[r,a,s]:[n,r]}e=window.Promise.all(i)}return e}});ke.click=q.extend({resetWhenOutOfView:!1,initialize:function(){q.prototype.initialize.apply(this,arguments);let e="pointer";this.page?.mag?.opts.useCustomCursor&&this.page?.mag?.opts.customHoverCursorImage&&(e=y.getCursorStylesString({cusrsorUrl:this.page.mag.opts.customHoverCursorImage,cursorSize:this.page.mag.opts.customHoverCursorSize,isLambda:this.page.mag.opts.customHoverCursorIsLambda,isHover:!0}));let t=function(i){i.on("click",this.onClick),i.css("cursor",e)}.bind(this);this.willStopOnEnd=!1,this.lastTimeClick=0,this.withTriggerOrElement(t),this.notifyWhenInOrOutOfView.__throttled=T.default.throttle(this.notifyWhenInOrOutOfView,100)},onClick:function(){let e=O.getPermanentAnimationId(this.widgets[0],this.animation.UUID),t=this.timeline&&!this.timeline.active&&this.timeline.reversed&&O.hasPlayed(e);!this.timeline||t||+new Date-this.lastTimeClick<300||(this.lastTimeClick=+new Date,this.timeline.active?(this.willStopOnEnd?this.timeline.off("full-cycle-end",this.onCycleEnd):this.timeline.on("full-cycle-end",this.onCycleEnd),this.willStopOnEnd=!this.willStopOnEnd):(this.willStopOnEnd=!1,this.timeline.reversed?this.timeline.reverse():this.timeline.play(),this.animation.playOnce&&!O.hasPlayed(e)&&O.persistHasPlayed(e),this.animation.resetWhenOutOfView&&this.whenOutOfView().then(()=>{this.timeline.stop(),this.timeline.applyStepState("initial"),this.timeline.reversed=!1}),T.default.each(this.widgets,i=>{i.type==="video"&&i.player&&(this.timeline.reversed?i.player.pause():i.player.play())})))},onScroll:function(){this.useOnscrollBoundsFallback&&this.notifyWhenInOrOutOfView.__throttled()},onCycleEnd:function(){this.willStopOnEnd=!1,this.timeline.off("full-cycle-end",this.onCycleEnd),this.timeline.loop?this.timeline.isFullLoop?this.timeline.stop():this.timeline.reverse():this.timeline.reversed?this.timeline.reverse():this.timeline.play()},destroy:function(){let e=function(t){t.css("cursor","")};this.withTriggerOrElement(e),q.prototype.destroy.apply(this,arguments)}});ke.hover=q.extend({initialize:function(){q.prototype.initialize.apply(this,arguments);let e=function(t){g.isDesktop?(t.on("mouseenter",this.onPointerEnter),t.on("mouseleave",this.onPointerLeave)):(t.on("mouseenter",this.onPointerEnter),t.on("touchstart",this.onPointerEnter),t.on("mouseleave",this.onPointerLeave),t.on("touchend",this.onPointerLeave),t.on("touchcancel",this.onPointerLeave),this.$el.toggleClass("hold-event"))}.bind(this);T.default.each(this.widgets,T.default.bind(function(t){["text","shape","picture","button"].indexOf(t.type)!==-1&&(t.hasHoverAnimation=!0)},this)),this.withTriggerOrElement(e)},onPointerEnter:function(){this.timeline&&(this.timeline.active?!this.timeline.loop&&this.timeline.reversed?this.timeline.on("full-cycle-end",this.onCycleEnd):this.timeline.off("full-cycle-end",this.onCycleEnd):!this.timeline.reversed&&this.timeline.play())},onPointerLeave:function(){this.timeline&&(this.timeline.active?!this.timeline.loop&&this.timeline.reversed?this.timeline.off("full-cycle-end",this.onCycleEnd):this.timeline.on("full-cycle-end",this.onCycleEnd):!this.timeline.loop&&this.timeline.reversed&&this.timeline.reverse())},onCycleEnd:function(){this.timeline.off("full-cycle-end",this.onCycleEnd),this.timeline.loop?this.timeline.isFullLoop?this.timeline.stop():this.timeline.reverse():this.timeline.reversed?this.timeline.reverse():this.timeline.play()}});var Me=Ci;vt();vi();He();yt();wi();re();hi();xi();mi();lt();wt();var Vt={...Et,..._t},qe=Ze.default.View.extend({template:Vt["template-viewer-page"],widgetsFetched:!1,whenWidgetsFetched:void 0,widgetsData:[],widgetIds:[],widgetFetchController:void 0,initialize:function(e){return P.default.bindAll(this),this.mag=e.mag,this.router=e.router,this.$container=e.$container,this.viewerType=e.viewerType,this.totalPages=e.totalPages,this.isStickyVerticalViewer=e.isStickyVerticalViewer,e.pageData.wids.length&&typeof e.pageData.wids[0]=="string"?(this.widgetsData=e.pageData.widgetsData||[],this.widgetIds=e.pageData.wids):(this.widgetsData=e.pageData.wids,this.widgetIds=e.pageData.wids.map(t=>t._id),this.widgetsFetched=!0),this.viewOpts=e.viewOpts,P.default.defaults(e.pageData,{title:"",width:this.mag.getViewportWidth(e.mag.viewport),height:this.mag.getViewportSetting("min_height")}),P.default.extend(this,P.default.omit(e.pageData,["wids","widgets"])),this.contentPosition={left:0,top:0},this},render:function(){if(this.setElement(this.template({isStickyVerticalViewer:this.isStickyVerticalViewer,pageNum:this.num})),this.$el.appendTo(this.$container),!RM.screenshot&&!Modernizr.csspositionsticky&&(0,ce.default)(".polyfill-sticky").Stickyfill(),this.zIndex=this.totalPages-this.num+2,this.viewerType==="vertical"&&this.$el.css("z-index",this.zIndex),this.$content=this.$(".page-content-container"),this.$scrollWrapper=this.$(".content-scroll-wrapper"),this.$scrollWrapper.one("scroll",this.fixSafariScroll),this.$fixedBgContainer=this.$(".page-fixed-bg-container"),this.$fixedPositionContainer=this.$(".fixed-position-container"),this.$fixedPositionContainerTop=this.$(".fixed-position-container-top"),this.$contentBounds=this.$(".content-bounds"),this.pageViewport=this.getPageViewport(),this.viewerType==="horizontal"&&this.$scrollWrapper.bind("scroll",this.onScroll),this.createLQBackground(),RM.screenshot===this._id){let e=this.getPageViewport(),t=RM.screenshot&&y.queryUrlGetParam("pdf")==="true";this.$el.css({overflow:"hidden",height:this[`viewport_${e}`]?.height||Math.max(this.height,672),width:t?this.mag.getViewportWidth("default"):this[`viewport_${e}`]?.width||M.dictionary[e].width,position:"relative"}),y.queryUrlGetParam("pdf")==="true"&&(this.$fixedPositionContainer.css({height:"100%"}),this.$fixedPositionContainerTop.css({height:"100%"})),this.onResize(),this.on("pageLoaded",function(){this.mag.router.sendReadyEvent({page:this})},this)}return this},async show(){if(!this.shown){if(this.$el.removeClass("hidden"),this.shown=!0,this.isPasswordProtected()&&!this.passwordFormShown)return this.showPagePasswordForm(),this.passwordFormShown=!0,Promise.resolve();if(this.viewerType==="horizontal"&&this.onResize(),!this.widgets&&!this.widgetsFetched&&(!RM.screenshotMode||RM.screenshotMode==="published"))return this.whenWidgetsFetched=this.whenWidgetsFetched||new Promise(e=>{this.widgetFetchController=typeof AbortController<"u"?new AbortController:void 0,$t(this.mag.num_id,this._id,this.widgetFetchController?.signal).then(t=>{this.widgetsFetched=!0,this.widgetsData=[...this.widgetsData,...t.filter(i=>!i.is_global)],this.createWidgetsForCurrentViewport(),e()}).catch(t=>{if(t.name!=="AbortError")throw t})}),this.whenWidgetsFetched;if(!this.widgets||this.lastViewportUsedForWidgetsCreation!==this.pageViewport)return this.createWidgetsForCurrentViewport(),Promise.resolve()}return this.whenWidgetsFetched||Promise.resolve()},start:function(e){if(!(this.started&&!(e&&e.forceStart)))return this.started=!0,this.trigger("started"),e=e||{},P.default.each(this.widgets,function(t){(!e||!e.widgetTypes||P.default.indexOf(e.widgetTypes,t.type)>=0)&&t.start()}),this.focusPage(),this.$scrollWrapper.addClass("accelerated-scroll"),this.animations&&this.animations.start(),this.shadowInteractions?.start(),this.mag.aboveGlobalAnimations&&this.mag.aboveGlobalAnimations.start(),this.lightboxModel||this.createLightbox(),this},stop:function(e){if(this.started)return e=e||{},this.started=!1,this.trigger("stopped"),this.$scrollWrapper.removeClass("accelerated-scroll"),P.default.each(this.widgets,function(t){(!e||!e.widgetTypes||P.default.indexOf(e.widgetTypes,t.type)>=0)&&t.stop()}),this.animations&&this.animations.stop(),this.mag.aboveGlobalAnimations&&this.mag.aboveGlobalAnimations.stop(),this.shadowInteractions?.stop(),this},getUrl:function(){return window.location.protocol+"//"+window.location.hostname+"/p"+this.num_id+"/"},setPosition:function(e,t){this.lastPosition===e&&this.lastNeighbour===t||(this.$el.removeClass("center-page prev-page next-page neighbour").addClass(e+"-page "+(t?"neighbour":"")),this.lastPosition=e,this.lastNeighbour=t)},getScroll:function(){return this.visibleWidgetsCoords.scrollTop},scrollOnVerticalMode:function(e){this.hasScrollOnVerticalMode=!0;let t,i,o=this.pageHeight-this.pageBgHeight;e<0?(t=-e,i=0):o>=e?(t=0,i=-e):(t=o-e,i=-o),this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.scrollTop=-i,this.animations&&this.animations.onScroll({forceApply:!this.isStickyVerticalViewer}),this.trigger("page scroll",this.getScroll()),!this.isStickyVerticalViewer&&(this.$el.css("top",0),y.applyTransform(this.$el,t?"translateY("+t+"px) translateZ(0)":""),this.hasFixedWidgets?(this.$contentBounds.css({top:i}),y.applyTransform(this.$contentBounds,"")):(this.$contentBounds.css({top:""}),y.applyTransform(this.$contentBounds,i?"translateY("+i+"px)":"")))},resetScrollOnVerticalMode:function(){this.hasScrollOnVerticalMode&&(this.hasScrollOnVerticalMode=!1,this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.scrollTop=0,this.animations&&this.animations.onScroll({forceApply:!this.isStickyVerticalViewer}),!this.isStickyVerticalViewer&&(this.$el.css("top",""),y.applyTransform(this.$el,""),this.hasFixedWidgets?this.$contentBounds.css("top",0):y.applyTransform(this.$contentBounds,"")))},hide:function(){return this.shown&&(this.$el.addClass("hidden"),this.widgetFetchController?.abort(),this.whenWidgetsFetched=void 0,this.shown=!1),this},destroyAllWidgets:function(e){this.loaded=!1,this.videoBGStarted=!1,P.default.each(this.widgets,function(t,i){let o=this.widgetsData.some(function(r){let n=O.normalizeAnimations(r.animation),a=r._id===t._id&&!!n.find(p=>!O.isEmpty(p)),s=r._id===t._id&&(r.viewport_default&&r.viewport_default.hidden||r.viewport_tablet_portrait&&r.viewport_tablet_portrait.hidden||r.viewport_phone_portrait&&r.viewport_phone_portrait.hidden||r.hidden);return a||s});(!e||!e.includes(t.type)||o)&&(t.destroy(),t.off(),delete this.widgets[i])}.bind(this)),this.animations&&this.animations.destroy(),this.shadowInteractions?.destroy(),delete this.animations,clearTimeout(this.fireReadyTimeout)},destroy:function(){return this.retargetScroll&&this.retargetScroll.restore&&this.retargetScroll.restore(),this.resetWaitForAnimationEnd(),this.destroyLQBackground({animate:!1}),this.destroyAllWidgets(),this.remove()},isSwipeInProgress:function(){return this.$el.hasClass("swiping")},getPageZIndex:function(){return this.zIndex||1},getImmediatePack:function(){return P.default.filter(this.widgets,function(e){return e.canRenderImmediately()&&!e.rendered})},getWidgetsPacks:function(){if(!this.widgets)return[];let e=this.visibleWidgetsCoords,t=(e.top+(e.scrollTop||0))/e.scale,i=(e.bottom+(e.scrollTop||0))/e.scale,o=i-t,r=[],n,a,s=[];if(this.BGWidget&&!this.BGWidget.rendered&&!this.BGWidget.loaded&&s.push(this.BGWidget),this.fixedWidgets&&this.fixedWidgets.length){let _;for(n=0;n<this.fixedWidgets.length;n++)_=this.fixedWidgets[n],!_.rendered&&!_.loaded&&!_.canRenderImmediately()&&s.push(_)}let p=[],c=99999,u=-99999,v,S=!1,z;for(n=0;n<this.widgets.length;n++)a=this.widgets[n],!a.rendered&&!a.loaded&&a.type!="background"&&!a.fixed_position&&(z=qe.getScreenIndex(a,t,o,!0),v=z.index,c=Math.min(z.start,c),u=Math.max(z.end,u),a.screenIndex=v,v!==1/0&&(p[v]=p[v]||[],p[v].push(a)),S=!0);if(S){for(p[0]&&r.push(p[0]),p[1]&&r.push(p[1]),p[-1]&&r.push(p[-1]),n=2;n<=u;n++)p[n]&&r.push(p[n]);for(n=-2;n>=c;n--)p[n]&&r.push(p[n])}return s.length&&(r.length?r[0]=s.concat(r[0]):r=[s]),r},renderWidgetPack:function(e,t){let i=0,o=0,r=0,n=!1,a;for(a=0;a<e.length;a++){let p=e[a];if(!p.rendered&&!p.loaded&&!p.destroyed){p.canRenderImmediately()||(i++,p.on("loaded destroyed",s,p)),r++;try{p.render()}catch(c){console.error(`Failed to render widget ${p._id}`,c)}}}n=!0,r||t(),i==o&&t();function s(){o++,n&&i==o&&t()}},loadForScreenshotMode:function(){P.default.each(this.widgets,async e=>{try{(await e.render()).start()}catch{console.error(`Failed to render widget ${e._id} for a screenshot`)}})},createWidgetsForCurrentViewport:function(){this.destroyAllWidgets(["video"]),this.BGWidget=null,this.fixedWidgets=[];let e=this.pageViewport,t=[],i=[],o=99999,r=this,n=this;P.default.each(this.widgetsData,function(c){let u=n.getWidgetViewportData(c,e),v=!this.mag.isPreview&&O.hasExpired(u);!se[u.type]||u.hidden||v||(!u.fixed_position&&u.z&&u.type!=="background"&&(o=Math.min(o,u.z)),i.push(u))}.bind(this)),o==99999&&(o=0),P.default.each(i,function(c){let u=W.isOn(e,this.mag.getViewportWidth(e),this.mag.viewOpts)&&W.isCSSTransform(),v=this.mag.isPreview&&["phone_portrait","tablet_portrait"].includes(this.mag.viewport);c.fixed_position&&(c.z<o||g.isDesktop&&!this.mag.isStickyVerticalViewer&&!u&&!v)?c.$fixedContainer=n.$fixedPositionContainer:c.$fixedContainer=n.$fixedPositionContainerTop;let S=null;if(this.widgets&&this.widgets.length&&(S=this.widgets.find(function(X){return X?X._id===c._id:!1})),!se[c.type])return;let _=S||new se[c.type](c,r);_.type==="video"&&(_.updateWidgetData(c,r),_.applyBoxStyle(),_.updateVideoFrameSize(c.w,c.h)),_.type==="background"&&(n.BGWidget=_,n.hasVideoBG=_.hasVideoBG()),_.isValid()&&(_.fixed_position&&n.fixedWidgets.push(_),t.push(_))}.bind(this)),this.widgets=y.sortRects(t);let a=W.isOn(e,this.mag.getViewportWidth(e),this.mag.viewOpts)&&W.isCSSTransform();this.animations=new Me({page:this,widgets:this.widgets}),this.shadowInteractions=bt({page:this,widgets:[...this.widgets,...this.mag.aboveGlobalWidgets||[]],scale:a?1:this.mag.getScale(this.pageViewport)}),this.signalOnLoading(),this._onFontsLoad=[],this._widgetsWithFontsToLoad=[],this._fontLoaderCalled=0,this._widgetsWithFontsCount=0,this._widgetsWithLoadAnimation=0;for(let c of this.widgets)this._widgetsWithFontsCount+=c.hasFontsToLoad()?1:0,this._widgetsWithLoadAnimation+=c.hasLoadAnimation()?1:0;this.hasFixedWidgets=!!this.fixedWidgets.length;let s=g.isDesktop&&this.pageViewport!=="tablet_portrait",p=this.mag.isPreview&&["phone_portrait","tablet_portrait"].includes(this.mag.viewport);this.$el.removeClass("page-with-fixeds-desktop page-with-fixeds-sticky-or-mobile").toggleClass("page-with-fixeds-desktop",this.hasFixedWidgets&&s).toggleClass("page-with-fixeds-sticky-or-mobile",!!(this.hasFixedWidgets&&(this.isStickyVerticalViewer||!s||a||p))),this.hasFixedWidgets&&!this.retargetScroll&&this.viewerType==="horizontal"&&s&&(this.retargetScroll=xe&&xe(this.$fixedPositionContainerTop.get(0),this.$scrollWrapper.get(0)),xe&&xe(this.$fixedPositionContainer.get(0),this.$scrollWrapper.get(0))),this.lastViewportUsedForWidgetsCreation=e},getWidgetViewportData:function(e,t){let i=P.default.clone(e),o={},r=["text_w","text_h","em_w","anchor_link_pos","font-size","font-style","font-weight","font-family","color","color-opacity","letter-spacing","baselineShift","hover-color","hover-color-opacity","current-font-size","current-font-style","current-font-weight","current-font-family","current-baselineShift","current-color","current-color-opacity","current-letter-spacing","current-text_w","current-text_h","background-color","background-color-opacity","hover-background-color","hover-background-color-opacity","current-background-color","current-background-color-opacity","border-radius","border-width","border-color","border-color-opacity","hover-border-width","hover-border-color","hover-border-color-opacity","current-border-radius","current-border-width","current-border-color","current-border-color-opacity","icon_h","icon_w"];if(t!=="default"&&e["viewport_"+t]){let n=!y.canUseMinimalViewport(this.mag)&&y.isLegacyWidgetFormat(e);P.default.each(M.viewport_fields[e.type]||M.viewport_fields_common,a=>{if(!(e.type==="shape"&&(a==="borders"||a==="weight"||a==="bg_color"))&&!(e.type==="background"&&a==="picture")&&!(e.type==="text"&&e.version===3&&a==="blocks")){if(n&&(o[a]=void 0),E.isGlobalKey(a)){let s=E.getGlobalPrefixedKey(a);o[s]=void 0}n&&(o[a]=e.type==="button"&&!P.default.has(e["viewport_"+t],a)&&r.includes(a)?e[a]:void 0)}}),P.default.extend(i,o,P.default.omit(e["viewport_"+t],["_id","modelType"]))}return e.is_global&&E.fillUniqueValues(i,this._id),i},getWidgetById:function(e){return P.default.findWhere(this.widgets,{_id:e})},hasWidget(e){return this.widgetIds.includes(e)},signalOnLoading:function(){let t=this.widgets?.length||0,i=this,o={};P.default.each(this.widgets,function(s){RM.screenshot&&(o[s._id]=setTimeout(function(){s.widgetIsLoaded()},2e4)),s.on("loaded",r,s)},this),this.BGWidget&&this.hasVideoBG&&this.BGWidget.on("videoBGStarted",n,this.BGWidget),t==0&&(this.fireReadyTimeout=setTimeout(a,200));function r(){t--,clearTimeout(o[this._id]),this.type=="background"&&i.destroyLQBackground({animate:!0}),this.hasLoadAnimation()&&(i._widgetsWithLoadAnimation--,i._widgetsWithLoadAnimation||(i.loadAnimationsReady=!0,i.trigger("loadAnimationsReady"))),t||(i.fireReadyTimeout=setTimeout(a,200)),i.trigger("loaded"+this._id)}function n(){i.videoBGStarted=!0,P.default.delay(function(){i.trigger("videoBGStarted")},1300)}function a(){i.loaded=!0,i.trigger("pageLoaded")}},getFontsVariations:function(e,t){let i=Z.getUsedFontsFromWidgetsModels({includeCustom:!0,customList:P.default.filter(this.mag.edit_params.fonts,{provider:"custom"}),models:e,excludeUnusedDefault:t,activeViewports:[this.getPageViewport()]}),o=[];return P.default.each(i,function(r){for(let n=0;n<r.used_variations.length;n++)o.push({fontFamily:r.css_name,fontWeight:(r.used_variations[n].substr(1,1)-0)*100,fontStyle:r.used_variations[n].substr(0,1)=="n"?"normal":"italic"})}),o},addFontsToLoad:function(e,t){if(this._widgetsWithFontsToLoad.push(e),this._onFontsLoad.push(t),this._fontLoaderCalled++,this._fontLoaderCalled==this._widgetsWithFontsCount){let i=this.getFontsVariations(this._widgetsWithFontsToLoad);if(P.default.isEmpty(i)){this.onAllFontsLoad();return}this._fontsToLoadLeft=i.length,P.default.each(i,P.default.bind(function(o){Z.exactWaitForFontLoad(o.fontFamily,o.fontWeight,o.fontStyle,this.onOneFontLoad)},this))}},onOneFontLoad:function(){this._fontsToLoadLeft--,this._fontsToLoadLeft==0&&P.default.delay(this.onAllFontsLoad,500)},onAllFontsLoad:function(){P.default.each(this._onFontsLoad,function(e){e&&e()})},updateViewport:function(){let e=this.getPageViewport(),t=this.pageViewport;e!==t&&(this.pageViewport=e,this.createLQBackground(),this.shown&&(this.loadAnimationsReady=!1,this.createWidgetsForCurrentViewport(),this.started&&(this.started=!1,this.start())))},waitForAnimationEnd:function(e){this.resetWaitHook=y.waitForTransitionEnd(this.$el,this.mag.getPageTransitionTime()+1e3,"transform",e)},resetWaitForAnimationEnd:function(){this.resetWaitHook&&this.resetWaitHook()},backToTop:function(){this.scrollTo(0)},scrollTo:function(e,t=!0){this.$scrollWrapper.finish(),this.$scrollWrapper&&this.$scrollWrapper.animate({scrollTop:e},t?500:0)},focusPage:function(){g.isDesktop&&this.viewerType!=="vertical"&&(y.isIframe()||this.$el[0].getBoundingClientRect().left===0&&(this.$content.focus(),this.mag.$el.scrollTop(0)))},markAsLast:function(){this.lastPage=!0,this.$el.addClass("last")},isLastPage:function(){return!!this.lastPage},isBottomArrowVisible:function(){return!this.wasScrolled&&this.scrollable},isPasswordProtected:function(){return this.unauthorized},scrollPageALittle:function(){this.$scrollWrapper.animate({scrollTop:(0,ce.default)(window).height()/2},500)},getPageViewport:function(){let e=this.mag.viewport,t=this;if(e==="default")return"default";if(!this["viewport_"+e]||!this["viewport_"+e].enabled){let i=P.default.findWhere(M.viewports,{name:e}).width,o=P.default.reduce(M.viewports,function(r,n,a){return n.name!="default"&&(!t["viewport_"+n.name]||!t["viewport_"+n.name].enabled)?r:Math.abs(n.width-i)<=Math.abs(M.viewports[r].width-i)?a:r},0);return M.viewports[o].name}else return e},onResizeAfterWidgetDrag(){this.reasizeAfterDragSet=!1,this.onResize()},onResize:function(e){if(e=e||{},this.mag.isWidgetDragging){this.reasizeAfterDragSet||(this.reasizeAfterDragSet=!0,this.mag.once("widget:drag:stopped",this.onResize.bind(this)));return}if(this.mag.isEcwidOpened||!this.shown&&this.viewerType==="horizontal")return;let t=["phone_portrait","tablet_portrait"].includes(this.mag.viewport)&&this.pageViewport==="default"&&this.mag.isPreview,i=this.pageViewport==="phone_portrait"&&this.mag.viewOpts.phoneVerticalAlign==="top",o=this.mag.getContainerSizeCached(),r=this.mag.getViewportWidth(this.pageViewport),n=M.dictionary[this.pageViewport].width,a=this.mag.getScale(this.pageViewport),s=this["viewport_"+this.pageViewport]&&this["viewport_"+this.pageViewport].height||this.height,p={width:n,height:s,scaledWidth:Math.round(r*a),scaledHeight:Math.round(s*a),scale:a},c=RM.screenshot&&y.queryUrlGetParam("pdf")==="true",u=Math.min(p.scaledWidth,o.width),v=this.pageViewport==="default"?672:M.dictionary[this.pageViewport].min_height,S=p.scaledHeight,z=c||i?0:Math.max(((RM.screenshot?v:o.height)-S)/2,0),_=Math.max(((RM.screenshot?M.dictionary[this.pageViewport].width:o.width)-u)/2,0)+(r-n)/2,X={width:p.width,height:p.height,top:i?0:z/(W.isCSSZoom()&&W.isDesktopDefault(this.pageViewport)&&!t?a:1),left:_};if(W.isOn(this.pageViewport,r,this.mag.opts)&&W.isCSSZoom()&&!t&&(X.zoom=a,X.left=o.width>this.mag.opts.scalewidth?(o.width/a-n)/2:(r-n)/2),this.$content.removeAttr("style"),this.$content.css(X),this.cachedSizes=void 0,this.contentPosition={left:_,top:z},!t&&W.normalize(a,"transform",this.pageViewport,r,this.mag.viewOpts)===1?y.applyTransform(this.$content,""):(y.applyTransform(this.$content,"scale("+p.scale+")"),RM.screenshot&&W.isCSSTransform()&&this.$content.css({"transform-origin":"left top"}),W.isDesktopDefault(this.pageViewport)&&!t?this.$content.css({left:Math.max((o.width-u)/2,0)+(r-n)/2*p.scale}):this.$content.css({left:(r-n)/2*p.scale})),this.contentHeight=s,this.pageHeight=this.isPasswordProtected()?o.height:Math.max(o.height,Math.round(s*a)),this.pageBgHeight=o.height,this.pageWidth=r,this.viewerType==="vertical"&&this.isStickyVerticalViewer&&this.$el.css({height:this.pageHeight,top:e.absolutePosition}),this.scale=a,this.$contentBounds.css({width:o.width,height:this.pageHeight}),this.getSizes(),this.prevScale!==void 0&&this.prevScale!==this.scale&&this.animations){let ue=this.animations.animations?.filter(F=>qe.findPlayingVideo(F.widgets));this.animations.updateTimelines(ue.map(F=>F.animation.UUID)),this.animations.resetStarted(),this.animations.start.__debounced()}return this.animations&&this.animations.onResize(),this.trigger("resize",{containerSize:o,contentPosition:this.contentPosition}),this.scrollable=Math.round(s*a)-this.mag.SCROLLABLE_TRESHOLD>o.height,this.mag.recalcBottomArrowState(this),this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.top=-z,this.visibleWidgetsCoords.bottom=-z+o.height,this.visibleWidgetsCoords.scale=a,this.resizeLQBackground(),this.prevScale=this.scale,this.pageHeight},onScroll:function(){this.wasScrolled=!0,this.mag.recalcBottomArrowState(this),this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.scrollTop=this.$scrollWrapper.scrollTop(),this.mag.onCurrentPageScroll(this,this.visibleWidgetsCoords.scrollTop),this.animations&&this.animations.onScroll(),this.trigger("page scroll",this.visibleWidgetsCoords.scrollTop)},isCurrent:function(){return this.num===this.mag.currentPage.num},showPagePasswordForm:async function(){let{getForbiddenForPage:e}=await import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-2VNDKF52.js");e(document.getElementById(`page-${this.num}-password-container`))},createLQBackground:function(){if(RM.screenshot||this.isPasswordProtected())return;let e=this.widgetsData.find(i=>i.type==="background");if(!e)return;let t=this.getWidgetViewportData(e,this.pageViewport);if(this.LQBG)if(t.selectedType==="picture"&&this.LQBG.selectedType==="picture"&&t.picture&&this.LQBG.picture&&t.picture.poorUrl===this.LQBG.picture.poorUrl||t.selectedType==="video"&&this.LQBG.selectedType==="video"&&t.video&&this.LQBG.video&&t.video.thumbnail_url===this.LQBG.video.thumbnail_url){this.resizeLQBackground();return}else this.destroyLQBackground({animate:!1});if(this.$fixedBgContainer.css("background-color","#"+t.color),t.picture&&t.selectedType==="picture"&&(t.picture.poorUrl||$e.useLambdaUrl(t.picture))||t.video&&t.selectedType==="video"&&t.video.thumbnail_url){this.LQBG=P.default.extend({},t);let i=Vt["template-viewer-widget-background"];if(this.LQBG.$el=(0,ce.default)(i({data:t})),this.LQBG.$el.addClass("low-quality").appendTo(this.$fixedBgContainer),this.LQBG.selectedType==="picture"){let o=this.LQBG.picture.poorUrl;$e.useLqipUrl(t.picture)&&(o=$e.getLqipUrl(this.LQBG.picture),this.LQBG.$el.addClass("lqip").appendTo(this.$fixedBgContainer)),(0,ce.default)("<img/>").on("load",P.default.bind(function(){this.LQBG&&this.LQBG.$el.find(".picture-background").css({"background-image":`url(${o})`})},this)).attr("src",o)}if(this.LQBG.selectedType==="video"){let o=this.LQBG.video.thumbnail_url.replace("http://","https://"),r=(0,ce.default)("<img/>").addClass("poster").css("opacity",0).appendTo(this.LQBG.$el.find(".video-background .video-container"));r.on("load",P.default.bind(function(){r.css({width:"",height:""}).css("opacity",1);let n=r[0].width,a=r[0].height;this.LQBG&&!this.LQBG.video.aspect_poster&&(this.LQBG.video.aspect_poster=n/a),this.resizeLQBackground()},this)).attr("src",o)}}},resizeLQBackground:function(){RM.screenshot||this.isPasswordProtected()||!this.LQBG||this.LQBG.selectedType==="video"&&zt.setVideoPosition({mag:this.mag,$container:this.LQBG.$el.find(".video-background .video-container"),$media:this.LQBG.$el.find(".video-background .video-container .poster"),provider:this.LQBG.video.provider_name,aspect_poster:this.LQBG.video.aspect_poster,aspect_real:this.LQBG.video.aspect_real,controls_remove:!0})},destroyLQBackground:function(e={}){if(RM.screenshot||this.isPasswordProtected()||!this.LQBG)return;e.animate=e.animate&&this.LQBG.selectedType==="picture"&&this.started;let t=this.LQBG.$el;this.LQBG=null,e.animate?(t.css("opacity",0),setTimeout(function(){t.remove()},400)):t.remove()},fixSafariScroll:function(){if(!Modernizr.safari||!g.isDesktop)return;this.$scrollWrapper.scrollTop()!==0&&this.$scrollWrapper.scrollTop(0)},getSizes:function(){return{scrollWrapperWidth:this.$scrollWrapper.width(),scrollWrapperClientWidth:this.$scrollWrapper[0].clientWidth,contentContainerWidth:this.$content.width(),contentContainerHeight:this.$content.height()}},getCachedSizes:function(){return this.cachedSizes||(this.cachedSizes=this.getSizes()),this.cachedSizes},getLightboxWidgets(){return this.lightboxWidgets=St(this.widgets),this.lightboxWidgets},async createLightbox(){if(this.widgetsData?.some(t=>t.type==="picture"&&!!t.lightbox)){let{default:t}=await import("https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-4K7A4E47.js");this.lightboxModel=new Ze.default.Model({isVisible:!1,slides:this.getLightboxWidgets(),index:0,originRect:{},onClose:()=>{this.lightboxModel.set({isVisible:!1}),this.mag.navigation?.show(!0),this.mag.navigation?.enable()},onSlideChange:o=>this.lightboxModel.set({index:o})}),(0,ce.default)("<div/>").addClass("lightbox-wrapper").appendTo(this.$el),ft({component:()=>Qe.default.createPortal(ut(t,{}),document.body),domElement:this.$el.find(".lightbox-wrapper").get(0),model:this.lightboxModel,onDestroy:()=>{let o=this.$el.find(".lightbox-wrapper").get(0);Qe.default.unmountComponentAtNode(o),o&&o.parentNode&&o.parentNode.removeChild(o)}})}},showLightboxSlide(e){this.mag.navigation?.hide(!0),this.mag.navigation?.disable();let t=this.lightboxWidgets.findIndex(i=>i._id===e._id);t>-1&&this.lightboxModel.set({isVisible:!0,index:t,slides:this.getLightboxWidgets(),originRect:Ct({widgetElement:e.$el.get(0),viewportWidth:this.mag.getViewportWidth(this.pageViewport),viewport:this.pageViewport,viewerOptions:this.mag.viewOpts})})}},{getScreenIndex:function(e,t,i,o){let r,n=Math.floor((e.y-t)/i),a=Math.ceil((e.y+e.h-t)/i)-1;return o&&e.canRenderImmediately()?r=1/0:e.hasLoadAnimation()||n<=0&&a>=0?r=0:n>0?r=n:a<0&&(r=a),{start:n,end:a!==1/0?a:0,index:r}},findPlayingVideo(e=[]){return e.find(t=>t.type==="video"&&t.isPlaying)}}),Pe=qe;var h=A(ge()),et=A(ne()),m=A(oe());le();var Lt={"template-viewer-mag":B`
  <main class="mag">
    <div class="mag-pages-container">
      <div class="container disable-transitions">
        <div class="blackout"></div>
      </div>
      <div class="above-pages-container"></div>
    </div>

    <% if (hasStandaloneBottomArrow) {%>
      <div class="navigation-arrow bottom offscreen">
        <div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>
      </div>
    <% } %>

    <% if (isPreview) {%>
      <div class="mag-pages-viewport-device"></div>
    <% } %>
  </main>
`};ci();_e();De();vt();gi();li();kt();yt();Ye();Te();He();re();dt();yi();ui();var de=A(ge()),Bt=A(ne()),D=A(oe());_e();le();var Rt={"template-viewer-navigation":B`
	<div class="navigation">
		<div class="navigation-arrow left offscreen" role="button" aria-label="Previous page">
			<div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>
		</div>
		<div class="navigation-arrow right offscreen" role="button" aria-label="Next page">
			<div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>
		</div>
		<div class="navigation-arrow bottom offscreen" role="button" aria-label="Scroll down">
			<div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>
		</div>
	</div>
`};re();ve();Te();var Ti=Bt.default.View.extend({ARROWS_SHOW_DELAY:1e3,BOTTOM_SHOW_DELAY:1e3,BOTTOM_HIDE_DELAY:0,template:Rt["template-viewer-navigation"],events:{"click .navigation-arrow.left":"goPrevPage","click .navigation-arrow.right":"goNextPage","click .navigation-arrow.bottom":"scrollCurrentPage"},initialize:function(e){return D.default.bindAll(this),D.default.extend(this,e),this.updateScaleState.__debounced=D.default.debounce(this.updateScaleState,100),this.canSwitchPages=!0,this},render:function(){return this.setElement(this.template({icons:{sprite:G(`./common/navigation/sprite${Q?"@2x":""}.png`)}})),this.$el.appendTo(this.$container),this.$prev=this.$(".navigation-arrow.left"),this.$next=this.$(".navigation-arrow.right"),this.$bottom=this.$(".navigation-arrow.bottom"),D.default.delay(D.default.bind(function(){this.$prev.removeClass("offscreen"),this.$next.removeClass("offscreen")},this),this.ARROWS_SHOW_DELAY),this.setArrowsPosition(this.mag.currentPage),this.listenTo(this.mag,"pageChanged",this.setArrowsPosition),this.listenTo(this.mag,"keypress-"+de.default.keycodes.left,this.goPrevPage),this.listenTo(this.mag,"keypress-"+de.default.keycodes.right,this.goNextPage),g.isDesktop&&(0,de.default)(window).bind("mousewheel",this.onMouseWheel),g.isDesktop||((0,de.default)(window).bind("gesturechange",this.updateScaleState.__debounced),this.updateScaleState(),this.mag.getPagesCount()>1&&this.setSwipeAction()),this},destroy:function(){return g.isDesktop&&(0,de.default)(window).unbind("mousewheel",this.onMouseWheel),g.isDesktop||((0,de.default)(window).unbind("gesturechange",this.updateScaleState.__debounced),this.pagesSwipe&&this.pagesSwipe.destroy()),this.remove()},onMouseWheel:function(e,t,i,o){this.preventTrackpadSwipeTill&&+new Date<this.preventTrackpadSwipeTill||Math.abs(i)>40&&Math.abs(i)>Math.abs(o)&&(i>0&&this.goPrevPage(),i<0&&this.goNextPage(),this.preventTrackpadSwipeTill=+new Date+1e3)},setSwipeAction:function(){this.pagesSwipe=this.mag.$mag_container.RMSwipe({$scrollElements:this.mag.$mag_container,getMaxTransitionSpeed:D.default.bind(function(){return this.mag.getPageTransitionTime()},this),customMoveCheck:D.default.bind(function(e,t){return!(e.hasClass("prev-page")&&t<0||e.hasClass("next-page")&&t>0)},this),beforeAutoAnimation:D.default.bind(function(e){return this.mag.showPageCounter(e),{autoAnimate:!0,immediateCallback:!1}},this),onSwipeStart:D.default.bind(function(){this.mag.showPageCounter()},this),getCurrentConstraints:D.default.bind(function(e){let t={},i=this.mag.$mag_container.width(),o=e.closest(".page, .final-page");return o.length||(o=this.mag.currentPage.$el),t.$moveItems=o.add(o.prev()).add(o.next()),t.$referenceItem=t.$moveItems.filter(":not(.center-page)").first(),this.mag.isWidgetDragging?(t.left={max:0,noTrigger:!0},t.right={max:0,noTrigger:!0},t):(this.mag.isLastPage()?t.left={max:0,noTrigger:!0}:t.left={max:i},this.mag.isFirstPage()?t.right={max:0,noTrigger:!0}:t.right={max:i},t)},this),callback:D.default.bind(function(e){e==="right"&&this.mag.goPrevPage({animation:!1,bySwipe:!0}),e==="left"&&this.mag.goNextPage({animation:!1,bySwipe:!0})},this)}).data("swipe")},setArrowsPosition:function(e){this.$next.toggleClass("hidden",!!this.mag.isLastPage()),this.recalcBottomArrowState(e),this.$prev.toggleClass("hidden",this.mag.isFirstPage()),this.mag.updateArrowsColor(e)},recalcBottomArrowState:function(e){clearTimeout(this.bottomArrowTimeout);let t=e?.isBottomArrowVisible();this.viewerType==="horizontal"&&W.isScaleLayout(this.mag.viewOpts)&&(t=!1),this.isPreview&&this.mag.viewport!=="default"&&(t=!1),this.bottomArrowTimeout=setTimeout(D.default.bind(function(){this.$bottom.toggleClass("offscreen",!t)},this),t?this.BOTTOM_SHOW_DELAY:this.BOTTOM_HIDE_DELAY)},goPrevPage:function(){this.canSwitchPages&&this.mag.goPrevPage({animation:!0})},goNextPage:function(){this.canSwitchPages&&this.mag.goNextPage({animation:!0})},scrollCurrentPage:function(){this.canSwitchPages&&this.mag.scrollCurrentPageALittle()},updateScaleState:function(){Modernizr.android||this.$prev.add(this.$next).add(this.$bottom).toggleClass("scaled-offscreen",y.isPageNativelyScaled())},hide:function(e=!1){for(let t of[this.$prev,this.$next,this.$bottom])e?t.fadeOut(200):t.hide()},show:function(e=!1){for(let t of[this.$prev,this.$next,this.$bottom])e?t.fadeIn(200):t.show()},disable:function(){this.canSwitchPages=!1},enable:function(){this.canSwitchPages=!0}}),Ke=Ti;var Je=A(ge()),jt=A(ne()),Oe=A(oe());le();var Dt={"template-viewer-toolbar":B`

	<div class="toolbar for-viewer <%= viewport %>">

		<%	var offscreenClass = (isPreview || common.embedMode) ? '' : 'offscreen-initially'; %>

		<% if (hasPageCounter && !pageCounterInsideMenu) { %>
			<div class="page-counter-wrapper <%=offscreenClass%>">
				<div class="page-counter"><span class="cur"></span> of <span class="total"><%=totalPages%></span></div>
			</div>
		<% } %>

		<% if (brandingInToolbar) { %>
			<div class="toolbar-branding"></div>
		<% } %>

		<% if (hasShare) { %>
			<div class="share-button sprite <%=offscreenClass%>" role="button" aria-label="Share" data-alt="Share" data-alt-pos="<%= !controlsOnTop ? 'top' : 'bottom' %>" data-alt-offset="9"  data-alt-style="toolbar-share-tooltip" style="background-image: url('<%=icons.sprite%>')"></div>
		<% } %>

		<% if (hasMenu) { %>
			<div class="menu-button <%=offscreenClass%>" role="button" aria-label="Menu" data-alt="Menu (M)" data-alt-pos="<%= !controlsOnTop ? 'top' : 'bottom' %>" data-alt-offset="9" data-alt-style="toolbar-menu-tooltip">
				<% if (hasPageCounter && pageCounterInsideMenu) { %>
					<div class="page-counter"><span class="cur"></span> of <span class="total"><%=totalPages%></span></div>
				<% } %>

				<svg class="menu-icon" width="32" height="14" viewBox="0 0 32 14">
					<g fill="currentColor" fill-rule="evenodd"><path d="M1 0h30a1 1 0 010 2H1a1 1 0 110-2zM1 12h30a1 1 0 010 2H1a1 1 0 010-2z"/></g>
				</svg>
				<svg class="cross-icon" width="18" height="18" viewBox="0 0 18 18">
					<path d="M17.485.515a1 1 0 010 1.414L10.415 9l7.07 7.071a1 1 0 01-1.414 1.414L9 10.415l-7.071 7.07a1 1 0 01-1.414-1.414L7.585 9 .516 1.929A1 1 0 011.929.515L9 7.585l7.071-7.07a1 1 0 011.414 0z" fill="currentColor" fill-rule="evenodd"></path>
				</svg>
				<div class="page-preloader sprite" style="background-image: url('<%=icons.sprite%>')"></div>
			</div>
		<% } %>

		<% if (common.embedMode) { %>
			<div class="embed-close-button <%=offscreenClass%>" role="button">Close</div>
		<% } %>

	</div>

`};var K=A(ge()),Nt=A(ne()),ie=A(oe());le();var Ft={"template-viewer-share":B`
	<% if (hasOverlay) {%>
		<div class="share-popup-overlay hidden" data-nosnippet></div>
	<%}%>

	<div class="share-popup hidden" data-nosnippet>
		<noindex>
			<div class="content-wrapper">

				<div class="share-wrapper">
					<div class="caption">Share</div>

					<div class="type-selector">
						<!--__magterm-->
						<div class="type-full">Project</div>
						<div class="type-page">Current Page</div>
						<div class="arrow sprite" style="background-image: url('<%=icons.sprite%>')"></div>
					</div>

					<div class="buttons-wrapper">
						<div class="share-facebook button" data-tp="facebook"><div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>Share</div>
						<div class="share-twitter button" data-tp="twitter"><div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>Tweet</div>
						<div class="share-pinterest button" data-tp="pinterest"><div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>Pin</div>
						<div class="share-linkedin button" data-tp="linkedin"><div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>Linkedin</div>
					</div>

					<% if (!common.isDownloadedSource) { %>
						<div class="open-embed"><div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>Embed</div>
						<div class="close">Close</div>
						<div class="send-report" data-tp="report"><div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>Report</div>
					<% } %>
				</div>

				<% if (!common.isDownloadedSource) { %>
					<div class="embed-wrapper">
						<div class="caption">Embed</div>

						<div class="size-selector" data-selected="responsive">
							<div class="size responsive" data-size="responsive">Responsive</div>
							<div class="size big" data-size="big">512383</div>
							<div class="size small" data-size="small">288236</div>
							<div class="arrow sprite" style="background-image: url('<%=icons.sprite%>')"></div>
						</div>

						<div class="code-block">
							<div class="thumb">
								<img class="thumb-pic" src="" alt=""/>
								<div class="thumb-toolbar">
									<div class="icon arrows" style="background-image: url('<%=icons.thumbArrows%>')"></div>
									<div class="icon open" style="background-image: url('<%=icons.thumbOpen%>')"></div>
								</div>
							</div>

							<textarea class="embed-code"></textarea>
						</div>

						<div class="back">Back</div>
					</div>
				<% } %>
			</div>

			<div class="corner-wrapper">
				<div class="corner"></div>
			</div>
		</noindex>
	</div>
`};kt();De();re();ve();var Ht=Nt.default.View.extend({template:Ft["template-viewer-share"],events:{"click .buttons-wrapper .button":"share","click .send-report":"share","click .open-embed":"openEmbed","click .close":"hide","click .embed-wrapper .back":"closeEmbed","click .embed-wrapper .embed-code":"selectEmbedCode","keyup .embed-wrapper .embed-code":"onKeyUp","click .type-selector":"onTypeSelectorClick","click .size-selector":"onSizeSelectorClick",click:"onClick"},initialize:function(e){return ie.default.bindAll(this),ie.default.extend(this,e),this},render:function(){return this.setElement(this.template({hasOverlay:g.isPhone,common:RM.common,icons:{sprite:G(`./viewer/share/sprite${Q?"@2x":""}.png`),thumbArrows:G(`./viewer/share/thumb-arrows${Q?"@2x":""}.png`),thumbOpen:G(`./viewer/share/thumb-open${Q?"@2x":""}.png`)}})),this.$el.appendTo(this.$container),this.selectFullMode(),g.isPhone&&(this.shareSwipe=this.$el.RMSwipe({minTransitionSpeed:200,maxTransitionSpeed:400,rubberBand:!1,beforeAutoAnimation:ie.default.bind(function(){return{autoAnimate:!0,immediateCallback:!0}},this),getCurrentConstraints:ie.default.bind(function(){let e={},t=this.$el.filter(".share-popup");return e.$referenceItem=t,e.$moveItems=t,e.up={max:0,noTrigger:!0},e.down={max:t.height()},e},this),callback:ie.default.bind(function(){this.hide()},this)}).data("swipe")),this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"keypress-"+K.default.keycodes.esc,this.hide),(0,K.default)("body").on("click",this.hideOnBodyClick),this},show:function(){return this.shown||(clearTimeout(this.hideTimeout),this.$el.removeClass("hidden"),this.$el.height(),this.$el.addClass("show-popup"),this.$container.addClass("no-hover"),this.shown=!0,this.updateEmbed()),this},toggle:function(){return this.shown?this.hide():this.show()},hide:function(){return this.shown&&(this.$el.removeClass("show-popup"),this.$container.removeClass("no-hover"),this.hideTimeout=setTimeout(ie.default.bind(function(){this.closeEmbed(),this.$el.addClass("hidden")},this),400),this.shown=!1),this},destroy:function(){return clearTimeout(this.hideTimeout),(0,K.default)("body").off("click",this.hideOnBodyClick),this.shareSwipe&&this.shareSwipe.destroy(),this.remove()},hideOnBodyClick:function(e){g.isPhone||(0,K.default)(e.target).closest(this.$container).length||this.hide()},onPageChange:function(){this.hide()},onClick:function(e){g.isPhone&&(0,K.default)(e.currentTarget).hasClass("share-popup-overlay")&&this.hide()},onKeyUp:function(e){e.stopPropagation()},openEmbed:function(){this.selectEmbedCode(),this.$el.addClass("show-embed")},updateEmbed:function(){let e=this.mag.currentPage||this.mag.pages[0],t=this.$(".size-selector").attr("data-selected"),i={responsive:"responsive",big:512,small:288};if(e&&e.unauthorized)return;this.$(".embed-wrapper .embed-code").val(Ht.getEmbedCode({shareMode:this.shareMode,cur_page_num_id:e.num_id,mag_num_id:this.mag.num_id,size:i[t]}));let{src:o}=this.mag.model.getPageScreenshot({_id:this.shareMode==="page"?e._id:this.mag.coverPid});this.currentEmbedSrc!==o&&(this.$(".thumb-pic").attr("src",o),this.currentEmbedSrc=o)},closeEmbed:function(){this.$el.removeClass("show-embed")},share:function(e){Ae.share({host:(RM.common.embedDomainName||window.location.protocol+"//"+window.location.hostname)+"/",tp:(0,K.default)(e.currentTarget).attr("data-tp"),source:"share panel",page:this.mag.currentPage||this.mag.pages[0],mag:ie.default.extend(this.mag.model.toJSON(),{user:this.mag.user}),forProject:this.shareMode==="full",customDomain:!!(RM.common.isDomainViewer||RM.common.embedDomainName),customDomainProfile:!!(RM.common.customDomainProfile||RM.common.embedDomainType==="User"),analytics:this.router.analytics,exportBasePath:window.RM.common.isDownloadedSource?window.RM.config&&window.RM.config.root:void 0,supportMail:H.SUPPORT_MAIL})},onTypeSelectorClick:function(e){if(g.isPhone){let t=(0,K.default)(e.target);t.closest(".type-full").length&&this.selectFullMode(),t.closest(".type-page").length&&this.selectPageMode()}else(this.$(".type-selector").attr("data-tp")||"page")==="page"?this.selectFullMode():this.selectPageMode()},onSizeSelectorClick:function(e){let t=(0,K.default)(e.currentTarget),i=t.attr("data-selected"),o,r;o=ie.default.map(t.find(".size"),function(n){return(0,K.default)(n).attr("data-size")}),r=o.indexOf(i)+1,r=r>=o.length?0:r,t.attr("data-selected",o[r]),this.updateEmbed()},selectPageMode:function(){this.$(".type-selector").attr("data-tp","page"),this.shareMode="page",this.updateEmbed()},selectFullMode:function(){this.$(".type-selector").attr("data-tp","full"),this.shareMode="full",this.updateEmbed()},selectEmbedCode:function(){g.isDesktop&&this.$(".embed-wrapper .embed-code").get(0).setSelectionRange(0,9999)}},{getEmbedCode:function(e){let t,i,o,r,n=H.EMBED_SCRIPT_INIT,a='<script async src="'+n+'" id="readymag-embed-init"><\/script>',s,p;return p=e.hostname||window.location.hostname,t=RM.common.embedDomainName||window.location.protocol+"//"+p,i=e.shareMode==="full"?e.mag_num_id:"p"+e.cur_page_num_id,s=' data-uri="'+i+'" ',s+=' data-width="'+e.size+'" ',(RM.common.isDomainViewer||RM.common.embedDomainName)&&(s+=' data-domain="'+t+'" ',!RM.common.customDomainProfile&&RM.common.embedDomainType!=="User"&&(i=e.shareMode==="full"?"":"p"+e.cur_page_num_id)),H.isProd||(s+=' data-origin="'+H.readymag_embed_host+'" '),o=t+"/"+i,r='<a class="rm-mag-embed" href="'+o+'"'+s+' target="_blank">'+o+`</a>
`,r+a}}),Gt=Ht;var I=A(ge()),Ut=A(ne()),J=A(oe());le();var Yt={"template-viewer-mag-menu":B`
	<noindex>
		<div class="mag-menu <%=(!hasProjectInfo ? 'no-project-info' : '')%> <%= viewport %>" data-nosnippet>
			<div class="menu-wrapper">
				<div class="scroll-wrapper">
					<div class="pages-wrapper has-<%=viewerType%>-scroll">
						<div class="pages">

							<%_.each(pages, function(page, index) {
								var direction = viewerType == 'horizontal' ? 'left' : 'top';
								var offset = index * (viewerType == 'horizontal' ? frameWidth : frameHeight);
								var screenshot = getScreenshot(page._id);
							%>
								<div class="page" data-id="<%=page._id%>" data-num="<%=page.num%>" data-src="<%= screenshot.src %>" style="width:<%=frameWidth%>px;height:<%=frameHeight%>px;<%=direction%>:<%=offset%>px" role="button" aria-label="Page <%=page.num%>">
									<img class="screenshot" src="<%=stub%>" style="width:<%= screenshot.width %>px; height:<%= screenshot.height %>px; margin: auto; top: 0; bottom: 0; left: 0; right: 0;" />
									<% if (page.unauthorized) { %>
									<div class="private-page"></div>
									<% } %>
									<div class="num <%=(page.pageNestedNum && page.pageNestedNum.length > 3 ? page.pageNestedNum.length > 4 ? 'nested-over-4' : 'nested-over-3' : page.num > 99 ? 'over99' : '')%>"><%=page.pageNestedNum ? page.pageNestedNum : page.num%></div>
								</div>
							<%});%>

						</div>
					</div>
					<div class="scroll"></div>
				</div>
			</div>
		</div>
	</noindex>
`};re();ve();Fe();He();var _i=Ut.default.View.extend({template:Yt["template-viewer-mag-menu"],events:{"click .page":"onPageClick"},initialize:function(e){J.default.bindAll(this),J.default.extend(this,e),this.IMG_STUB=G("./spacer.gif");let t=this.mag.viewport,i=this.viewerType==="vertical",o=t==="phone_portrait"||t==="tablet_portrait",r=o&&i?{width:120}:!o&&i?{width:240}:g.isPhone&&!i?{height:213}:{height:184};return{width:this.PAGE_WIDTH,height:this.PAGE_HEIGHT}=mt(t,r),this.loadVisibleScreenshots.__debounced=J.default.debounce(this.loadVisibleScreenshots,500),this.unloadInvisibleScreenshots.__debounced=J.default.debounce(this.unloadInvisibleScreenshots,3e3),this},render:function(){let e=this.mag.viewport;this.setElement(this.template({mag:this.mag,pages:this.pages,frameWidth:this.PAGE_WIDTH,frameHeight:this.PAGE_HEIGHT,stub:this.IMG_STUB,viewerType:this.viewerType,publishDate:this.publishDate,hasProjectInfo:this.hasProjectInfo,common:RM.common,viewport:e,getScreenshot:i=>this.mag.model.getPageScreenshot({_id:i},{width:this.PAGE_WIDTH,height:this.PAGE_HEIGHT},e)})),this.$el.appendTo(this.$container),this.mag.currentPage&&this.setActivePage(this.mag.currentPage.num),this.$pagesWrapper=this.$(".pages-wrapper");let t=this.$(".page");if(this.viewerType=="horizontal"?(this.$(".pages").css("width",t.length*this.PAGE_WIDTH),this.$pagesWrapper.scrollLeft(99999)):(this.$(".pages").css("height",t.length*this.PAGE_HEIGHT),this.$pagesWrapper.scrollTop(99999)),g.isDesktop&&(this.scroll=this.$(".scroll-wrapper").RMScroll({$container:this.$pagesWrapper,$content:this.$(".pages"),$handle:this.$(".scroll"),wheelScrollSpeed:1.3,gap_start:8,gap_end:8,maxHandleSize:136,dragScroll:!0,tp:this.viewerType}).data("scroll")),this.$pagesWrapper.bind("scroll",this.onScroll),this.cacheSize(),this.cacheScroll(),this.cachePagesPos(),this.loadedScreenshots={},this.showInitially&&(this.loadVisibleScreenshots(),this.show(!0)),this.viewerType=="horizontal"&&g.isPhone||(0,I.default)(".menu-info .mag-title").dotdotdot({height:g.isPhone?48:68,wrap:"letter",callback:J.default.bind(function(i){i&&this.$(".menu-info .mag-title").attr("title",this.mag.title)},this)}),!g.isDesktop){let i=this.viewerType=="horizontal"?this.$el.height():this.$el.width(),o=this.$el.add(this.$toolbar);this.viewerType=="horizontal"&&this.mag.navigation&&(o=o.add(this.mag.navigation.$bottom)),this.menuSwipe=o.RMSwipe({$scrollElements:this.$pagesWrapper,minTransitionSpeed:200,maxTransitionSpeed:400,rubberBand:!1,getCurrentConstraints:J.default.bind(function(){let r={};return r.$referenceItem=this.$el,this.viewerType=="horizontal"?this.shown?r={up:{max:0,noTrigger:!0},down:{max:i}}:r={up:{max:i},down:{max:0,noTrigger:!0}}:this.shown?r={left:{max:0,noTrigger:!0},right:{max:i}}:r={left:{max:i},right:{max:0,noTrigger:!0}},r},this),callback:J.default.bind(function(){this.shown?this.hide():this.show()},this)}).data("swipe")}return this.isPreview&&this.listenTo(RM.constructorRouter,"renewScreenshot",this.onConstructorScreenshotRenew),this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"keypress-"+I.default.keycodes.m,this.toggle),this.listenTo(this.mag,"keypress-"+I.default.keycodes.esc,this.hide),(0,I.default)(window).on("resize",this.onResize),this.$el.bind("mousewheel",this.onMouseWheel),this},show:function(e=!1){return this.shown||(this.shown=!0,e&&this.$el.css({transition:"none"}),this.mag.$el.addClass("viewer-mag-menu-shown"),(0,I.default)("html").addClass("mag-menu-shown"),this.mag.$el.toggleClass("viewer-mag-menu-no-project-info",!this.hasProjectInfo),this.loadOtherScreenshots(),this.mag.trigger("menuShown"),U.trigger("magMenu:open"),e&&setTimeout(()=>this.$el.css({transition:""}))),this},toggle:function(){return this.shown?this.hide():this.show()},hide:function(){return this.shown&&(this.mag.$el.removeClass("viewer-mag-menu-shown viewer-mag-menu-no-project-info"),(0,I.default)("html").removeClass("mag-menu-shown"),this.clearLoadOtherTimeout(),this.mag.focusCurrentPage(),this.shown=!1,this.mag.trigger("menuHidden"),U.trigger("magMenu:close")),this},destroy:function(){return(0,I.default)(window).off("resize",this.onResize),(0,I.default)("html").removeClass("mag-menu-shown"),this.$el.unbind("mousewheel",this.onMouseWheel),this.menuSwipe&&this.menuSwipe.destroy(),this.$pagesWrapper.unbind("scroll",this.onScroll),this.hide(),this.remove()},onMouseWheel:function(e){e.preventDefault()},onResize:function(){this.cacheSize(),this.scroll&&this.scroll.recalc(),this.mag.currentPage&&this.shiftToPage(this.mag.currentPage.num,!1)},onScroll:function(){this.cacheScroll()},cacheSize:function(){this.cachedData=this.cachedData||{},this.cachedData.scrollSize=this.viewerType=="horizontal"?this.$pagesWrapper.width():this.$pagesWrapper.height()},cacheScroll:function(){this.cachedData=this.cachedData||{},this.cachedData.scrollPos=this.viewerType=="horizontal"?this.$pagesWrapper.scrollLeft():this.$pagesWrapper.scrollTop()},cachePagesPos:function(){this.cachedData=this.cachedData||{},this.cachedData.pagesPos={};let e=this.cachedData.pagesPos,t=this.viewerType,i=this.PAGE_WIDTH,o=this.PAGE_HEIGHT;J.default.each(this.pages,function(r,n){e[r.num]=n*(t=="horizontal"?i:o)})},onPageChange:function(e){this.shown||(this.loadVisibleScreenshots.__debounced(),!g.isDesktop&&this.unloadInvisibleScreenshots.__debounced()),this.shiftToPage(e.num,this.shown),J.default.isEmpty(this.loadedScreenshots)&&this.loadVisibleScreenshots()},shiftToPage:function(e,t){let i=this.cachedData.scrollSize,o=this.cachedData.scrollPos,r=this.viewerType=="horizontal"?this.PAGE_WIDTH:this.PAGE_HEIGHT,n=this.cachedData.pagesPos[e],a=o+r/2,s=o+i-r/2,p;if(this.setActivePage(e),n<a)p=n-a;else if(n+r>s)p=n+r-s;else return;let c=this.viewerType=="horizontal"?"scrollLeft":"scrollTop",u={};u[c]=o+p,this.$pagesWrapper.stop().animate(u,t?300:0)},onPageClick:function(e){if(this.scroll&&this.scroll.wasContentDrag)return;let t=(0,I.default)(e.currentTarget).data("num");(!this.mag.currentPage||t!=this.mag.currentPage.num)&&this.mag.showPage(t,{animation:!1})},onConstructorScreenshotRenew(e,t,i){let o=this.$(".page").filter(function(){return(0,I.default)(this).data("id")===e}),r=RM.constructorRouter.mag.pages.find(function(n){return n.id===e});if(r){let n=this.mag.model.get("pages").find(s=>s._id===r.id);n&&["phone_portrait","tablet_portrait"].includes(i)?n[`viewport_${i}`].screenshot=t:n&&(n.screenshot=t);let a=this.mag.model.getPageScreenshot({_id:r.id},{width:this.PAGE_WIDTH,height:this.PAGE_HEIGHT},this.mag.viewport).src;o.attr("data-src")?o.attr("data-src",a):o.find(".screenshot").prop("src",a)}},getVisibleScreenshotRange:function(){let e=this.cachedData.scrollSize,t=this.cachedData.scrollPos,i=this.viewerType=="horizontal"?this.PAGE_WIDTH:this.PAGE_HEIGHT;return{min:Math.max(0,Math.floor(t/i)),max:Math.min(this.mag.getPagesCount()-1,Math.floor((t+e)/i))}},loadVisibleScreenshots:function(){if(!this.mag.pages||!this.mag.pages.length)return;let e=this.getVisibleScreenshotRange(),t=this;this.$(".page").each(function(i){var o=(0,I.default)(this),r=o.attr("data-src");if(i>=e.min&&i<=e.max&&r&&!t.loadedScreenshots[i]){var o=(0,I.default)(this);o.find(".screenshot").prop("src",r),o.removeAttr("data-src"),t.loadedScreenshots[i]=!0}})},unloadInvisibleScreenshots:function(){if(this.shown)return;let e=this.getVisibleScreenshotRange(),t=this;this.$(".page").each(function(i){var o=(0,I.default)(this),r=o.attr("data-src");if((i<e.min||i>e.max)&&!r&&t.loadedScreenshots[i]){var o=(0,I.default)(this);o.attr("data-src",o.find(".screenshot").prop("src")),o.find(".screenshot").prop("src",t.IMG_STUB),delete t.loadedScreenshots[i]}})},loadOtherScreenshots:function(){this.clearLoadOtherTimeout(),this.loadOtherSafeTimeout=500,this.loadNextScreenshot()},loadNextScreenshot:function(){let e=this.getVisibleScreenshotRange(),t=Math.floor((e.min+e.max)/2),i=this.loadedScreenshots,o=this.mag.getPagesCount()-1,r,n,a;for(r=t;r<=o&&i[r];r++);for(n=t;n>=0&&i[n];n--);if(n<0&&r>o)return;r>o?a=n:n<0?a=r:a=r-t>t-n?n:r,i[a]=!0;let s=this.$(".page").eq(a),p=s.find(".screenshot"),c=this;p.one("load error",function(){clearTimeout(c.$curLoadingTimeout),c.loadNextScreenshot()}),this.$curLoadingTimeout=setTimeout(function(){p.off(),c.loadOtherSafeTimeout*=1.1,c.loadNextScreenshot()},this.loadOtherSafeTimeout),p.prop("src",s.attr("data-src")),s.removeAttr("data-src"),this.$curLoadingScreenshot=p},clearLoadOtherTimeout:function(){this.$curLoadingScreenshot&&this.$curLoadingScreenshot.off(),clearTimeout(this.$curLoadingTimeout)},showProjectInfo(e=!0){let t=this.$el.find(".mag-menu");e?t.removeClass("no-project-info"):t.addClass("no-project-info"),this.hasProjectInfo=e},setActivePage(e){let t=this.$('.page[data-num="'+e+'"]');return this.$(".page.active").removeClass("active"),t.addClass("active"),this}}),Xt=_i;re();ve();var Ai=jt.default.View.extend({PAGE_COUNTER_TIMEOUT:2800,PAGE_COUNTER_TIMEOUT_INITIAL:4e3,brandingInToolbar:!1,template:Dt["template-viewer-toolbar"],events:{"click .menu-button":"toggleMenu","click .share-button":"toggleShare","click .embed-close-button":"onEmbedCloseClick"},initialize:function(e){return Oe.default.bindAll(this),Oe.default.extend(this,e),this},render:function(){if(this.setElement(this.template({mag:this.mag,isPreview:this.isPreview,hasMenu:this.hasMenu,hasShare:this.hasShare,hasPageCounter:this.hasPageCounter,pageCounterInsideMenu:this.hasMenu&&g.isPhone,totalPages:this.mag.getPagesCount(),common:RM.common,viewport:this.mag.viewport,controlsOnTop:this.controlsOnTop,brandingInToolbar:this.brandingInToolbar,icons:{sprite:G(`./common/toolbar/sprite${Q?"@2x":""}.png`)}})),this.$el.appendTo(this.$container),this.$menuButton=this.$el.find(".menu-button"),this.$shareButton=this.$el.find(".share-button"),this.$pageCounter=this.$el.find(".page-counter"),this.$pageCounterWrapper=this.$pageCounter.parent(),this.hasShare&&(this.share=new Gt({mag:this.mag,router:this.router,$container:g.isPhone?this.$container:this.$shareButton}).render(),this.hasMenu||this.$shareButton.addClass("without-menu-button")),this.hasMenu&&!this.isPreview&&this.renderMagMenu(),this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"menuShown",this.onMenuShow),this.listenTo(this.mag,"menuHidden",this.onMenuHide),this.listenTo(this.mag,"presentationModeOn",this.onPresentationModeOn),this.listenTo(this.mag,"presentationModeOff",this.onPresentationModeOff),!this.isPreview){let e=this.$(".offscreen-initially:visible"),t=150,i=e.length*t+800;e.each(function(o,r){setTimeout(function(){(0,Je.default)(r).removeClass("offscreen-initially")},i),i-=t})}return this.$("div[data-alt]:not(.rmalttext), a[data-alt]:not(.rmalttext)").RMAltText(),this.defaultHidden&&requestAnimationFrame(()=>{this.toggleToolbarVisibility(!1)}),this},renderMagMenu(){this.magMenu&&this.magMenu.destroy(),this.magMenu=new Xt({mag:this.mag,pages:this.pages,router:this.router,isPreview:this.isPreview,hasProjectInfo:this.hasProjectInfo,publishDate:this.publishDate,$container:this.$container,$toolbar:this.$el,viewerType:this.viewerType}).render()},destroy:function(){return this.share&&this.share.destroy(),this.magMenu&&this.magMenu.destroy(),this.remove()},isMenuOpened:function(){return!!this.menuShown},closeMenu:function(){this.magMenu&&this.magMenu.hide()},onPageChange:function(e,t){this.showPageCounter(e,t),this.$menuButton.removeClass("waiting-video-bg-start preloading"),this.prevPage&&this.stopListening(this.prevPage),e&&(e.loaded||(this.$menuButton.addClass("preloading"),this.listenTo(e,"pageLoaded",this.onPageLoaded)),e.hasVideoBG&&!e.videoBGStarted&&(this.$menuButton.addClass("waiting-video-bg-start"),this.listenTo(e,"videoBGStarted",this.onVideoBGStarted)),this.prevPage=e)},onPageLoaded:function(){this.$menuButton.removeClass("preloading")},onVideoBGStarted:function(){this.$menuButton.removeClass("waiting-video-bg-start")},onPresentationModeOn:function(){this.isPresentationMode=!0,this.updateVisibilityState()},onPresentationModeOff:function(){this.isPresentationMode=!1,this.updateVisibilityState()},updateVisibilityState:function(){this.isPresentationMode?this.$el.stop().fadeOut(200):this.$el.stop().fadeIn(200)},onMenuShow:function(){this.menuShown=!0,this.hidePageCounter()},onMenuHide:function(){this.menuShown=!1},getPageCounterSize:function(e){if(!this.cachedPageCounterData){this.$pageCounter.find(".cur").text("0");let i=this.$pageCounter.outerWidth();this.$pageCounter.find(".cur").text("00");let r=this.$pageCounter.outerWidth()-i,n=i-r;this.cachedPageCounterData={baseSize:n,digitSize:r},this.$pageCounter.find(".cur").text(e)}let t=this.cachedPageCounterData;return t.baseSize+(e+"").length*t.digitSize},updatePageCounterSize:function(e){!this.$pageCounter.length||!this.$pageCounterWrapper.length||(!this.menuShown&&this.pageCounterShown?this.$pageCounterWrapper.css("width",this.getPageCounterSize(e)):this.$pageCounterWrapper.css("width",""))},showPageCounter:function(e,t){this.hasPageCounter&&(this.$pageCounter.find(".cur").text(e.num),t.showPageCounter&&(clearTimeout(this.pageCounterTimeout),this.$el.addClass("show-page-counter"),this.pageCounterShown=!0,Modernizr.android?setTimeout(Oe.default.bind(function(){this.updatePageCounterSize(e.num)},this),17):this.updatePageCounterSize(e.num),this.isPreview||(this.pageCounterTimeout=setTimeout(this.hidePageCounter,t.initial?this.PAGE_COUNTER_TIMEOUT_INITIAL:this.PAGE_COUNTER_TIMEOUT))))},hidePageCounter:function(){this.hasPageCounter&&(clearTimeout(this.pageCounterTimeout),this.$el.removeClass("show-page-counter"),this.pageCounterShown=!1,this.updatePageCounterSize())},toggleMenu:function(){this.magMenu&&this.magMenu.toggle()},toggleShare:function(e){(0,Je.default)(e.target).is(this.$shareButton)&&this.share&&this.share.toggle()},postMessageToParent:function(e,t){let i={type:e,data:t},o=window.parent;o&&o.postMessage(JSON.stringify(i),"*")},onEmbedCloseClick:function(){this.postMessageToParent("close-fullscreen")},rerender:function(){this.destroy(),this.render()},changeMenuVisible(e=!0){this.hasMenu=e,this.$el.find(".menu-button").toggle(e)},changeProjectInfoVisible(e=!0){this.hasProjectInfo!==e&&(this.hasProjectInfo=e,this.magMenu?.showProjectInfo(e))},changeShareButtonVisible(e=!0){this.hasShare=e,this.$el.find(".share-button").toggle(e)},changePageCounterVisible(e=!0){this.hasPageCounter=e,this.$el.find(".page-counter-wrapper").toggle(e)},changeBrandingVisible(e=!0){this.$el.find(".toolbar-branding").toggle(e)},toggleToolbarVisibility(e=!0){e?this.$el.addClass("show").removeClass("hide"):this.$el.removeClass("show").addClass("hide")}}),Qt=Ai;var qt=A(ne()),We=A(oe());le();var Zt={"template-viewer-branding":B`
	<div class="rm-branding offscreen-initially">
	<% if (!hasCreateWithTemplateBtn) { %>
		<a class="rm-branding-button" href="<%="https://readymag.com" + '?' + utm_params%>" target="_blank"></a>
	<% } else { %>
		<a class="start-with-template" href="<%=hostForTemplate + '/start-with-template/' + numId + '?created_from_preview=true' %>" target="_blank"></a>
	<% } %>
	</div>
`};De();var $i=qt.default.View.extend({template:Zt["template-viewer-branding"],initialize:function(e){return We.default.bindAll(this),We.default.extend(this,e),this},render:function(){let e=this.mag&&this.mag.num_id,t=e?`utm_source=made_with_readymag&utm_medium=referral&utm_campaign=${e}`:"";return this.setElement(this.template({utm_params:t,hasCreateWithTemplateBtn:this.hasCreateWithTemplateBtn,hostForTemplate:H.readymag_auth_host,numId:e})),this.$el.appendTo(this.$container),this.listenTo(this.mag,"pageChanged",this.onPageChange),We.default.delay(function(){this.$el.removeClass("offscreen-initially")}.bind(this),800),this},destroy:function(){return this.remove()},onPageChange:function(){},hide:function(){this.$el.stop().fadeOut(200)},show:function(){this.$el.stop().fadeIn(200)}}),Kt=$i;ve();var ei=A(Pi());Ne();Fe();var Mi=e=>e.type==="touchmove";function Jt(){let e="ontouchstart"in document.documentElement?"touchmove":"mousemove",t={isStarted:!1,isDestroyed:!1,isTouchEvent:!1,cursorPosition:{x:0,y:0},cursorPagePosition:{x:0,y:0}},i=new Set;function o(r){t.isTouchEvent=Mi(r),t.cursorPosition={x:t.isTouchEvent?r.touches[0].clientX:r.clientX,y:t.isTouchEvent?r.touches[0].clientY:r.clientY},t.cursorPagePosition={x:t.isTouchEvent?r.touches[0].pageX:r.pageX,y:t.isTouchEvent?r.touches[0].pageY:r.pageY};for(let n of i)n.eventHandler({state:t,originalEvent:r})}return{start(){if(!(t.isStarted||t.isDestroyed||!i.size))return t.isStarted=!0,window.addEventListener(e,o,{passive:e==="mousemove"}),this},stop(){return window.removeEventListener(e,o),t.cursorPosition={x:0,y:0},t.cursorPagePosition={x:0,y:0},t.isStarted=!1,this},destroy(){this.stop(),t.isDestroyed=!0},on(r){i.add(r),t.isStarted||this.start()},off(r){i.delete(r),t.isStarted&&!i.size&&this.stop()}}}Ne();var Oi=et.default.View.extend({TYPEKIT_PREVIEW_API_LINK:"//use.typekit.net/previewkits/pk-v1.js",PRELOAD_COUNT_HORIZONTAL:{backward:1,forward:g.isDesktop?5:g.isPhone?3:2},PRELOAD_COUNT_VERTICAL:{backward:g.isDesktop?2e3:(g.isPhone,1e3),forward:g.isDesktop?3e3:(g.isPhone,2e3)},SCROLLABLE_TRESHOLD:100,SCROLL_SNAP:0,template:Lt["template-viewer-mag"],staticGlobalWidgetsData:[],aboveGlobalWidgetsData:[],hasTextWidgetsV3:void 0,hasWidgetsWithVerticalOnscrollAnimation:void 0,whenWidgetsCreated:{},opts:{},viewportCounter:1,initialize:function(e,t){m.default.bindAll(this),e||(e={}),m.default.defaults(e,{pages:[]});let i=!1;if(e.hasSummary)this.staticGlobalWidgetsData=e.globalWidgets||[],this.aboveGlobalWidgetsData=e.aboveAllWidgets||[];else{let a=(0,m.default)(e.pages).chain().reduce(function(s,p){return y.pushArray(s,p.wids||[])},[]).each(s=>{O.normalizeAnimations(s.animation).find(c=>c.type==="scroll"&&c.steps&&c.steps.find(u=>u.dy))&&(i=!0)}).filter({is_global:!0}).value();this.staticGlobalWidgetsData=a.filter(s=>!s.is_above),this.aboveGlobalWidgetsData=a.filter(s=>s.is_above)}let o=this.aboveGlobalWidgetsData.map(a=>a._id),r=this.staticGlobalWidgetsData.map(a=>a._id);e.pages.forEach(a=>void(a.pagePath=a.pagePath||a.uri||a.num.toString())),e.pages.forEach(a=>void(a.uri=a.pagePath)),e.pages.forEach(a=>{if(a.wids.length&&typeof a.wids[0]=="string")a.wids=a.wids.filter(s=>!o.includes(s)&&!r.includes(s)).concat(r),a.widgetsData=[...this.staticGlobalWidgetsData];else{let s=this.staticGlobalWidgetsData.filter(c=>c.pid!==a._id),p=a.wids.concat(s);a.wids=m.default.unique(p,c=>c._id||Math.random()).filter(c=>!o.includes(c._id))}}),m.default.extend(this,e),this.hasWidgetsWithVerticalOnscrollAnimation=i||e.hasWidgetsWithVerticalOnscrollAnimation,this.hasTextWidgetsV3=e.hasTextWidgetsV3,this.model=new gt(e,{parse:!0}),this.router=t;let n=a=>{a.products&&this.eCommerceCartManager&&this.eCommerceCartManager.setProducts(a.products)};return this.eCommerceManager=new ye({numId:this.model.attributes.num_id,ecommerceData:this.model.attributes.ecommerce_data,isPublished:this.router.environment===H.environment.viewer,isDownloadedSource:window.RM.common.isDownloadedSource,onDataChange:n}),this.eCommerceManager.setCartWidgetExistState(xt(this.router.environment,[...this.staticGlobalWidgetsData,...this.aboveGlobalWidgetsData])),this.eCommerceCartManager=new Tt({router:this.router,mag:this,environment:this.router.environment,products:[]}),this.setupEcommerceSidebar(),this.isPreview=t.isPreview,this.$container=t.$mags_container||(0,h.default)("#root"),g.isDesktop&&(0,h.default)("<div>").bind("mousewheel",function(){}),this.setViewerOptions(this.getMagViewport()),this.continueLoading.__debounced=m.default.debounce(this.continueLoading,200),this.loadPages.__debounced=m.default.debounce(this.loadPages,700),this.onResize.__debounced=m.default.debounce(this.onResize,300),this.redrawAboveGlobalWidgets.__debounced=m.default.debounce(this.redrawAboveGlobalWidgets,500,!0),this.widgetPackCount=0,this.getAboveGlobalBoxMemoized=m.default.memoize(this.getAboveGlobalBox,function(a,s,p){return a+" "+(s&&s.num)+" "+(s&&s.pageViewport)+" "+(p&&p.width)+" "+(p&&p.height)}),this},detectStickyVerticalViewer(e={}){return e.viewertype==="vertical"&&g.isDesktop?!e.slidein&&!this.isPreview&&!this.hasWidgetsWithVerticalOnscrollAnimation:e.viewertype==="vertical"?Modernizr.csspositionsticky:!1},getProjectOptions(e={},t="default",i=!0){let o=m.default.extend(i?{arrows:!1,menubutton:!1,projectinfo:!1,sharebutton:!1,pagecounter:!1,controlsontop:!1,viewertype:"vertical",slidein:!1,scalewidth:3600,lqip:!1}:{},e);return o.viewertype=RM.screenshot?"horizontal":o.viewertype,(!g.isDesktop||this.isPreview&&t!=="default")&&(o.slidein=!1),o.viewertype==="vertical"&&!g.isDesktop&&!this.detectStickyVerticalViewer(o)&&(o.viewertype="horizontal",this.pages?.length>1&&(o.arrows=!0)),o.sharebutton=o.sharebutton&&!this.isPreview&&!!this.published&&!this.is_private,o.pagecounter=o.pagecounter&&!this.isPreview&&this.pages?.length>1,o.branding=(m.default.isUndefined(o.branding)?o.endpage:o.branding)&&!this.isPreview,o.menubutton=o.menubutton&&!this.isPreview,["phone_portrait","tablet_portrait"].includes(this.viewport)&&(o.projectinfo=!1),o},getViewportOptions(e="default"){let t=`viewport_${e}`;return{...this.model.get("opts"),...e!=="default"?this.model.get(t)?.opts||{}:{}}},setViewerOptions(e){if(this.viewport=e,typeof window<"u"&&typeof window.Proxy<"u"){let t=this;this.viewOpts=new Proxy({},{get(i,o){let r=t.getProjectOptions(t.model.get("opts"),t.viewport,!0);if(t.viewport!=="default"){let n=`viewport_${t.viewport}`,a=t.getProjectOptions(t.model.get(n)?.opts,t.viewport,!1)[o];return a!==void 0?a:r[o]}else return r[o]}})}else{let t=`viewport_${this.viewport}`;this.viewOpts={...this.getProjectOptions(this.model.get("opts"),this.viewport,!0),...this.viewport!=="default"?this.getProjectOptions(this.model.get(t)?.opts,this.viewport,!1):{}}}this.isStickyVerticalViewer=this.detectStickyVerticalViewer(this.viewOpts),this.PRELOAD_COUNT=this.viewOpts.viewertype=="horizontal"?this.PRELOAD_COUNT_HORIZONTAL:this.PRELOAD_COUNT_VERTICAL},setViewerClasses:function(){this.$el.removeClass("viewer-type-horizontal viewer-type-vertical").addClass("viewer-type-"+this.viewOpts.viewertype).removeClass("pages-pos-normal pages-pos-overlap").addClass("pages-pos-"+(this.viewOpts.slidein?"overlap":"normal")),this.viewOpts.viewertype=="vertical"&&((0,h.default)("html").addClass("overflow-on-vertical-view"),this.isStickyVerticalViewer&&(this.$el.addClass("viewer-type-vertical-sticky"),(0,h.default)("body").addClass("overflow-on-vertical-view"))),this.toggleControlsOnTop(this.viewOpts.controlsontop),(0,h.default)("html").addClass("new-settings").addClass("mobile-screenshots"),this.viewOpts.useCustomCursor&&this.initProjectCursors()},getCursorCssStylesString({cursorUrl:e,cursorSize:t,isLambda:i,isHover:o}){if(!e)return"";let r=`cursor: url(${e}), ${o?"pointer":"auto"};`;if(t&&i){let n=Math.max(t.width,t.height),a=`
      cursor: -webkit-image-set(
        url(${e}?w=${Math.round(n/2)}) 1x,
        url(${e}) 2x
      ), ${o?"pointer":"auto"};`;r+=`
 ${a}`}return r},initProjectCursors(){if(this.viewOpts.useCustomCursor){if(this.viewOpts.customCursorImage){if(!!document.getElementById("default-custom-cursor-style"))return;let t=this.getCursorCssStylesString({cursorUrl:this.viewOpts.customCursorImage,cursorSize:this.viewOpts.customCursorSize,isLambda:this.viewOpts.customCursorIsLambda}),i=document.createElement("style");i.id="default-custom-cursor-style",i.appendChild(document.createTextNode(`html, body {${t}}`)),document.querySelector("head").appendChild(i)}if(this.viewOpts.customHoverCursorImage){if(!!document.getElementById("hover-custom-cursor-style"))return;let t=this.getCursorCssStylesString({cursorUrl:this.viewOpts.customHoverCursorImage,cursorSize:this.viewOpts.customHoverCursorSize,isLambda:this.viewOpts.customHoverCursorIsLambda,isHover:!0}),i=`        a.external-link, a.maglink, a.anchor-link, .goback-link, .mailchimp-link, .share-link {
          ${t}
        }
        .common-hotspot .pin {
          ${t}
        }
        .common-form .button {
          ${t}
        }
        .common-slideshow .images .prev-picture-arrow-middle, .common-slideshow .images .next-picture-arrow-middle, .common-slideshow .thumbnails .thumb:not(.active) {
          ${t}
        }
        .rmwidget.e-com-cart-button {
          ${t}
        }
        .widget-add-to-cart .add-to-cart-wrap .add-to-cart-button.viewer-button {
          ${t}
        }
        #cart-sidebar .sidebar-btn, #cart-sidebar .sidebar-icon-btn {
          ${t}
        }
      `,o=document.createElement("style");o.id="hover-custom-cursor-style",o.appendChild(document.createTextNode(i)),document.querySelector("head").appendChild(o)}}},toggleControlsOnTop(e=!0){let t="controls-on-top";(0,h.default)("html").toggleClass(t,e)},unsetViewerClasses:function(){if(this.$el.removeClass("viewer-type-horizontal viewer-type-vertical").removeClass("pages-pos-normal pages-pos-overlap viewer-type-vertical-sticky"),(0,h.default)("html").removeClass("overflow-on-vertical-view controls-on-top"),this.$magScrollSizer?.css("height",""),(0,h.default)("body").removeClass("overflow-on-vertical-view"),this.viewOpts.useCustomCursor){if(this.viewOpts.customCursorImage&&document.body.style.cursor&&(document.body.style.cursor="auto"),this.viewOpts.customCursorImage){let e=document.getElementById("default-custom-cursor-style");e&&e.remove()}if(this.viewOpts.customHoverCursorImage){let e=document.getElementById("hover-custom-cursor-style");e&&e.remove()}}},render:function(){if(this.active)return;this.title=this.title||"Project",this.magOpenTime=new Date,document.documentElement.style.setProperty("--min-desktop-width",`${M.dictionary.default.min_scale_width}px`),this.setElement(this.template({hasStandaloneBottomArrow:!this.isPreview&&this.viewOpts.viewertype=="vertical"&&this.viewOpts.arrows,isPreview:!!this.isPreview,icons:{sprite:G(`./common/navigation/sprite${Q?"@2x":""}.png`)}})),this.$el.appendTo(this.$container),this.setViewerClasses(),U.on("ecwid:checkout:opened",this.onEcwidOpened.bind(this)),U.on("ecwid:checkout:closed",this.onEcwidClosed.bind(this)),(0,h.default)("body").on("click","a.external-link",this.toExternalLink).on("click",".maglink.back-to-top",this.backToTopCurrentPage).on("click",".maglink",this.maglink).on("click",".goback-link",this.onGobackLinkClick).on("click",".mailchimp-link",this.onMailchimpLinkClick).on("click",".anchor-link",this.onAnchorLinkClick).on("click",".share-link",this.onShareLinkClick),this.$mag_container=this.$(".mag-pages-container"),this.$mag_container.on("scroll",this.fixFocusScroll),this.$mag_viewport_device=this.$(".mag-pages-viewport-device"),this.$pages_container=this.$(".mag-pages-container .container"),this.$pages_blackout=this.$pages_container.find(".blackout"),this.$aboveWidgetsContainer=this.$(".above-pages-container"),this.viewOpts.viewertype=="vertical"&&(this.$magScrollContainer=(0,h.default)(window),this.$magScrollSizer=(0,h.default)("body"),this.isStickyVerticalViewer&&(this.$magScrollSizer=(0,h.default)("body").add(this.$el)),this.$magScrollHandler=(0,h.default)(window),this.$magScrollAnimate=(0,h.default)("body, html")),this.active=!0,this.globalEvents=new Jt({mag:this});let e=this.pages;this.pages=null,this.viewport=null,this.switchToViewport(this.getMagViewport()),g.isDesktop||setTimeout(this.onResize,1500),this.pages=(0,m.default)(e).chain().sortBy(function(a){return a.num}).map(m.default.bind(function(a){let s="";try{s=new Pe({mag:this,router:this.router,totalPages:e.length,pageData:a,viewerType:this.viewOpts.viewertype,isStickyVerticalViewer:this.isStickyVerticalViewer,$container:this.$pages_container,viewOpts:this.viewOpts}).render()}catch(p){console.log("Error page rendering.",p)}return s},this)).filter(function(a){return!!a}).value();let t=this.getPage(this.getPagesCount());t&&t.markAsLast(),this.viewOpts.viewertype==="horizontal"&&this.setPagesTransitions(),RM.screenshot||this.renderControls(),this.onResize(),this.viewOpts.viewertype==="vertical"&&(g.isDesktop&&this.getPage(1)&&this.getPage(1).$content.focus(),(0,h.default)("body").on("keydown",this.onVerticalViewKeyDown)),g.isDesktop?((0,h.default)(window).on("mousedown",this.onMouseDown),(0,h.default)(window).on("mouseup",this.onMouseUp),(0,h.default)(window).on("mousewheel",this.onMouseWheel)):((0,h.default)(window).on("touchstart",this.onDragStart),(0,h.default)(window).on("touchmove",this.onDragMove),(0,h.default)(window).on("touchend touchcancel",this.onDragEnd),(0,h.default)(window).on("pageshow",this.onResize)),y.PageVisibilityManager.addEventListener(this.onPageVisibilityChange),(0,h.default)(window).on("resize",this.onResize),this.isPreview&&(this.listenTo(this.model,"change:opts",(a,s)=>{this.onOptionsChange(a.previous("opts"),s)}),this.listenTo(this.model,"change:viewport_phone_portrait",(a,s)=>{let p=this.model.get("opts"),c=a.previous("viewport_phone_portrait")?.opts??{};this.onOptionsChange({...p,...c},s?.opts,"phone_portrait")}),this.listenTo(this.model,"change:viewport_tablet_portrait",(a,s)=>{let p=this.model.get("opts"),c=a.previous("viewport_tablet_portrait")?.opts??{};this.onOptionsChange({...p,...c},s?.opts,"tablet_portrait")}),this.on("change:viewport",({viewport:a,oldViewport:s})=>{this.onOptionsChange(this.getViewportOptions(s),this.getViewportOptions(a),a)})),g.isDesktop||(0,h.default)(window).on("orientationchange",this.onOrientationChange),(0,h.default)(window).on("gesturestart gestureend",this.onGestureChange),this.viewOpts.viewertype=="vertical"&&this.$magScrollHandler?.on("scroll",this.onMagScroll),(0,h.default)("body").on("keyup",this.onKeyup),Z.generateCSS("paragraph","viewer",document,this.edit_params&&this.edit_params.paragraph_styles),Z.generateCSS("link","viewer",document,this.edit_params&&this.edit_params.link_styles),!(RM.screenshot&&y.queryUrlGetParam("pdf")=="true")&&!this.isPreview&&Z.setShortList(Z.getVeryShortList(this.edit_params&&this.edit_params.fonts));let o=!this.isPreview&&this.model.get("is_published")?"published":"edit",r=this;o=="edit"&&!window.TypekitPreview?h.default.getScript(this.TYPEKIT_PREVIEW_API_LINK,function(){n()}):n();function n(){Z.appendFontsCssToDocument({version:o,fonts:r.edit_params&&r.edit_params.fonts,typekit_url:r.typekit_url})}return this.globalEvents?.start(),this},destroy:function(){return m.default.each(this.pages,function(e){e.destroy()}),this.pages=null,this.globalEvents?.destroy(),U.off("ecwid:checkout:opened",this.onEcwidOpened.bind(this)),U.off("ecwid:checkout:closed",this.onEcwidClosed.bind(this)),(0,h.default)("body").off("click","a.external-link",this.toExternalLink).off("click",".maglink.back-to-top",this.backToTopCurrentPage).off("click",".maglink",this.maglink).off("click",".goback-link",this.onGobackLinkClick).off("click",".mailchimp-link",this.onMailchimpLinkClick).off("click",".anchor-link",this.onAnchorLinkClick).off("keydown",this.onVerticalViewKeyDown).off("click",".share-link",this.onShareLinkClick),this.destroyControls(),this.cartSidebar&&setTimeout(()=>{this.cartSidebar.destroy()},320),g.isDesktop?((0,h.default)(window).off("mousedown",this.onMouseDown),(0,h.default)(window).off("mouseup",this.onMouseUp),(0,h.default)(window).off("mousewheel",this.onMouseWheel)):((0,h.default)(window).off("touchstart",this.onDragStart),(0,h.default)(window).off("touchmove",this.onDragMove),(0,h.default)(window).off("touchend touchcancel",this.onDragEnd),(0,h.default)(window).off("pageshow")),this.unsetViewerClasses(),y.PageVisibilityManager.removeEventListener(this.onPageVisibilityChange),(0,h.default)(window).off("resize",this.onResize),(0,h.default)(window).off("orientationchange",this.onOrientationChange),(0,h.default)(window).off("gesturestart gestureend",this.onGestureChange),this.$magScrollHandler?.off("scroll",this.onMagScroll),(0,h.default)("body").off("keyup",this.onKeyup),this.active=!1,this.trigger("destroyed"),this.remove()},renderControls(){this.viewOpts.viewertype==="horizontal"&&this.viewOpts.arrows&&(this.navigation=new Ke({mag:this,router:this.router,$container:this.$el,isPreview:this.isPreview,viewerType:this.viewOpts.viewertype}).render());let e=window.location.href.indexOf(`${H.readymag_host}/designs/`)>-1,t=(this.must_show_branding||this.viewOpts.branding)&&!(RM.common.embedMode&&!g.isDesktop),i=(t||e)&&g.isDesktop&&!this.viewOpts.controlsontop||this.isPreview;this.toolbar=new Qt({mag:this,pages:this.pages,router:this.router,$container:this.$el,isPreview:this.isPreview,hasMenu:this.viewOpts.menubutton,hasProjectInfo:this.viewOpts.projectinfo,hasShare:this.viewOpts.sharebutton&&!H.IS_FILE_PROTOCOL,hasPageCounter:this.viewOpts.pagecounter,controlsOnTop:this.viewOpts.controlsontop,brandingInToolbar:i,viewerType:this.viewOpts.viewertype,publishDate:this.published?Mt(new Date(this.published),"MMM dd, yyyy"):"unpublished",defaultHidden:this.defaultHideToolbar}).render(),(t||e)&&(this.branding=new Kt({mag:this,hasCreateWithTemplateBtn:e,$container:i?this.toolbar.$el.find(".toolbar-branding"):this.$el}).render()),this.viewOpts.viewertype==="vertical"&&(this.$bottomArrow=this.$(".navigation-arrow.bottom"),this.$bottomArrow.on("click",this.scrollMagALittle))},destroyControls(){this.toolbar?.destroy(),this.branding?.destroy(),this.navigation?.destroy(),this.$bottomArrow?.off("click",this.scrollMagALittle)},onEcwidOpened:function(){this.isEcwidOpened=!0},onEcwidClosed:function(){this.isEcwidOpened=!1},rerenderPage(e,t){let i=this.pages.findIndex(n=>n._id===e._id);if(i===-1)return;let o=i+1<this.pages.length?this.pages[i+1].$el:void 0;this.pages[i].destroy();let r=new Pe({mag:this,router:this.router,totalPages:this.pages.length,pageData:{...e,wids:[...e.wids.filter(n=>!n.is_global),...t.globalWidgets||[]]},viewerType:this.viewOpts.viewertype,isStickyVerticalViewer:this.isStickyVerticalViewer,$container:this.$pages_container,viewOpts:this.viewOpts});o&&o.length&&r.$el.remove().insertBefore(o),r.render(),this.pages[i]=r,e._id===this.currentPage?._id&&(this.currentPage=void 0),this.onResize()},getUrl:function(){return RM.common.isDomainViewer?window.location.protocol+"//"+window.location.hostname+"/"+(RM.common.customDomainProfile?this.num_id+"/":""):window.location.protocol+"//"+window.location.hostname+"/"+this.num_id+"/"},getPage:function(e){return parseInt(e,10)==e&&(e=parseInt(e,10)),m.default.isNumber(e)?this.pages[e-1]:(0,m.default)(this.pages).find(function(t){return t.uri==e})},getPageByPath:function(e){return e.toString()==="1"?this.pages[0]:this.pages.find(t=>t.pagePath===e)},getPagesCount:function(){return this.pages&&this.pages.length},isFirstPage:function(){return this.currentPage&&!this.getPage(this.currentPage.num-1)},isLastPage:function(){return this.currentPage&&!this.getPage(this.currentPage.num+1)},getPageId:function(e){let t=m.default.find(this.pages,function(i){return i.num_id===e});return t&&t._id},getPageNum:function(e){let t=m.default.find(this.pages,function(i){return i._id==e});return t&&t.num},getPageUri:function(e){let t=m.default.find(this.pages,function(o){return o._id==e});if(!t)return null;let i=t.uri?t.uri+"/":t.num==1?"":t.num+"/";return this.router.getMagUri(this)+i},getPageById:function(e){return m.default.find(this.pages,function(t){return t._id==e})},getPageTransitionTime:function(){let e=400,t=Math.min(this.viewOpts.scalewidth,this.getContainerSizeCached().width),i=this.getContainerSizeCached().height;return g.isDesktop?e=550:g.isTablet?t>i?e=550:e=470:t>i?e=520:e=370,e},onPageVisibilityChange:function(){if(this.currentPage)if(clearTimeout(this.visibilityHandlerTimeout),y.PageVisibilityManager.isPageHidden())this.visibilityHandlerTimeout=setTimeout(()=>{this.currentPage.stop({widgetTypes:["video","background","iframe"]});let e=this.getPage(this.currentPage.num+1);e&&e.started&&(e.stop({widgetTypes:["video","background","iframe"]}),this.restartNextPage=!0)},700);else{this.currentPage.start({widgetTypes:["audio","video","background","iframe"],forceStart:!0});let e=this.getPage(this.currentPage.num+1);e&&this.restartNextPage&&(e.start({widgetTypes:["audio","video","background","iframe"],forceStart:!0}),delete this.restartNextPage)}},updateArrowsColor:function(e){if(!e)return;let t=e.arrows_color||"white";this.$el.removeClass("navigation-white-arrows").removeClass("navigation-black-arrows").addClass("navigation-"+t+"-arrows")},onDragStart:function(e){clearTimeout(this.touchInProgressTimeout),this.pauseLoading("touch");let t=e.originalEvent.targetTouches[0];this.globalTouchObject={$target:(0,h.default)(e.target).closest(".has-horizontal-scroll, .has-vertical-scroll"),x:t.screenX,y:t.screenY,startTime:+new Date}},onDragMove:function(e){if(this.isWidgetDragging||this.isEcwidOpened)return;let t=this.globalTouchObject;if(e.originalEvent.touches.length>1||!t)return;if(this.viewOpts.viewertype=="horizontal"?this.currentPage&&this.currentPage.hasFixedWidgets&&(0,h.default)(e.target).closest(this.$mag_container).length&&!t.$target.length&&(t.$target=this.currentPage.$scrollWrapper):t.$target.length||(t.$target=this.$magScrollContainer),!t.$target.length){e.preventDefault();return}if(y.isPageNativelyScaled())return;let i=e.originalEvent.targetTouches[0],o=i.screenY-t.y,r=5;if(Math.abs(o)>r&&t.$target.hasClass("has-vertical-scroll")){let n=t.$target[0].scrollHeight,a=t.$target.outerHeight();o>0&&t.$target.scrollTop()<=0&&e.preventDefault(),o<0&&t.$target.scrollTop()>=n-a&&e.preventDefault()}t.$target.hasClass("has-horizontal-scroll")},onDragEnd:function(e){this.checkDoubleTap(e),this.touchInProgressTimeout=setTimeout(m.default.bind(function(){this.continueLoading("touch")},this),400);let t=this.globalTouchObject;if(t){let i=e.originalEvent.changedTouches[0],o=i.screenX-t.x,r=i.screenY-t.y;this.toolbar&&this.toolbar.isMenuOpened()&&Math.abs(o)<3&&Math.abs(r)<3&&+new Date-t.startTime<500&&!y.isPageNativelyScaled()&&(0,h.default)(e.target).closest(this.$mag_container).length&&this.closeMagMenu()}delete this.globalTouchObject},checkDoubleTap:function(e){if(e.originalEvent.touches.length>0)return;let t=+new Date,i=t-(this.lastTouchEndTime||t+1);if(this.lastTouchEndTime=t,i<500&&i>0&&y.isPageNativelyScaled()){let o=(0,h.default)('meta[name="viewport"]');if(o.length){let r=o.attr("content"),n=r.replace(/maximum\-scale\=[0-9\.]*/,"maximum-scale=1.0");if(o.attr("content",n),Modernizr.android){let a=(0,h.default)("<div>").appendTo("body");m.default.delay(function(){a.remove()},500),setTimeout(m.default.bind(function(){o.attr("content",r);let s=(0,h.default)("<div>").appendTo("body");m.default.delay(function(){s.remove()},500)},this),1e3)}else o.attr("content",r);this.lastTouchEndTime=0,m.default.delay(function(){(0,h.default)(window).trigger("gesturechange")},300),m.default.delay(function(){(0,h.default)(window).trigger("gesturechange")},1e3)}}},onMouseDown:function(e){this.globalMouseObject={x:e.screenX,y:e.screenY,startTime:+new Date}},onMouseUp:function(e){let t=this.globalMouseObject;if(t){let i=e.screenX-t.x,o=e.screenY-t.y;this.toolbar&&this.toolbar.isMenuOpened()&&Math.abs(i)<3&&Math.abs(o)<3&&+new Date-t.startTime<500&&(0,h.default)(e.target).closest(this.$mag_container).length&&this.closeMagMenu()}delete this.globalMouseObject},onMouseWheel:function(e){e.originalEvent.deltaX<0&&Math.abs(e.originalEvent.deltaY)<2&&e.cancelable&&e.preventDefault()},onKeyup:function(e){if(e.target.tagName.toLowerCase()=="input"||e.target.tagName.toLowerCase()==="textarea"&&!e.target.classList.contains("copyhack")||!m.default.isEmpty(RM.common.disableShortcuts)||this.isInPresentationMode)return;let t=this.currentPage.viewport_tablet_portrait?.enabled,i=this.currentPage.viewport_phone_portrait?.enabled,o,r=t&&i?3:!t||!i?2:1,n;if((e.keyCode>=49&&e.keyCode<=51||String.fromCharCode(e.keyCode)==="D")&&(this.viewportCounter=ae.incrementCircular(this.viewportCounter,r)),String.fromCharCode(e.keyCode)==="D"?o=String(this.viewportCounter):o=String.fromCharCode(e.keyCode),o==="1"?n="default":o==="2"&&t?n="tablet_portrait":o==="3"&&i||o==="2"&&!t?n="phone_portrait":n=void 0,n&&this.isPreview){let s=this.viewOpts.viewertype,p=n==="default"?this.model.get("opts").viewertype:this.model.get(`viewport_${n}`)?.opts?.viewertype;p&&s!==p?RM.constructorRouter?.preview.restartMag({viewport:n}):this.switchToViewport(n)}m.default.find(h.default.keycodes,function(s,p){return h.default.keycodes[p]===e.keyCode})&&this.trigger("keypress-"+e.keyCode,e)},onKeydown:function(e){if(!(e.target.tagName.toLowerCase()=="input"||e.target.tagName.toLowerCase()==="textarea"&&!e.target.classList.contains("copyhack"))&&m.default.isEmpty(RM.common.disableShortcuts)&&this.isInPresentationMode&&!(e.altKey||e.ctrlKey||e.metaKey))switch(e.which){case 8:case 33:case 80:case 37:case 72:case 38:case 75:e.preventDefault(),this.goPrevPage({animation:!0});break;case 13:case 34:case 78:case 39:case 76:case 40:case 74:e.preventDefault(),this.goNextPage({animation:!0});break;case 36:e.preventDefault(),this.goFirstPage();break;case 35:e.preventDefault(),this.goLastPage();break;case 9:case 32:e.preventDefault(),e.shiftKey?this.goPrevPage({animation:!0}):this.goNextPage({animation:!0});break;case 77:e.preventDefault(),this.trigger("keypress-"+e.keyCode,e);break}},onVerticalViewKeyDown:function(e){if(!(this.isInPresentationMode||this.viewOpts.viewertype!=="vertical")&&(e.which===h.default.keycodes.down||e.which===h.default.keycodes.up)){if(e.preventDefault(),this.arrowKeyLastScrollAt&&new Date-this.arrowKeyLastScrollAt<400)return;let t=e.which===h.default.keycodes.down;this.arrowKeyLastScrollAt=+new Date;let i=window.innerHeight,o=this.getScroll(),r=this.getScrollPosition(),n=Math.round(i/4),a=function(z){return z&&z<=n},s=function(z){return z>n&&z<i},p=m.default.bind(function(){let z=this.magPagesPos[this.currentPage.num];return Math.abs(o-z.y)},this),c=this.currentPage.pageHeight,u=r===0&&!this.isFirstPage(),v,S;if(t)v=c-r-i,a(v)?S=c-r:s(v)?S=v:S=i,u&&this.viewOpts.slidein&&(S+=p());else{if(u){let z=this.magPagesPos[this.currentPage.num-1];r=z?z.h:0}v=r-i,a(v)||r<i?S=-r:S=-i,u&&this.viewOpts.slidein&&(S-=this.SCROLL_SNAP-p())}this.setScrollPosition({delta:S,animate:!0})}},togglePresentationMode:function(e){!!this.isInPresentationMode!=e&&g.isDesktop&&(this.isPreview||(e?((0,h.default)("body").on("keydown",this.onKeydown),this.trigger("presentationModeOn")):((0,h.default)("body").off("keydown",this.onKeydown),this.trigger("presentationModeOff")),this.isInPresentationMode=e))},recalcBottomArrowState:function(e){!this.currentPage||e!==this.currentPage||this.navigation&&this.navigation.recalcBottomArrowState(e)},setScrollPosition:function(e){if(!this.currentPage)return;let t;this.viewOpts.viewertype=="vertical"?(typeof e.offset<"u"?t=this.magPagesPos[this.currentPage.num].y+e.offset:t=this.getScroll()+e.delta,e.animate?this.$magScrollAnimate.animate({scrollTop:t},500):this.setScroll(t)):(typeof e.offset<"u"?t=e.offset:t=this.currentPage.$scrollWrapper.scrollTop()+e.delta,e.animate?this.currentPage.$scrollWrapper.animate({scrollTop:t},500):this.currentPage.$scrollWrapper.scrollTop(t))},getScrollPosition:function(){if(!this.currentPage)return 0;let e=0;return this.viewOpts.viewertype=="vertical"?e=Math.max(this.getScroll()-this.magPagesPos[this.currentPage.num].y,0):e=this.currentPage.$scrollWrapper.scrollTop(),e},getScroll:function(){return this.$magScrollContainer&&this.$magScrollContainer.scrollTop()},setScroll:function(e){this.$magScrollContainer&&this.$magScrollContainer.scrollTop(e)},onMagScroll:function(){if(document.fullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement||document.mozFullScreenElement||document.msFullscreenElement||this.hadPlayingVideoOnResize){this.hadPlayingVideoOnResize=!1;return}m.default.isFunction(this._resetUrlStringTimeoutFunc)&&this._resetUrlStringTimeoutFunc(),this.pauseWidgetsLoadingOnScroll();let e=this.findPageOnCurrentMagScroll({pageStartsOnBottom:!1}),t=this.getScrollParams(e);this.lastPageScroll=t.pageScroll,this.lastPageScrollPercent=t.pageScrollPercent,this.showPage(e.page.num,t),this.aboveGlobalAnimations&&this.aboveGlobalAnimations.onScroll({forceApply:!0,scroll:this.getScroll()}),this.trigger("mag scroll",this.getScroll()),this.$bottomArrow&&+this.magOpenTime+2e3<+new Date&&this.hideBottomButton()},showBottomButton:function(){this.$bottomArrow?.removeClass("offscreen")},hideBottomButton:function(){this.$bottomArrow?.addClass("offscreen")},scrollMagALittle:function(){this.$magScrollAnimate.animate({scrollTop:this.getScroll()+this.getContainerSizeCached().height},500)},findPageOnCurrentMagScroll:function(e){e=e||{};var i=this.getScroll(),t=this.getContainerSizeCached(),i=Math.min(Math.max(i,0),this.magHeight-t.height),o=this.pages.length,r=i+(e.pageStartsOnBottom?t.height-50-16-16:0),n,a,s,p;for(n=0;n<o;n++){a=this.pages[n],s=this.magPagesPos[a.num];let c=p?p.y+p.h:s.y;if(r>=c&&r<s.y+s.h||n==o-1)return{page:a,scroll:i,pos:s};p=s}},getScrollParams:function(e){let t=Math.max(e.scroll-e.pos.y,0),i=t/e.page.pageHeight,o={initiator:"scroll",pageScroll:t,pageScrollPercent:i};if(this.viewOpts.slidein?(o.nextPageScroll=0,o.slideInNextPageScroll=e.pos.h-o.pageScroll):o.nextPageScroll=o.pageScroll-e.pos.h,o.nextPageVisible=e.pos.h-o.pageScroll<this.getContainerSizeCached().height,this.viewOpts.slidein){let r=(e.pos.h-o.pageScroll)/this.getContainerSizeCached().height;o.nextPageBlackout=Math.min(Math.max(r,0),1)}return o},onCurrentPageScroll:function(e,t){this.pauseWidgetsLoadingOnScroll(),this.aboveGlobalAnimations&&this.aboveGlobalAnimations.onScroll({forceApply:!this.isStickyVerticalViewer,scroll:t}),this.lastPageScroll=t,this.lastPageScrollPercent=this.lastPageScroll/e.pageHeight,this.loadPages.__debounced()},scrollCurrentPageALittle:function(){this.currentPage&&this.currentPage.scrollPageALittle()},focusCurrentPage:function(){this.currentPage&&this.currentPage.focusPage()},backToTopCurrentPage:function(){if(this.viewOpts.viewertype=="vertical"){let e=this.findPageOnCurrentMagScroll();this.getScroll()!==e.pos.y&&this.$magScrollAnimate.animate({scrollTop:e.pos.y},500)}else this.currentPage&&this.currentPage.backToTop();RM.analytics&&RM.analytics.sendEvent("rm_scroll_top_link_click")},backToTopCurrentPageWithoutAnimation:function(){this.viewOpts.viewertype!=="vertical"&&this.currentPage&&this.currentPage.scrollTo(0,!1)},scrollPageToPos:function(e,t){let i=this.getPage(e),o,r=this.getContainerSizeCached(),n=i.scale,a;t=t||0,t=t*n,t=t+i.contentPosition.top,this.viewOpts.viewertype=="vertical"?(o=this.magPagesPos[i.num],a=Math.max(0,o.y+t),a=Math.min(a,o.y+o.h-r.height),this.$magScrollAnimate.animate({scrollTop:a},500)):(this.currentPage!=i&&this.showPage(i.num),a=Math.max(0,t),i.scrollTo(a))},pauseWidgetsLoadingOnScroll:function(){},toExternalLink:function(e){let t=(0,h.default)(e.target).closest("a").attr("href");RM.analytics&&RM.analytics.sendEvent("click",t)},maglink:function(e){if(e.which===2||e.metaKey||e.ctrlKey||((0,h.default)(e.currentTarget).attr("target")||"").toLowerCase()==="_blank")return;let i=(0,h.default)(e.currentTarget).data("link")||(0,h.default)(e.currentTarget).attr("href");if(!i)return!1;if(e.preventDefault(),(0,h.default)(e.currentTarget).hasClass("back-to-top"))return this.backToTopCurrentPage();this.listenToOnce(this,"pageChangedReady",()=>{this.backToTopCurrentPageWithoutAnimation()}),this.router.navigate(i,{trigger:!0})},onGobackLinkClick:function(){this.router.goBack()},onMailchimpLinkClick:function(e){let t=(0,h.default)(e.currentTarget),i;if(!t.hasClass("disabled")){t.flashClass("disabled",3e3);try{i=JSON.parse(t.attr("data-mailchimp"))}catch{i=null}i&&ct.initMailchimpAPI(function(o){y.deleteCookie("MCEvilPopupClosed"),o.start(i)})}},onAnchorLinkClick:function(e){let t=(0,h.default)(e.currentTarget),i=parseInt(t.attr("data-anchor-link-pos"),10)||0,o=t.attr("data-page-id"),r=t.attr("data-page-uri");if(o){let n=this.pages.find(a=>a._id===o);n&&(r=n.num)}!i||!r||(this.scrollPageToPos(r,i),RM.analytics&&RM.analytics.sendEvent("Anchor Link",fe("viewer.ga4Events")?(t[0].textContent||"").trim()||String(i):i))},onShareLinkClick:function(e){Ae.share({host:(RM.common.embedDomainName||window.location.protocol+"//"+window.location.hostname)+"/",tp:(0,h.default)(e.currentTarget).attr("data-share-provider"),source:"mag links",page:this.currentPage||this.pages[0],mag:m.default.extend(this.model.toJSON(),{user:this.user}),forProject:(0,h.default)(e.currentTarget).attr("data-share-type")=="mag",customDomain:!!(RM.common.isDomainViewer||RM.common.embedDomainName),customDomainProfile:!!(RM.common.customDomainProfile||RM.common.embedDomainType=="User"),analytics:this.router.analytics,supportMail:H.SUPPORT_MAIL})},showPageCounter:function(e,t={showPageCounter:!0}){if(!this.toolbar)return;let i=1;this.currentPage&&(i=this.currentPage.num+(e?e=="left"?1:-1:0),i=Math.max(Math.min(i,this.getPagesCount()),1)),this.toolbar.showPageCounter(this.getPage(i),t)},hidePageCounter:function(){this.toolbar&&this.toolbar.hidePageCounter()},showPage:function(e,t){t=t||{},this.active||this.render();let i=this.getPage(e),o=this.currentPage,r=i&&this.getPage(i.num+1),n=this;i&&!this.aboveGlobalWidgetsRendered&&this.renderAboveGlobalWidgets(i),this.isStickyVerticalViewer?this.redrawAboveGlobalWidgets():t.nextPageVisible||this.viewOpts.viewertype==="horizontal"?this.redrawAboveGlobalWidgets(i,r,t.slideInNextPageScroll||t.nextPageScroll,t.animation):i?this.redrawAboveGlobalWidgets(i):o&&this.redrawAboveGlobalWidgets.__debounced(),this.viewOpts.viewertype==="vertical"&&(t.animation=!1,i&&i.scrollOnVerticalMode(t.pageScroll||0),i&&r&&t.nextPageScroll!==void 0&&(r.scrollOnVerticalMode(t.nextPageScroll),t.nextPageVisible?r.start():r.stop()),i&&t.nextPageBlackout!==void 0&&this.$pages_blackout.css({display:r?"block":"none",opacity:t.nextPageBlackout,"z-index":i.getPageZIndex()}));let a=!this.currentPage;if(!a&&e===this.currentPage.num)return!1;if(!i)return e!==1&&this.router.onError(),!1;if(o)if(this.viewOpts.viewertype==="horizontal"||this.isStickyVerticalViewer)o.stop();else{r==o&&t.nextPageVisible||o.stop();let u=o&&this.getPage(o.num+1);u&&!(u==i||u==r&&t.nextPageVisible)&&u.stop()}else t.animation=!1;this.pauseLoading("page-change-animation"),this.currentPage=i,o&&o.resetWaitForAnimationEnd(),clearInterval(this.showPageCompleteInterval),this.$pages_container.toggleClass("disable-transitions",!t.animation),t.animation&&(this.viewOpts.slidein&&o&&o.num>i.num?o.waitForAnimationEnd(c):i.waitForAnimationEnd(c)),this.direction=!o||o.num<i.num?"forward":"backward";let s=i.num-this.getPreloadPageCount(i.num-1,this.direction==="forward"?"backward":"forward"),p=i.num+this.getPreloadPageCount(i.num-1,this.direction);this.viewOpts.viewertype==="horizontal"&&!this.viewOpts.arrows&&(s=p=i.num);for(let u=0;u<this.pages.length;u++){let v=this.pages[u];v.num<i.num?v.setPosition("prev",v.num+1===i.num):v.num>i.num?v.setPosition("next",v.num-1===i.num):v.setPosition("center",v.num===i.num),v.num>=s&&v.num<=p&&(this.whenWidgetsCreated[v._id]=v.show()),this.viewOpts.viewertype=="vertical"&&(v.num<i.num||v.num>i.num+1)&&v.resetScrollOnVerticalMode()}!t.animation&&c(),this.scheduleSetUrlString({replace:!a,skipInternalHistory:t.skipInternalHistory}),this.router.setTitle(),this.trigger("pageChanged",i,{showPageCounter:t.animation||t.bySwipe||a||t.initiator=="scroll",initial:a}),i.trigger("changedTo"),this.viewOpts.viewertype=="vertical"&&this.updateArrowsColor(i);function c(){!t.animation&&!a&&window.requestAnimationFrame(function(){n.$pages_container.removeClass("disable-transitions")}),n.continueLoading("page-change-animation"),n.viewOpts.viewertype=="vertical"&&t.initiator!="scroll"&&n.setScroll(n.magPagesPos[i.num].y),n.isPreview&&n.$el.scrollTop(0),clearInterval(n.showPageCompleteInterval);let u=()=>{for(let S=0;S<n.pages.length;S++){let z=n.pages[S];(z.num<s||z.num>p)&&z.hide()}};n.trigger("pageChangedReady",i);let v=()=>{i.start(),n.loadPages()};(n.loadingPaused?n.whenRenderResumed:Promise.resolve()).then(()=>{u(),n.whenWidgetsCreated[i._id]?.then(v),n.pages.forEach(S=>{S.num>=s&&S.num<=p&&S._id!==i._id&&n.whenWidgetsCreated[S._id]?.then(()=>n.loadPages())})})}},scheduleSetUrlString:function(){if(!Modernizr.chrome){this.router.setUrlString.apply(this.router,arguments),this._resetUrlStringTimeoutFunc=!1;return}let e=arguments;this._resetUrlStringTimeoutFunc=function(){clearTimeout(this._urlStrigScheduleTimeout),this._urlStrigScheduleTimeout=setTimeout(function(){this._resetUrlStringTimeoutFunc=null,this.router.setUrlString.apply(this.router,e)}.bind(this),100)}.bind(this),this._resetUrlStringTimeoutFunc()},goNextPage:function(e){this.isLastPage()||this.currentPage&&this.router.go(this.currentPage.num+1,{...e,isPageNum:!0})},goPrevPage:function(e){this.isFirstPage()||this.currentPage&&this.router.go(this.currentPage.num-1,{...e,isPageNum:!0})},goFirstPage:function(){this.router.go(1,{isPageNum:!0})},goLastPage:function(){this.router.go(this.getPagesCount(),{isPageNum:!0})},pauseLoading:function(e){this.pauseReasons=this.pauseReasons||{},this.pauseReasons[e]=!0,this.loadingPaused=!0,this.whenRenderResumed=new Promise(t=>{let i,o=()=>{this.loadingPaused?i=setTimeout(o,17):(clearTimeout(i),t())};o()})},continueLoading:function(e){this.pauseReasons=this.pauseReasons||{},this.pauseReasons[e]=!1,this.loadingPaused=!m.default.every(m.default.values(this.pauseReasons),function(t){return!t})},loadPages:function(){if(Xe.setTiming("load_pages_start",Date.now()),!this.pages||!this.pages.length)return;let e=this.getPagesLoadOrder();if(!e||!e.length)return;var t=[],i,o,r;let n=[];for(i=0;i<e.length;i++){r=this.pages[e[i]];let p=r.getWidgetsPacks();p.length&&t.push(p),n=n.concat(r.getImmediatePack())}if(!t.length)return;let a=[];for(i=0;i<t.length;i++){i==0&&s(i,0),s(i+1,0);for(var o=1;o<t[i].length;o++)s(i,o)}a.unshift(n),this.widgetsPacksLoadQueue=a,this.stopPagesLoad(),this.renderNextWidgetPack();function s(p,c){p<0||p>=t.length||c<0||c>=t[p].length||a.push(t[p][c])}},stopPagesLoad:function(){clearTimeout(this.loadNextWidgetsTimer)},renderNextWidgetPack:function(){if(!this.widgetsPacksLoadQueue.length){Xe.setTiming("load_pages_end",Date.now()),et.default.trigger("widgetsQueue:empty",this.num_id);return}if(this.loadingPaused){this.loadNextWidgetsTimer=setTimeout(this.renderNextWidgetPack,50);return}let e=this.widgetsPacksLoadQueue.shift();if(!e.length){this.loadNextWidgetsTimer=setTimeout(this.renderNextWidgetPack,17);return}let t=m.default.uniq(m.default.map(e,"page")),i=t[0];if(t.length===1&&(!i.shown||i.loaded)){this.loadNextWidgetsTimer=setTimeout(this.renderNextWidgetPack,17);return}i.renderWidgetPack(e,m.default.bind(function(){this.widgetPackCount++,this.loadNextWidgetsTimer=setTimeout(this.renderNextWidgetPack,17)},this))},getPreloadPageCount:function(e,t){if(this.viewOpts.viewertype=="horizontal")return this.PRELOAD_COUNT[t];let i=1,o=0,r=t=="forward"?1:-1;for(;o<this.PRELOAD_COUNT[t]&&i*r+e<this.pages.length&&i*r+e>=0;)o+=this.pages[i*r+e].height,i++;return i},getPagesLoadOrder:function(){let e=this.currentPage;if(!e)return;let t=e.num-1,i=this.pages.length,o=[],r=this,n,a=e.num-this.getPreloadPageCount(t,this.direction=="forward"?"backward":"forward"),s=e.num+this.getPreloadPageCount(t,this.direction);if(p(t),this.direction=="backward"){for(p(t-1),p(t+1),n=t-2;n>=a;n--)p(n);for(n=t+2;n<=s;n++)p(n)}else{for(p(t+1),p(t-1),n=t+2;n<=s;n++)p(n);for(n=t-2;n>=a;n--)p(n)}return o;function p(c){c<0||c>=i||!r.pages[c].shown||r.pages[c].loaded||o.push(c)}},onGestureChange:function(){this.onResize.__debounced()},checkFullscreen:function(){this.fullscreenCheckCounter=5,clearInterval(this.fullscreenCheckTimer),this.fullscreenCheckTimer=setInterval(m.default.bind(function(){let e=window.fullScreen||window.innerWidth==screen.width&&window.innerHeight>=screen.height-1;this.togglePresentationMode(e),this.fullscreenCheckCounter--,this.fullscreenCheckCounter||clearInterval(this.fullscreenCheckTimer)},this),500)},onResize:function(){if(this.isEcwidOpened)return;if(this.checkFullscreen(),!g.isDesktop&&this.viewOpts.viewertype=="horizontal"||this.viewOpts.viewertype=="vertical"&&!this.isStickyVerticalViewer){let n=this.viewOpts.viewertype=="horizontal"?(0,h.default)("html, body").add(this.$el):this.$el,a=y.isPageNativelyScaled(),s=window.innerHeight;s==337&&(0,h.default)(window).height()==414&&s++,n.height(a?"100%":s),!a&&n.scrollTop(0)}let e=this.getContainerSize(),t=this.isPortrait()?"portrait":"landscape",i=!1;if(!g.isDesktop&&this.prevOrientation&&this.prevOrientation!==t){let n=this.getPage(this.currentPage.num-1),a=Pe.findPlayingVideo(this.currentPage.widgets)||Pe.findPlayingVideo(n?.widgets),s=a?ae.doBoundingBoxesIntersect(a.$el[0].getBoundingClientRect(),{top:0,left:0,bottom:window.innerHeight,right:window.innerWidth}):!1;a&&s?(this.hadPlayingVideoOnResize=!0,setTimeout(()=>{a.page.num===this.currentPage.num&&this.setScrollPosition({offset:a.y*this.getScale(this.currentPage.pageViewport)})},500)):(this.hadPlayingVideoOnResize=!1,this.switchToViewport(this.getMagViewport()),this.setPagesTransitions(),this.stopPagesLoad(),setTimeout(this.onResize,300),setTimeout(this.onResize,1500)),i=!0}if(this.prevOrientation=t,this.isPreview&&this.viewport!="default"){let n=Math.round((this.$el.width()-e.width)/2),a=Math.round((this.$el.height()-e.height)/2);this.$mag_container.add(this.$mag_viewport_device).css({top:Math.max(a,0),left:Math.max(n,0),width:e.width,height:e.height})}else this.$mag_container.add(this.$mag_viewport_device).css({top:"",left:"",width:"",height:""});this.$mag_viewport_device.attr("data-viewport",this.viewport),this.setNewPagesWidths(e.width,e.height),this.magHeight=0,this.magPagesPos=[];let o=this.pages&&this.pages.length;if(m.default.each(this.pages,m.default.bind(function(n,a){let s=n.onResize({absolutePosition:this.magHeight}),p=0;a<o-1&&this.viewOpts.slidein&&(p=this.SCROLL_SNAP),this.magPagesPos[n.num]={y:this.magHeight,h:s,dh:p},this.magHeight+=s+p},this)),this.viewOpts.viewertype==="vertical"&&this.magHeight){let n=this.$magScrollSizer?.width(),a=0;if(this.isPreview&&this.viewport!=="default"&&(a=Math.max(this.$el.height()-this.getViewportSetting("min_height"),0)),this.$magScrollSizer?.css("height",this.magHeight+a),n!=this.$magScrollSizer?.width()&&g.isDesktop&&this.onResize(),this.currentPage){if(!this.isStickyVerticalViewer&&!this.hadPlayingVideoOnResize)this.setScroll(this.getScrollPosForNewSize()),this.onMagScroll();else if(i&&!this.hadPlayingVideoOnResize){var r=this.getScrollPosForNewSize();setTimeout(m.default.bind(function(){this.setScroll(r)},this),0)}}this.$bottomArrow&&this.$bottomArrow.toggleClass("offscreen",this.getScroll()+e.height+this.SCROLLABLE_TRESHOLD>this.magHeight)}if(this.viewOpts.viewertype=="horizontal"&&this.currentPage&&i&&!this.hadPlayingVideoOnResize){var r=this.getScrollPosForNewSize();setTimeout(m.default.bind(function(){this.currentPage.$scrollWrapper.scrollTop(r)},this),0),this.aboveGlobalWidgetsRendered||setTimeout(m.default.bind(function(){this.aboveGlobalWidgetsRendered||this.renderAboveGlobalWidgets(this.currentPage)},this),40)}this.currentPage&&this.loadPages.__debounced()},onOrientationChange(){let e=this.viewOpts.viewertype,t=this.currentPage.num;this.onResize(),e!==this.viewOpts.viewertype?this.router.restartMag({currentPage:t}):(this.unsetViewerClasses(),this.setViewerClasses(),this.destroyControls(),this.renderControls())},onOptionsChange(e={},t={},i="default"){let o=n=>i!=="default"?t[n]!==e?.[n]&&ht.includes(n):t[n]!==e?.[n];i==="default"&&(this.opts=t),o("projectinfo")&&this.toolbar.changeProjectInfoVisible(t.projectinfo);let r=o("arrows");r&&t.viewertype==="horizontal"&&t.arrows?(this.navigation?.destroy(),delete this.navigation,this.navigation=new Ke({mag:this,router:this.router,$container:this.$el,isPreview:this.isPreview,hasFinalPage:t.endpage,viewerType:t.viewertype}).render()):r&&t.viewertype==="horizontal"&&!t.arrows&&(this.navigation?.destroy(),delete this.navigation),r&&t.viewertype==="vertical"&&t.arrows?this.showBottomButton():r&&t.viewertype==="vertical"&&!t.arrows&&this.hideBottomButton(),o("scalableviewer")&&window.dispatchEvent(new Event("resize")),o("slidein")&&(this.viewOpts.slidein=t.slidein,this.$el.removeClass("pages-pos-normal pages-pos-overlap").addClass("pages-pos-"+(t.slidein?"overlap":"normal"))),o("viewertype")&&RM.constructorRouter?.preview.restartMag()},getScrollPosForNewSize:function(){return this.currentPage?this.viewOpts.viewertype=="vertical"?this.magPagesPos[this.currentPage.num].y+(this.lastPageScrollPercent||0)*this.currentPage.pageHeight:(this.lastPageScrollPercent||0)*this.currentPage.pageHeight:0},setNewPagesWidths:function(e,t){let i=this.$el.find("#page-position-style"),o=g.isDesktop?"":" translateZ(0)",r=`        .mag .mag-pages-container .container {
          left: 0px;
          width: `+e+`px;
        }
        .mag .mag-pages-container .container .page {
          left: 0px;
          width: `+e+`px;
        }
`,n="";if(this.viewOpts.viewertype=="horizontal")n=`          .mag .mag-pages-container .container .page.prev-page {
            -webkit-transform: translateX(`+(this.viewOpts.slidein?0:-e)+"px) "+o+`;
            transform: translateX(`+(this.viewOpts.slidein?0:-e)+"px) "+o+`;
          }
          .mag .mag-pages-container .container .page.center-page {
            -webkit-transform: translateX(0) `+o+`;
            transform: translateX(0) `+o+`;
          }
          .mag .mag-pages-container .container .page.next-page {
            -webkit-transform: translateX(`+e+"px) "+o+`;
            transform: translateX(`+e+"px) "+o+`;
          }`;else if(!this.isStickyVerticalViewer)n=`            .mag .mag-pages-container .container .page.prev-page {
              top: `+(-t-1)+`px;            }
            .mag .mag-pages-container .container .page.next-page {
              top: `+(t+1)+`px;            }
`;else{let a=window.innerHeight,s=this.getContainerSizeCached().height;fe("viewer.resizeFixedContainer")&&!g.isDesktop?n=`
               .mag .mag-pages-container .container .page .page-fixed-bg-container,
               .mag .mag-pages-container .container .page .fixed-position-container,
               .mag .mag-pages-container .container .page .fixed-position-container-top {
                 height: ${a}px;
               }
               .mag .mag-pages-container .container .page .fixed-position-container-top {
                 margin-top: -${a}px;
               }
               .mag .mag-pages-container .container .page .fixed-position-container {
                 margin-top: -${s}px;
               }
               .mag .mag-pages-container .container .page:not(.hide-sticky) .content-scroll-wrapper {
                 margin-top: ${s-a*2}px;
               }
           `:n="              .mag .mag-pages-container .container .page .page-fixed-bg-container,              .mag .mag-pages-container .container .page .fixed-position-container,              .mag .mag-pages-container .container .page .fixed-position-container-top {                height: "+s+`px;              }
              .mag .mag-pages-container .container .page .fixed-position-container,              .mag .mag-pages-container .container .page .fixed-position-container-top,              .mag .mag-pages-container .container .page:not(.hide-sticky) .content-scroll-wrapper {                margin-top: `+-s+`px;              }
`}i.length||(i=(0,h.default)('<style id="page-position-style" type="text/css">'),i.appendTo(this.$el)),this.viewOpts.viewertype=="horizontal"?(this.$pages_container.addClass("disable-transitions-on-resize"),i.text(r+n),this.$pages_container.height(),this.$pages_container.removeClass("disable-transitions-on-resize")):i.text(r+n)},setPagesTransitions:function(){let e=this.$el.find("#page-transition-style"),t=this.getPageTransitionTime(),i="cubic-bezier(0.40, 0.24, 0.40, 1)",o=`        .mag .mag-pages-container .container .page {
          -webkit-transition:	all `+t+"ms "+i+";          transition: all "+t+"ms "+i+`;        }
        .mag .mag-pages-container .container .page.center-page {
          -webkit-transition:	all `+(t-5)+"ms "+i+";          transition: all "+(t-5)+"ms "+i+`;        }
        `;e.length||(e=(0,h.default)('<style id="page-transition-style" type="text/css">'),e.appendTo(this.$el)),e.text(o)},switchToViewport:function(e){if(this.viewport==e)return;let t=this.viewport;this.containerSize=null,this.viewport=e,this.trigger("change:viewport",{viewport:this.viewport,oldViewport:t}),this.aboveGlobalWidgetsRendered=!1,this.aboveGlobalWidgets&&this.aboveGlobalWidgets.forEach(function(i){i.destroy(),i.off()}),this.aboveGlobalAnimations&&this.aboveGlobalAnimations.destroy(),this.aboveGlobalWidgets=[],m.default.each(this.pages,function(i){i.updateViewport()})},getContainerSize:function(){let e,t,i=this;return this.isPreview&&this.viewport!="default"?(e=this.getViewportWidth(this.viewport),t=Math.min(this.getViewportSetting("min_height"),this.$el.height())):(e=RM.screenshot?(0,h.default)(window).width():this.$el.width(),RM.screenshot?t=window.innerHeight:this.isStickyVerticalViewer&&(Modernizr.safari||Modernizr.android)&&!g.isDesktop?t=o():this.isStickyVerticalViewer?t=window.innerHeight:t=this.$el.height()||window.innerHeight),this.containerSize={width:e,height:t,windowClientWidth:document.documentElement.clientWidth,windowClientHeight:document.documentElement.clientHeight},this.containerSize;function o(){return i.isPortrait()?Math.max(window.innerHeight,screen.height-20-20+1):Math.min(screen.width,screen.height)}},getContainerSizeCached:function(){return this.containerSize||this.getContainerSize()},getViewportWidth(e){return!e||e==="default"?this.desktopWidth||M.dictionary.default.width:e==="phone_portrait"?this.phoneWidth||M.dictionary.phone_portrait.width:M.dictionary[e].width},isPortrait:function(){return window.screen?window.screen.orientation&&window.screen.orientation.type?!!window.screen.orientation.type.match(/portrait/i):window.orientation===0?!0:window.orientation===90||window.orientation===-90?!1:window.innerWidth<window.innerHeight:window.innerWidth<window.innerHeight},getMagViewport:function(){let e=this.isPortrait();if(this.isPreview)return this.constructorViewport||"default";{let t="default",i=window.innerWidth;if(Modernizr.retina||!g.isDesktop||Modernizr.ismobile){if(screen&&screen.width&&(i=e?Math.min(screen.width,screen.height):Math.max(screen.width,screen.height)),e)return i<600?"phone_portrait":i>=600&&i<=1024?"tablet_portrait":"default";if(i>980)return"default"}if(Modernizr.isipad)return e?"tablet_portrait":"default";if(!g.isDesktop){let o=i,r=m.default.reduce(M.viewports,function(n,a,s){return Math.abs(a.width-o)<=Math.abs(M.viewports[n].width-o)?s:n},0);t=M.viewports[r].name}return t}},getViewportSetting:function(e,t){return(M.dictionary[t||this.viewport]||{})[e]},log:function(){let e="";for(let r=0;r<arguments.length;r++)e+=arguments[r]+" ";let t=(0,h.default)("#log");t.length||(t=(0,h.default)('<div id="log">').css({position:"fixed",background:"rgba(0, 0, 0, 0.7)",color:"#fff",width:200,height:300,left:10,top:10,"z-index":999999,overflow:"auto"}).appendTo("body"));let i=t.html(),o=i.split("<br>");t.html(o.slice(-17).join("<br/>")+"<br/>"+e),t.scrollTop(999999)},fixFocusScroll:function(){this.$mag_container.scrollTop(0),this.$mag_container.scrollLeft(0)},matchSameDomainLink:function(e){let t=e.match(new RegExp("//"+y.escapeSpecial(window.location.hostname)+"/(.*)")),i=t&&t[1];if(i){let o=this.getPageByPath(i);if(o)return o._id}return e},getScale:function(e){let t=Math.min(this.viewOpts.scalewidth,this.getContainerSizeCached().width),i=this.getViewportWidth(e),o=t/i;return W.normalize(o,void 0,this.viewport,i,this.viewOpts)},getAllWidgetViewsById(e,t){let i=!!this.staticGlobalWidgetsData.find(r=>r._id===e),o=!!this.aboveGlobalWidgetsData.find(r=>r._id===e);return i&&!o?this.pages.filter(n=>n.hasWidget?.(e)).map(n=>this.getWidgetById(e,n)):[this.getWidgetById(e,t)]},getWidgetById:function(e,t){let i,o,r,n=t?.hasWidget?.(e)?t:this.pages.find(a=>a.hasWidget?.(e));return n?(o=n.getWidgetById(e),o?i=window.Promise.resolve(o):n.loaded||(i=new window.Promise(function(a,s){this.listenToOnce(n,"loaded"+e,function(){let p=n.getWidgetById(e);p?a(p):s()})}.bind(this)))):(r=m.default.find(this.aboveGlobalWidgetsData,{_id:e}),r&&(o=m.default.find(this.aboveGlobalWidgets,{_id:e}),o?i=window.Promise.resolve(o):this.aboveGlobalWidgetsRendered||(i=new window.Promise(function(a,s){this.listenToOnce(this,"aboveGlobalWidgetsRendered",function(){let p=m.default.find(this.aboveGlobalWidgets,{_id:e});p?a(p):s()})}.bind(this))))),i||window.Promise.reject()},renderAboveGlobalWidgets:function(e){let t=[],i=e.pageViewport;m.default.each(this.aboveGlobalWidgetsData,function(o){let r=m.default.find(this.aboveGlobalWidgets,{_id:o._id});r&&(r.destroy(),r.off());let n;if(o){let a=e.getWidgetViewportData(o,i),s=!this.isPreview&&O.hasExpired(a);se[a.type]&&!s&&(n=new se[a.type](a,e),n.$fixedContainer=this.$aboveWidgetsContainer,n.isValid()&&t.push(n))}}.bind(this)),this.aboveGlobalAnimations=this.initializeAboveGlobalAnimation(t,e),m.default.each(t,function(o){try{o.render(),o.hidden||e.isPasswordProtected()?E.hide(o,!0):E.show(o,!0)}catch{console.error(`Failed to render global widget ${o._id}`)}}),this.aboveGlobalWidgets=y.sortRects(t),this.aboveGlobalWidgetsRendered=!0,this.trigger("aboveGlobalWidgetsRendered")},initializeAboveGlobalAnimation:function(e,t){e=m.default.isArray(e)?e:[e],t.scale=this.getScale(t.pageViewport);let i=new Me({page:t,widgets:e}),o=[];return m.default.each(e,function(r){let n=new window.Promise(function(a){r.loaded?a(r):r.on("loaded",a.bind(null,r))});o.push(n)}),window.Promise.all(o).then(function(){this.aboveAnimationsReady=!0,this.trigger("aboveAnimationsReady")}.bind(this)),this.listenTo(t,"resize",function(r){!m.default.isUndefined(r.prevScale)&&r.prevScale!==r.scale&&i.updateTimelines(),i.onResize({updateAll:!0})}),i},updateAboveGlobalViewport:function(e,t){let i=m.default.find(this.aboveGlobalWidgetsData,{_id:e._id}),o=t.getWidgetViewportData(i,t.pageViewport);if(e.animationObj&&this.aboveGlobalAnimations.removeAnimation(e.animationObj),e.destroy(),e.initialize(o,t),e.hasAnimation()){let r=this.aboveGlobalAnimations.addAnimation(e);r&&r.start()}e.render(),E.hide(e,!0)},getAboveGlobalBox:function(e,t,i){let o=m.default.find(this.aboveGlobalWidgetsData,{_id:e}),r=t.getWidgetViewportData(o,t.pageViewport);return y.getFixedPositionBox(r.fixed_position,m.default.pick(r,["x","y","w","h"]),t.scale,i)},redrawAboveGlobalWidgets:function(e,t,i,o){if(!e){let a=m.default.isUndefined(this.getScroll())?void 0:this.findPageOnCurrentMagScroll(),s=a&&a.page.num,p=a&&this.getScrollParams(a);e=s&&this.getPage(s),t=e&&this.getPage(e.num+1),i=p&&(p.slideInNextPageScroll||p.nextPageScroll),o=p&&p.animation}i=m.default.isUndefined(i)?void 0:Math.abs(i);let r={width:Math.min(this.viewOpts.scalewidth,this.getContainerSizeCached().width),height:this.getContainerSizeCached().height},n=function(a,s){return!a.page||s&&a.page.pageViewport!==s.pageViewport};if(m.default.isUndefined(i)){let a=this.getPageTransitionTime();m.default.each(this.aboveGlobalWidgets,function(s){let p=e._id&&!E.isHidden(s,e._id,this.isPreview)&&!e.isPasswordProtected(),c=e._id&&n(s,e);e._id&&s.updatePage(e),c&&this.updateAboveGlobalViewport(s,e),p?o?s.wasHidden&&y.waitForTransitionEnd(e.$el,a,"transform",E.show.bind(null,s)):s.wasHidden&&E.show(s):!s.wasHidden&&E.hide(s)}.bind(this))}else{let a=Math.abs(i);m.default.each(this.aboveGlobalWidgets,function(s){let p=!E.isHidden(s,e._id,this.isPreview)&&!e.isPasswordProtected(),c=t&&!E.isHidden(s,t._id,this.isPreview)&&!t.isPasswordProtected(),u=p&&c&&e.pageViewport===t.pageViewport,v=this.getAboveGlobalBoxMemoized(s._id,e,r),S=this.getAboveGlobalBoxMemoized(s._id,t||e,r),z=p&&a>v.top+v.height,_=t&&c&&S.top>a;if(z||_||u||!t&&p){let F=z?e:_?t:s.page,b=n(s,F);s.updatePage(F),b?(s.rendered=!1,E.hide(s).then(function(){this.updateAboveGlobalViewport(s,F),E.show(s)}.bind(this))):s.wasHidden&&E.show(s)}else!s.wasHidden&&E.hide(s)}.bind(this))}},getUsedFonts(e={}){return Z.getUsedFontsFromWidgetsModels({...e,models:this.pages.reduce((t,i)=>i.widgets.reduce((o,r)=>o.push(r)&&o,t),[]),customList:e.includeCustom?m.default.filter(this.edit_params&&this.edit_params.fonts,{provider:"custom"}):[]})},hasNewTextWidgets(){return this.hasTextWidgetsV3||Ge.hasNewTextWidgets(this.model.attributes)||Ge.someTextWidgets(this.aboveGlobalWidgetsData)},hasCodeInjection:function(){if(m.default.any(["ci_head","ci_body_top","ci_body_bottom","ci_css"],i=>!!this[i]))return!0;let t=!1;return m.default.each(this.pages,function(i){m.default.each(i.widgetsData,function(o){let r=!!(o.type==="iframe"&&o.code);if(!r||o.use_iframe)return;let a=(0,ei.getEmbedType)(o.code)==="codeinjection";if(!a)return;let s=!!(m.default.all(M.viewport_listall,function(p){let c=o[p];return c&&c.hidden||!c})&&o.hidden);r&&a&&!s&&(t=!0)})}),t},setupEcommerceSidebar:function(){this.eCommerceManager?.getConnectedProvider()==="ecwid"?this.cartSidebar=new Wt(this):this.cartSidebar=new Ot(this)},closeMagMenu(){this.toolbar&&this.toolbar.closeMenu()}}),Fr=Oi;export{ye as a,Gi as b,Pe as c,Gt as d,Xe as e,Fr as f};
