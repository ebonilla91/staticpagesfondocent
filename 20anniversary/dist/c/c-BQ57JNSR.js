import{a as de}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-V2UNE6ZB.js";import{a as le}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-LV5FH5B7.js";import{a as se,b as me}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-HDRT62RD.js";import{d as ue}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-LMXYD7AC.js";import{c as ge}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-U3EQ6JVM.js";import{a as ie,b as oe}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-4FR22MFU.js";import{I as pe,J as fe}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-BPJUKUAP.js";import{a as $,b as ce}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-3ZELX36Q.js";import{e as ne,n as _,o as R}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-PJF6UIFY.js";import{a as te}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-42FJTMOJ.js";import{a as ae}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-WSIFDYHJ.js";import{b,c as A}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-OAY73AJW.js";import{a as x,b as j,e as re}from"https://d1id5eheivyv24.cloudfront.net/98c7974b/dist/c/c-IDSWT3EJ.js";var z=j((ze,E)=>{"use strict";function N(e,t,n,r,a,o,i){try{var s=e[o](i),f=s.value}catch(c){n(c);return}s.done?t(f):Promise.resolve(f).then(r,a)}function he(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(f){N(o,r,a,i,s,"next",f)}function s(f){N(o,r,a,i,s,"throw",f)}i(void 0)})}}E.exports=he,E.exports.__esModule=!0,E.exports.default=E.exports});var H=j(T=>{"use strict";var S=ie();Object.defineProperty(T,"__esModule",{value:!0});T.default=void 0;var ve=S(oe()),be=S(se()),P=S(ne()),U=S(z()),ye=S(le()),we=ae(),Oe=ue(),Pe=S(de()),k=ge(),Se=me(),B=(fe(),re(pe)),Fe=["children","id","readFileData","dropFile","name","onChange","onChangeMultiple","disabled","textStyle","multiple"],G;function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?W(Object(n),!0).forEach(function(r){(0,ve.default)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var De=(0,Oe.styled)("input")(G||(G=(0,ye.default)([`
  opacity: 0;
  visibility: hidden;
  position: absolute;
  cursor: pointer;
  width: 0;
  left: 0;
`]))),_e=function(t){return t.isDirectory},Ee=function(t){return t.isFile},Te=function(t,n){var r=[],a=function o(){t.readEntries(function(i){if(i.length)r=r.concat(i),o();else return n(r)})};a()},Ie=function(){var e=(0,U.default)(P.default.mark(function t(n){var r,a;return P.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=[],a=0,i.abrupt("return",new Promise(function(s){for(var f=function y(m){if(_e(m)){var M=m.createReader();a++,Te(M,function(h){a--,h.forEach(function(q){if(y(q),a<=0)return s(r)})})}Ee(m)&&(a++,m.file(function(h){if(a--,r.push(h),a<=0)return s(r)}))},c=0;c<n.length;c++){var g=n[c].webkitGetAsEntry();g&&f(g)}}));case 3:case"end":return i.stop()}},t)}));return function(n){return e.apply(this,arguments)}}(),Me=(0,we.forwardRef)(function(e,t){var n=e.children,r=e.id,a=r===void 0?"rm-file-upload":r,o=e.readFileData,i=o===void 0?!0:o,s=e.dropFile,f=s===void 0?!1:s,c=e.name,g=e.onChange,y=e.onChangeMultiple,m=e.disabled,M=e.textStyle,h=e.multiple,q=(0,be.default)(e,Fe),Y=function(){var D=(0,U.default)(P.default.mark(function d(p){var v,w;return P.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(p.target.files){l.next=2;break}return l.abrupt("return");case 2:if(!h){l.next=6;break}y&&y(Array.from(p.target.files)),l.next=16;break;case 6:if(v=p.target.files[0],!i){l.next=13;break}return l.next=10,(0,k.readFile)(v);case 10:l.t0=l.sent,l.next=14;break;case 13:l.t0=null;case 14:w=l.t0,g&&g(v,w);case 16:case"end":return l.stop()}},d)}));return function(p){return D.apply(this,arguments)}}(),ee=function(){var D=(0,U.default)(P.default.mark(function d(p){var v,w,O,l,L;return P.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(p.preventDefault(),!((v=p.dataTransfer)!==null&&v!==void 0&&(w=v.items)!==null&&w!==void 0&&w[0]&&"webkitGetAsEntry"in p.dataTransfer.items[0])){u.next=7;break}return u.next=4,Ie(p.dataTransfer.items);case 4:O=u.sent,u.next=8;break;case 7:p.dataTransfer.files&&p.dataTransfer.files.length&&(O=Array.from(p.dataTransfer.files));case 8:if(O){u.next=10;break}return u.abrupt("return");case 10:if(!h){u.next=14;break}y&&y(O),u.next=24;break;case 14:if(l=O[0],!i){u.next=21;break}return u.next=18,(0,k.readFile)(l);case 18:u.t0=u.sent,u.next=22;break;case 21:u.t0=null;case 22:L=u.t0,g&&g(l,L);case 24:case"end":return u.stop()}},d)}));return function(p){return D.apply(this,arguments)}}();return(0,B.jsxs)(Pe.default,C(C({ref:t,as:"label",htmlFor:a,disabled:m,cursor:"pointer",onDrop:function(d){return f&&ee(d)},onDragOver:function(d){return f&&d.preventDefault()}},M),{},{children:[n,(0,B.jsx)(De,C({type:"file",name:c||a,id:a,style:{opacity:0,visibility:"hidden",position:"absolute",cursor:"pointer",width:0,left:0},onChange:Y,multiple:!!h,disabled:m},q))]}))}),qe=Se.Box.withComponent(Me,{target:"e1ctbelx0"});T.default=qe});var Ue=j(F=>{"use strict";var xe=te();Object.defineProperty(F,"__esModule",{value:!0});var je={};Object.defineProperty(F,"default",{enumerable:!0,get:function(){return I.default}});var I=Ce(H());Object.keys(I).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(je,e)||e in F&&F[e]===I[e]||Object.defineProperty(F,e,{enumerable:!0,get:function(){return I[e]}})});function V(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(V=function(a){return a?n:t})(e)}function Ce(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||xe(e)!=="object"&&typeof e!="function")return{default:e};var n=V(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}});var Le,Ae,Re,Z,J=x(()=>{"use strict";Le=e=>e?new Promise((t,n)=>{try{let r=new FileReader;r.onloadend=()=>t(r.result),r.onerror=a=>n(a),r.readAsDataURL(e)}catch(r){n(r)}}):Promise.reject("No file data"),Ae=e=>e?{"image/jpeg":"jpg","image/webp":"webp","image/png":"png","image/gif":"gif","image/svg+xml":"svg"}[e.toLowerCase()]:void 0,Re=e=>new Promise((t,n)=>{let r=new Image;r.onload=()=>{(!r.width||!r.height)&&n("Unable to get image dimensions");let a={width:r.width,height:r.height};r.remove(),t(a)},r.onerror=a=>n(a),r.src=e}),Z=e=>new Promise((t,n)=>{Le(e).then(r=>{Re(r).then(a=>{let o={width:a.width,height:a.height,type:e.type,size:e.size,ext:Ae(e.type),content:r};t(o)}).catch(a=>n(a))})})});var Q,Je,K,Qe,X=x(()=>{"use strict";A();ce();R();J();Q=async(e,t)=>{let n=new FormData;return n.append("widgetId",t),n.append("upload",e.slice(0,Math.min(e.size,b.SHOTS_UPLOAD_SIZE_LIMT))),await fetch("/api/shots/upload/video",{method:"post",body:n}).then(r=>r.json())},Je=(e,t)=>$.post("/api/shots/convert/fromurl",{videoUrl:e,widgetId:t}),K=async(e,t)=>{let{width:n,height:r}=await Z(e[0]),a=new FormData;a.append("widgetId",t),a.append("totalFilesNumber",e.length.toString()),e.sort((i,s)=>i.name.localeCompare(s.name,void 0,{numeric:!0}));for(let[i,s]of e.entries())a.append(`${i}.${_.getFileExt(s.name)||""}`,s);return{...await fetch("/api/shots/upload/sequence",{method:"post",body:a}).then(i=>i.json()),imageWidth:n,imageHeight:r}},Qe=async()=>await fetch("/api/shots/templates").then(t=>t.json())});var rr,tr,$e=x(()=>{"use strict";X();A();R();rr=e=>{let t=["image/png","image/jpeg"],n=/(png|jpg|jpeg)/i;if(!e.length)return{errorMsg:"No suitable files to upload. Please use JPEG or PNG files."};if(e.length===1){let r=e[0];return/^image\//.test(r.type)||t.includes(r.type)||n.test(_.getFileExt(r.name))?{errorMsg:"Please upload single Video file or multiple Image files"}:r.size>b.UPLOAD_SHOTS_SIZE_LIMIT?{errorMsg:`Video file size must be less than ${Math.floor(b.UPLOAD_SHOTS_SIZE_LIMIT/1024/1024)} mb`}:{validated:e}}else{if(e.reduce((i,s)=>i+s.size,0)>b.UPLOAD_SHOTS_SEQUENCE_SIZE_LIMIT)return{errorMsg:`Total size of sequence files must be less than ${Math.floor(b.UPLOAD_SHOTS_SEQUENCE_SIZE_LIMIT/1024/1024)} mb`};let a,o=e.filter(i=>t.includes(i.type)||n.test(_.getFileExt(i.name)));if(!o.length)return{errorMsg:"No suitable files to upload. Please use JPEG or PNG files."};for(let i of o){if(a&&a!==i.type)return{errorMsg:"All image files in sequence must be of the same type"};a=i.type}return{validated:o}}},tr=async(e,t)=>{if(e.length)return e.length===1?Q(e[0],t):K(e,t)}});export{z as a,Ue as b,Re as c,Z as d,J as e,Je as f,Qe as g,X as h,rr as i,tr as j,$e as k};
